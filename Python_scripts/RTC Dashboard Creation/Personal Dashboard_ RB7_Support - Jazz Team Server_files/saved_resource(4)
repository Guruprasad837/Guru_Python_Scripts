dojo.provide("jazz.ui.nls.ErrorPageMessages")._built=true;
dojo.provide("jazz.ui.nls.ErrorPageMessages.en_us");
jazz.ui.nls.ErrorPageMessages.en_us={"next":"What would you like to do next?","defaultMessage":"The page you are looking for does not exist.","goBack":"Go back to previous page","id":"ID ${0}","wereSorry":"We\'re Sorry..."};

;dojo.cache("jazz.ui", "templates/ErrorPage.html", "<div class=\"jazz-ui-ErrorPage\">	<h1>${messages.wereSorry}</h1>	<div class=\"summary\" dojoAttachPoint=\"_errorMessage\">${messages.defaultMessage}</div>	<div class=\"details\" style=\"display: none\" dojoAttachPoint=\"_errorDetails\"></div>	<div class=\"error-next\" dojoAttachPoint=\"_nextMessage\">${messages.next}</div>	<div class=\"actionLinksDiv\" dojoAttachPoint=\"_actionLinksDiv\"></div></div>");

;dojo.provide("jazz.ui.ErrorPage");






dojo.requireLocalization("jazz.ui","ErrorPageMessages");
(function(){
var _1;
dojo.declare("jazz.ui.ErrorPage",[dijit._Widget,dijit._Templated],{summary:"",details:"",actions:null,includeBackLink:true,templatePath:dojo.moduleUrl("jazz.ui","templates/ErrorPage.html"),constructor:function(_2){
if(!_1){
_1=dojo.i18n.getLocalization("jazz.ui","ErrorPageMessages");
}
this.messages=_1;
},_setActionsAttr:function(_3){
if(this._actionLinks){
while(this._actionLinks.length){
this._actionLinks.pop().destroyRecursive();
}
}else{
this._actionLinks=[];
}
if(_3&&dojo.isArray(_3)){
for(var i=0;i<_3.length;i++){
this._actionLinks.push(new jazz.ui.errorPage.ActionLink(_3[i]).placeAt(this._actionLinksDiv));
}
}else{
_3=null;
}
var _4=(_3&&_3.length)||0;
if(this.includeBackLink){
_4++;
this._actionLinks.push(new jazz.ui.errorPage.ActionLink({iconClass:"backIcon",label:this.messages.goBack,onClick:function(e){
e.preventDefault();
history.back();
}}).placeAt(this._actionLinksDiv,"first"));
}
dojo.style(this._nextMessage,{display:_4>1?"":"none"});
this.actions=_3;
},_setIncludeBackLinkAttr:function(_5){
this.includeBackLink=_5;
if(this._created||!this.actions){
this.set("actions",this.actions);
}
},_setSummaryAttr:function(_6){
if(_6.substring(0,4)==="@ID@"){
var _7=_6.substring(0,_6.indexOf(" "));
}else{
_7=/^[A-Z]{5}[0-9]{3,5}[EWI]/.exec(_6);
}
if(_7){
_6=_6.substring(_6.indexOf(" ")+1)+"&nbsp;<span class='message-id'>"+dojo.string.substitute(_1.id,[_7])+"</span>";
}
this._errorMessage.innerHTML=_6;
this.summary=_6;
},_setDetailsAttr:function(_8){
dojo.style(this._errorDetails,{display:_8?"block":""});
this._errorDetails.innerHTML=_8;
this.details=_8;
},uninitialize:function(){
while(this._actionLinks.length){
this._actionLinks.pop().destroyRecursive();
}
}});
dojo.provide("jazz.ui.errorPage.ActionLink");
dojo.declare("jazz.ui.errorPage.ActionLink",[dijit._Widget,dijit._Templated],{icon:"",iconClass:"",label:"",href:"",templateString:"<div class=\"jazz-ui-errorPage-ActionLink\"><a dojoattachpoint=\"focusNode\" href=\"#\"><img class=\"error-icon\" src=\"${_blankGif}\" dojoattachpoint=\"_img\"><span class=\"error-label\" dojoattachpoint=\"_label\"></span></a></div>",_setIconAttr:function(_9){
this.icon=_9;
this._img.src=_9||this._blankGif;
},_setIconClassAttr:function(_a){
this.iconClass=_a;
this._img.className="error-icon"+(_a?" "+_a:"");
},_setLabelAttr:function(_b){
this.label=_b;
this._label.innerHTML=_b;
},_setHrefAttr:function(_c){
this.href=_c;
this.focusNode.href=_c;
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.Constants");




dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _2=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
com.ibm.team.dashboard.web.ui.internal.Constants={serverError:"com.ibm.team.dashboard.events.serverError",hideServerError:"com.ibm.team.dashboard.events.hideServerError",DASHBOARD_CONTENT_CLASS:"com-ibm-team-dashboard-content",URL_PARAM_ACTION:"action",URL_PARAM_ACTION_VIEW_PAGE:"jazz.viewPage",URL_PARAM_ACTION_VIEW_PAGE_ID:"id",CONTEXT_PUBLIC:"_PUBLIC_CONTEXT",READ_ONLY:0,EDIT_DEFERRED_SAVE:1,EDIT_AUTO_SAVE:2,PROPERTY_DASHBOARD:"dashboard",SCOPE_APPLIES_TO_ALL:"ALL",SCOPE_APPLIES_TO_TEAMS:"TEAMS",SCOPE_APPLIES_TO_PROJECTS:"PROJECTS",SCOPE_APPLIES_TO_PROCESS:"PROJECTS_AND_TEAMS",SCOPE_APPLIES_TO_CONTRIBUTORS:"CONTRIBUTORS",ViewletContainer:{MIDDLE_SECTION_COLLAPSED_CLASS:"middle-section-collapsed",HEADER_COLLAPSED_CLASS:"header-collapsed",EXPAND_CLASS:"expand",COLLAPSE_CLASS:"collapse",EXPAND_TITLE:_2.expand,COLLAPSE_TITLE:_2.collapse,CONTENT_ZOOMED_CLASS:"content-zoomed",CONTENT_WRAPPER_ZOOMED_CLASS:"content-wrapper-zoomed",VIEWLET_ZOOMED_CLASS:"viewlet-zoomed",COLUMN_ZOOMED_CLASS:"column-zoomed",ZOOM_WIDTH:600,LAST_COL_MENU_OFFSET:16,ZOOM_ICON_SCROLLBAR_HORIZ_OFFSET:1,ZOOM_ICON_DEFAULT_HORIZ_OFFSET:1},LeftNav:{ROOT_CLASS:"com-ibm-team-dashboard-left-nav",SEARCH_CLASS:"com-ibm-team-dashboard-left-nav-search",SELECTED_DASHBOARD_CLASS:"selected",COMMAND_CLASS:"command",DELETE_BUTTON_DIV_CLASS:"delete",LOADING_CLASS:"loading",LINK_ID_SUFFIX:"-link",LI_ID_SUFFIX:"-li",REMOTE_ERROR:"LeftNav.js remote error: ",LEFT_NAV_INFO_ERROR:"Error getting left nav info: "},SettingsArea:{FIELD_HIDDEN:"HIDDEN",FIELD_PASSWORD:"PASSWORD",FIELD_COLOR:"COLOR",FIELD_CUSTOM:"CUSTOM",FIELD_LIST:"LIST",FIELD_COMPUTED:"COMPUTED",FIELD_BOOLEAN:"BOOLEAN",FIELD_STRING:"STRING",FIELD_INTEGER:"INTEGER"}};
})();


;define("dijit/form/_FormWidgetMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-style","dojo/_base/lang","dojo/mouse","dojo/on","dojo/sniff","dojo/window","../a11y"],function(_1,_2,_3,_4,_5,_6,on,_7,_8,_9){
return _2("dijit.form._FormWidgetMixin",null,{name:"",alt:"",value:"",type:"text","aria-label":"focusNode",tabIndex:"0",_setTabIndexAttr:"focusNode",disabled:false,intermediateChanges:false,scrollOnFocus:true,_setIdAttr:"focusNode",_setDisabledAttr:function(_a){
this._set("disabled",_a);
if(/^(button|input|select|textarea|optgroup|option|fieldset)$/i.test(this.focusNode.tagName)){
_3.set(this.focusNode,"disabled",_a);
if(_7("trident")&&"readOnly" in this){
_3.set(this.focusNode,"readonly",_a||this.readOnly);
}
}else{
this.focusNode.setAttribute("aria-disabled",_a?"true":"false");
}
if(this.valueNode){
_3.set(this.valueNode,"disabled",_a);
}
if(_a){
this._set("hovering",false);
this._set("active",false);
var _b="tabIndex" in this.attributeMap?this.attributeMap.tabIndex:("_setTabIndexAttr" in this)?this._setTabIndexAttr:"focusNode";
_1.forEach(_5.isArray(_b)?_b:[_b],function(_c){
var _d=this[_c];
if(_7("webkit")||_9.hasDefaultTabStop(_d)){
_d.setAttribute("tabIndex","-1");
}else{
_d.removeAttribute("tabIndex");
}
},this);
}else{
if(this.tabIndex!=""){
this.set("tabIndex",this.tabIndex);
}
}
},_onFocus:function(by){
if(by=="mouse"&&this.isFocusable()){
var _e=this.own(on(this.focusNode,"focus",function(){
_f.remove();
_e.remove();
}))[0];
var _10=_7("pointer-events")?"pointerup":_7("MSPointer")?"MSPointerUp":_7("touch-events")?"touchend, mouseup":"mouseup";
var _f=this.own(on(this.ownerDocumentBody,_10,_5.hitch(this,function(evt){
_f.remove();
_e.remove();
if(this.focused){
if(evt.type=="touchend"){
this.defer("focus");
}else{
this.focus();
}
}
})))[0];
}
if(this.scrollOnFocus){
this.defer(function(){
_8.scrollIntoView(this.domNode);
});
}
this.inherited(arguments);
},isFocusable:function(){
return !this.disabled&&this.focusNode&&(_4.get(this.domNode,"display")!="none");
},focus:function(){
if(!this.disabled&&this.focusNode.focus){
try{
this.focusNode.focus();
}
catch(e){
}
}
},compare:function(_11,_12){
if(typeof _11=="number"&&typeof _12=="number"){
return (isNaN(_11)&&isNaN(_12))?0:_11-_12;
}else{
if(_11>_12){
return 1;
}else{
if(_11<_12){
return -1;
}else{
return 0;
}
}
}
},onChange:function(){
},_onChangeActive:false,_handleOnChange:function(_13,_14){
if(this._lastValueReported==undefined&&(_14===null||!this._onChangeActive)){
this._resetValue=this._lastValueReported=_13;
}
this._pendingOnChange=this._pendingOnChange||(typeof _13!=typeof this._lastValueReported)||(this.compare(_13,this._lastValueReported)!=0);
if((this.intermediateChanges||_14||_14===undefined)&&this._pendingOnChange){
this._lastValueReported=_13;
this._pendingOnChange=false;
if(this._onChangeActive){
if(this._onChangeHandle){
this._onChangeHandle.remove();
}
this._onChangeHandle=this.defer(function(){
this._onChangeHandle=null;
this.onChange(_13);
});
}
}
},create:function(){
this.inherited(arguments);
this._onChangeActive=true;
},destroy:function(){
if(this._onChangeHandle){
this._onChangeHandle.remove();
this.onChange(this._lastValueReported);
}
this.inherited(arguments);
}});
});


;define("dijit/form/_FormWidget",["dojo/_base/declare","dojo/sniff","dojo/_base/kernel","dojo/ready","../_Widget","../_CssStateMixin","../_TemplatedMixin","./_FormWidgetMixin","jazz/inverted!./_FormValueWidget"],function(_1,_2,_3,_4,_5,_6,_7,_8){
return _1("dijit.form._FormWidget",[_5,_7,_6,_8],{setDisabled:function(_9){
_3.deprecated("setDisabled("+_9+") is deprecated. Use set('disabled',"+_9+") instead.","","2.0");
this.set("disabled",_9);
},setValue:function(_a){
_3.deprecated("dijit.form._FormWidget:setValue("+_a+") is deprecated.  Use set('value',"+_a+") instead.","","2.0");
this.set("value",_a);
},getValue:function(){
_3.deprecated(this.declaredClass+"::getValue() is deprecated. Use get('value') instead.","","2.0");
return this.get("value");
},postMixInProperties:function(){
this.nameAttrSetting=(this.name&&!_2("msapp"))?("name=\""+this.name.replace(/"/g,"&quot;")+"\""):"";
this.inherited(arguments);
}});
});


;define("dijit/form/_FormValueMixin",["dojo/_base/declare","dojo/dom-attr","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","./_FormWidgetMixin"],function(_1,_2,_3,_4,on,_5,_6){
return _1("dijit.form._FormValueMixin",_6,{readOnly:false,_setReadOnlyAttr:function(_7){
if(_5("trident")&&"disabled" in this){
_2.set(this.focusNode,"readOnly",_7||this.disabled);
}else{
_2.set(this.focusNode,"readOnly",_7);
}
this._set("readOnly",_7);
},postCreate:function(){
this.inherited(arguments);
if(this._resetValue===undefined){
this._lastValueReported=this._resetValue=this.value;
}
},_setValueAttr:function(_8,_9){
this._handleOnChange(_8,_9);
},_handleOnChange:function(_a,_b){
this._set("value",_a);
this.inherited(arguments);
},undo:function(){
this._setValueAttr(this._lastValueReported,false);
},reset:function(){
this._hasBeenBlurred=false;
this._setValueAttr(this._resetValue,true);
}});
});


;define("dijit/form/_FormValueWidget",["dojo/_base/declare","dojo/sniff","./_FormWidget","./_FormValueMixin"],function(_1,_2,_3,_4){
return _1("dijit.form._FormValueWidget",[_3,_4],{_layoutHackIE7:function(){
if(_2("ie")==7){
var _5=this.domNode;
var _6=_5.parentNode;
var _7=_5.firstChild||_5;
var _8=_7.style.filter;
var _9=this;
while(_6&&_6.clientHeight==0){
(function ping(){
var _a=_9.connect(_6,"onscroll",function(){
_9.disconnect(_a);
_7.style.filter=(new Date()).getMilliseconds();
_9.defer(function(){
_7.style.filter=_8;
});
});
})();
_6=_6.parentNode;
}
}
}});
});


;define("dijit/form/_ButtonMixin",["dojo/_base/declare","dojo/dom","dojo/has","../registry"],function(_1,_2,_3,_4){
var _5=_1("dijit.form._ButtonMixin"+(_3("dojo-bidi")?"_NoBidi":""),null,{label:"",type:"button",__onClick:function(e){
e.stopPropagation();
e.preventDefault();
if(!this.disabled){
this.valueNode.click(e);
}
return false;
},_onClick:function(e){
if(this.disabled){
e.stopPropagation();
e.preventDefault();
return false;
}
if(this.onClick(e)===false){
e.preventDefault();
}
var _6=e.defaultPrevented;
if(!_6&&this.type=="submit"&&!(this.valueNode||this.focusNode).form){
for(var _7=this.domNode;_7.parentNode;_7=_7.parentNode){
var _8=_4.byNode(_7);
if(_8&&typeof _8._onSubmit=="function"){
_8._onSubmit(e);
e.preventDefault();
_6=true;
break;
}
}
}
return !_6;
},postCreate:function(){
this.inherited(arguments);
_2.setSelectable(this.focusNode,false);
},onClick:function(){
return true;
},_setLabelAttr:function(_9){
this._set("label",_9);
var _a=this.containerNode||this.focusNode;
_a.innerHTML=_9;
this.onLabelSet();
},onLabelSet:function(){
}});
if(_3("dojo-bidi")){
_5=_1("dijit.form._ButtonMixin",_5,{onLabelSet:function(){
this.inherited(arguments);
var _b=this.containerNode||this.focusNode;
this.applyTextDir(_b);
}});
}
return _5;
});


;define("dojo/text!dijit/form/templates/Button.html", '<span class="dijit dijitReset dijitInline" role="presentation"	><span class="dijitReset dijitInline dijitButtonNode"		data-dojo-attach-event="ondijitclick:__onClick" role="presentation"		><span class="dijitReset dijitStretch dijitButtonContents"			data-dojo-attach-point="titleNode,focusNode"			role="button" aria-labelledby="${id}_label"			><span class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode"></span			><span class="dijitReset dijitToggleButtonIconChar">&#x25CF;</span			><span class="dijitReset dijitInline dijitButtonText"				id="${id}_label"				data-dojo-attach-point="containerNode"			></span		></span	></span	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen"		data-dojo-attach-event="onclick:_onClick"		tabIndex="-1" aria-hidden="true" data-dojo-attach-point="valueNode"/></span>');

;define("dijit/form/Button",["require","dojo/_base/declare","dojo/dom-class","dojo/has","dojo/_base/kernel","dojo/_base/lang","dojo/ready","./_FormWidget","./_ButtonMixin","dojo/text!./templates/Button.html","../a11yclick","jazz/inverted!./DropDownButton","jazz/inverted!./ComboButton","jazz/inverted!./ToggleButton"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
var _b=_2("dijit.form.Button"+(_4("dojo-bidi")?"_NoBidi":""),[_8,_9],{showLabel:true,iconClass:"dijitNoIcon",_setIconClassAttr:{node:"iconNode",type:"class"},baseClass:"dijitButton",templateString:_a,_setValueAttr:"valueNode",_setNameAttr:function(_c){
if(this.valueNode){
this.valueNode.setAttribute("name",_c);
}
},postCreate:function(){
this.inherited(arguments);
this._setLabelFromContainer();
},_setLabelFromContainer:function(){
if(this.containerNode&&!this.label){
this.label=_6.trim(this.containerNode.innerHTML);
this.onLabelSet();
}
},_setShowLabelAttr:function(_d){
if(this.containerNode){
_3.toggle(this.containerNode,"dijitDisplayNone",!_d);
}
this._set("showLabel",_d);
},setLabel:function(_e){
_5.deprecated("dijit.form.Button.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");
this.set("label",_e);
},onLabelSet:function(){
this.inherited(arguments);
if(!this.showLabel&&!("title" in this.params)){
this.titleNode.title=_6.trim(this.containerNode.innerText||this.containerNode.textContent||"");
}
}});
if(_4("dojo-bidi")){
_b=_2("dijit.form.Button",_b,{onLabelSet:function(){
this.inherited(arguments);
if(this.titleNode.title){
this.applyTextDir(this.titleNode,this.titleNode.title);
}
},_setTextDirAttr:function(_f){
if(this._created&&this.textDir!=_f){
this._set("textDir",_f);
this._setLabelAttr(this.label);
}
}});
}
return _b;
});


;define("dijit/_HasDropDown",["dojo/_base/declare","dojo/_base/Deferred","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","dojo/touch","./registry","./focus","./popup","./_FocusMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,on,_b,_c,_d,_e,_f){
return _1("dijit._HasDropDown",_f,{_buttonNode:null,_arrowWrapperNode:null,_popupStateNode:null,_aroundNode:null,dropDown:null,autoWidth:true,forceWidth:false,maxHeight:-1,dropDownPosition:["below","above"],_stopClickEvents:true,_onDropDownMouseDown:function(e){
if(this.disabled||this.readOnly){
return;
}
if(e.type!="MSPointerDown"){
e.preventDefault();
}
this.own(on.once(this.ownerDocument,_b.release,_a.hitch(this,"_onDropDownMouseUp")));
this.toggleDropDown();
},_onDropDownMouseUp:function(e){
var _10=this.dropDown,_11=false;
if(e&&this._opened){
var c=_6.position(this._buttonNode,true);
if(!(e.pageX>=c.x&&e.pageX<=c.x+c.w)||!(e.pageY>=c.y&&e.pageY<=c.y+c.h)){
var t=e.target;
while(t&&!_11){
if(_5.contains(t,"dijitPopup")){
_11=true;
}else{
t=t.parentNode;
}
}
if(_11){
t=e.target;
if(_10.onItemClick){
var _12;
while(t&&!(_12=_c.byNode(t))){
t=t.parentNode;
}
if(_12&&_12.onClick&&_12.getParent){
_12.getParent().onItemClick(_12,e);
}
}
return;
}
}
}
if(this._opened){
if(_10.focus&&(_10.autoFocus!==false||(e.type=="mouseup"&&!this.hovering))){
this._focusDropDownTimer=this.defer(function(){
_10.focus();
delete this._focusDropDownTimer;
});
}
}else{
if(this.focus){
this.defer("focus");
}
}
},_onDropDownClick:function(e){
if(this._stopClickEvents){
e.stopPropagation();
e.preventDefault();
}
},buildRendering:function(){
this.inherited(arguments);
this._buttonNode=this._buttonNode||this.focusNode||this.domNode;
this._popupStateNode=this._popupStateNode||this.focusNode||this._buttonNode;
var _13={"after":this.isLeftToRight()?"Right":"Left","before":this.isLeftToRight()?"Left":"Right","above":"Up","below":"Down","left":"Left","right":"Right"}[this.dropDownPosition[0]]||this.dropDownPosition[0]||"Down";
_5.add(this._arrowWrapperNode||this._buttonNode,"dijit"+_13+"ArrowButton");
},postCreate:function(){
this.inherited(arguments);
var _14=this.focusNode||this.domNode;
this.own(on(this._buttonNode,_b.press,_a.hitch(this,"_onDropDownMouseDown")),on(this._buttonNode,"click",_a.hitch(this,"_onDropDownClick")),on(_14,"keydown",_a.hitch(this,"_onKey")),on(_14,"keyup",_a.hitch(this,"_onKeyUp")));
},destroy:function(){
if(this._opened){
this.closeDropDown(true);
}
if(this.dropDown){
if(!this.dropDown._destroyed){
this.dropDown.destroyRecursive();
}
delete this.dropDown;
}
this.inherited(arguments);
},_onKey:function(e){
if(this.disabled||this.readOnly){
return;
}
var d=this.dropDown,_15=e.target;
if(d&&this._opened&&d.handleKey){
if(d.handleKey(e)===false){
e.stopPropagation();
e.preventDefault();
return;
}
}
if(d&&this._opened&&e.keyCode==_9.ESCAPE){
this.closeDropDown();
e.stopPropagation();
e.preventDefault();
}else{
if(!this._opened&&(e.keyCode==_9.DOWN_ARROW||((e.keyCode==_9.ENTER||(e.keyCode==_9.SPACE&&(!this._searchTimer||(e.ctrlKey||e.altKey||e.metaKey))))&&((_15.tagName||"").toLowerCase()!=="input"||(_15.type&&_15.type.toLowerCase()!=="text"))))){
this._toggleOnKeyUp=true;
e.stopPropagation();
e.preventDefault();
}
}
},_onKeyUp:function(){
if(this._toggleOnKeyUp){
delete this._toggleOnKeyUp;
this.toggleDropDown();
var d=this.dropDown;
if(d&&d.focus){
this.defer(_a.hitch(d,"focus"),1);
}
}
},_onBlur:function(){
this.closeDropDown(false);
this.inherited(arguments);
},isLoaded:function(){
return true;
},loadDropDown:function(_16){
_16();
},loadAndOpenDropDown:function(){
var d=new _2(),_17=_a.hitch(this,function(){
this.openDropDown();
d.resolve(this.dropDown);
});
if(!this.isLoaded()){
this.loadDropDown(_17);
}else{
_17();
}
return d;
},toggleDropDown:function(){
if(this.disabled||this.readOnly){
return;
}
if(!this._opened){
this.loadAndOpenDropDown();
}else{
this.closeDropDown(true);
}
},openDropDown:function(){
var _18=this.dropDown,_19=_18.domNode,_1a=this._aroundNode||this.domNode,_1b=this;
var _1c=_e.open({parent:this,popup:_18,around:_1a,orient:this.dropDownPosition,maxHeight:this.maxHeight,onExecute:function(){
_1b.closeDropDown(true);
},onCancel:function(){
_1b.closeDropDown(true);
},onClose:function(){
_4.set(_1b._popupStateNode,"popupActive",false);
_5.remove(_1b._popupStateNode,"dijitHasDropDownOpen");
_1b._set("_opened",false);
}});
if(this.forceWidth||(this.autoWidth&&_1a.offsetWidth>_18._popupWrapper.offsetWidth)){
var _1d=_1a.offsetWidth-_18._popupWrapper.offsetWidth;
var _1e={w:_18.domNode.offsetWidth+_1d};
this._origStyle=_19.style.cssText;
if(_a.isFunction(_18.resize)){
_18.resize(_1e);
}else{
_6.setMarginBox(_19,_1e);
}
if(_1c.corner[1]=="R"){
_18._popupWrapper.style.left=(_18._popupWrapper.style.left.replace("px","")-_1d)+"px";
}
}
_4.set(this._popupStateNode,"popupActive","true");
_5.add(this._popupStateNode,"dijitHasDropDownOpen");
this._set("_opened",true);
this._popupStateNode.setAttribute("aria-expanded","true");
this._popupStateNode.setAttribute("aria-owns",_18.id);
if(_19.getAttribute("role")!=="presentation"&&!_19.getAttribute("aria-labelledby")){
_19.setAttribute("aria-labelledby",this.id);
}
return _1c;
},closeDropDown:function(_1f){
if(this._focusDropDownTimer){
this._focusDropDownTimer.remove();
delete this._focusDropDownTimer;
}
if(this._opened){
this._popupStateNode.setAttribute("aria-expanded","false");
if(_1f&&this.focus){
this.focus();
}
_e.close(this.dropDown);
this._opened=false;
}
if(this._origStyle){
this.dropDown.domNode.style.cssText=this._origStyle;
delete this._origStyle;
}
}});
});


;define("dojo/text!dijit/form/templates/DropDownButton.html", '<span class="dijit dijitReset dijitInline"	><span class=\'dijitReset dijitInline dijitButtonNode\'		data-dojo-attach-event="ondijitclick:__onClick" data-dojo-attach-point="_buttonNode"		><span class="dijitReset dijitStretch dijitButtonContents"			data-dojo-attach-point="focusNode,titleNode,_arrowWrapperNode,_popupStateNode"			role="button" aria-haspopup="true" aria-labelledby="${id}_label"			><span class="dijitReset dijitInline dijitIcon"				data-dojo-attach-point="iconNode"			></span			><span class="dijitReset dijitInline dijitButtonText"				data-dojo-attach-point="containerNode"				id="${id}_label"			></span			><span class="dijitReset dijitInline dijitArrowButtonInner"></span			><span class="dijitReset dijitInline dijitArrowButtonChar">&#9660;</span		></span	></span	><input ${!nameAttrSetting} type="${type}" value="${value}" class="dijitOffScreen" tabIndex="-1"		data-dojo-attach-event="onclick:_onClick" data-dojo-attach-point="valueNode" aria-hidden="true"/></span>');

;define("dijit/form/DropDownButton",["dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","dojo/query","../registry","../popup","./Button","../_Container","../_HasDropDown","dojo/text!./templates/DropDownButton.html","../a11yclick"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){
return _1("dijit.form.DropDownButton",[_7,_8,_9],{baseClass:"dijitDropDownButton",templateString:_a,_fillContent:function(){
var _b=this.srcNodeRef;
var _c=this.containerNode;
if(_b&&_c){
while(_b.hasChildNodes()){
var _d=_b.firstChild;
if(_d.hasAttribute&&(_d.hasAttribute("data-dojo-type")||_d.hasAttribute("dojoType")||_d.hasAttribute("data-"+_2._scopeName+"-type")||_d.hasAttribute(_2._scopeName+"Type"))){
this.dropDownContainer=this.ownerDocument.createElement("div");
this.dropDownContainer.appendChild(_d);
}else{
_c.appendChild(_d);
}
}
}
},startup:function(){
if(this._started){
return;
}
if(!this.dropDown&&this.dropDownContainer){
this.dropDown=_5.byNode(this.dropDownContainer.firstChild);
delete this.dropDownContainer;
}
if(this.dropDown){
_6.hide(this.dropDown);
}
this.inherited(arguments);
},isLoaded:function(){
var _e=this.dropDown;
return (!!_e&&(!_e.href||_e.isLoaded));
},loadDropDown:function(_f){
var _10=this.dropDown;
var _11=_10.on("load",_3.hitch(this,function(){
_11.remove();
_f();
}));
_10.refresh();
},isFocusable:function(){
return this.inherited(arguments)&&!this._mouseDown;
}});
});


;define("dojo/text!dijit/form/templates/ComboButton.html", '<table class="dijit dijitReset dijitInline dijitLeft"	cellspacing=\'0\' cellpadding=\'0\' role="presentation"	><tbody role="presentation"><tr role="presentation"		><td class="dijitReset dijitStretch dijitButtonNode" data-dojo-attach-point="buttonNode" data-dojo-attach-event="ondijitclick:__onClick,onkeydown:_onButtonKeyDown"		><div id="${id}_button" class="dijitReset dijitButtonContents"			data-dojo-attach-point="titleNode"			role="button" aria-labelledby="${id}_label"			><div class="dijitReset dijitInline dijitIcon" data-dojo-attach-point="iconNode" role="presentation"></div			><div class="dijitReset dijitInline dijitButtonText" id="${id}_label" data-dojo-attach-point="containerNode" role="presentation"></div		></div		></td		><td id="${id}_arrow" class=\'dijitReset dijitRight dijitButtonNode dijitArrowButton\'			data-dojo-attach-point="_popupStateNode,focusNode,_buttonNode"			data-dojo-attach-event="onkeydown:_onArrowKeyDown"			title="${optionsTitle}"			role="button" aria-haspopup="true"			><div class="dijitReset dijitArrowButtonInner" role="presentation"></div			><div class="dijitReset dijitArrowButtonChar" role="presentation">&#9660;</div		></td		><td style="display:none !important;"			><input ${!nameAttrSetting} type="${type}" value="${value}" data-dojo-attach-point="valueNode"				class="dijitOffScreen" aria-hidden="true" data-dojo-attach-event="onclick:_onClick"		/></td></tr></tbody></table>');

;define("dijit/form/ComboButton",["dojo/_base/declare","dojo/keys","../focus","./DropDownButton","dojo/text!./templates/ComboButton.html","../a11yclick"],function(_1,_2,_3,_4,_5){
return _1("dijit.form.ComboButton",_4,{templateString:_5,_setIdAttr:"",_setTabIndexAttr:["focusNode","titleNode"],_setTitleAttr:"titleNode",optionsTitle:"",baseClass:"dijitComboButton",cssStateNodes:{"buttonNode":"dijitButtonNode","titleNode":"dijitButtonContents","_popupStateNode":"dijitDownArrowButton"},_focusedNode:null,_onButtonKeyDown:function(_6){
if(_6.keyCode==_2[this.isLeftToRight()?"RIGHT_ARROW":"LEFT_ARROW"]){
_3.focus(this._popupStateNode);
_6.stopPropagation();
_6.preventDefault();
}
},_onArrowKeyDown:function(_7){
if(_7.keyCode==_2[this.isLeftToRight()?"LEFT_ARROW":"RIGHT_ARROW"]){
_3.focus(this.titleNode);
_7.stopPropagation();
_7.preventDefault();
}
},focus:function(_8){
if(!this.disabled){
_3.focus(_8=="start"?this.titleNode:this._popupStateNode);
}
}});
});


;define("dijit/form/_ToggleButtonMixin",["dojo/_base/declare","dojo/dom-attr"],function(_1,_2){
return _1("dijit.form._ToggleButtonMixin",null,{checked:false,_aria_attr:"aria-pressed",_onClick:function(_3){
var _4=this.checked;
this._set("checked",!_4);
var _5=this.inherited(arguments);
this.set("checked",_5?this.checked:_4);
return _5;
},_setCheckedAttr:function(_6,_7){
this._set("checked",_6);
var _8=this.focusNode||this.domNode;
if(this._created){
if(_2.get(_8,"checked")!=!!_6){
_2.set(_8,"checked",!!_6);
}
}
_8.setAttribute(this._aria_attr,String(_6));
this._handleOnChange(_6,_7);
},postCreate:function(){
this.inherited(arguments);
var _9=this.focusNode||this.domNode;
if(this.checked){
_9.setAttribute("checked","checked");
}
if(this._resetValue===undefined){
this._lastValueReported=this._resetValue=this.checked;
}
},reset:function(){
this._hasBeenBlurred=false;
this.set("checked",this.params.checked||false);
}});
});


;define("dijit/form/ToggleButton",["dojo/_base/declare","dojo/_base/kernel","./Button","./_ToggleButtonMixin"],function(_1,_2,_3,_4){
return _1("dijit.form.ToggleButton",[_3,_4],{baseClass:"dijitToggleButton",setChecked:function(_5){
_2.deprecated("setChecked("+_5+") is deprecated. Use set('checked',"+_5+") instead.","","2.0");
this.set("checked",_5);
}});
});


;define("dijit/form/_TextBoxMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/sniff","dojo/keys","dojo/_base/lang","dojo/on","../main"],function(_1,_2,_3,_4,_5,_6,on,_7){
var _8=_2("dijit.form._TextBoxMixin"+(_4("dojo-bidi")?"_NoBidi":""),null,{trim:false,uppercase:false,lowercase:false,propercase:false,maxLength:"",selectOnClick:false,placeHolder:"",_getValueAttr:function(){
return this.parse(this.get("displayedValue"),this.constraints);
},_setValueAttr:function(_9,_a,_b){
var _c;
if(_9!==undefined){
_c=this.filter(_9);
if(typeof _b!="string"){
if(_c!==null&&((typeof _c!="number")||!isNaN(_c))){
_b=this.filter(this.format(_c,this.constraints));
}else{
_b="";
}
if(this.compare(_c,this.filter(this.parse(_b,this.constraints)))!=0){
_b=null;
}
}
}
if(_b!=null&&((typeof _b)!="number"||!isNaN(_b))&&this.textbox.value!=_b){
this.textbox.value=_b;
this._set("displayedValue",this.get("displayedValue"));
}
this.inherited(arguments,[_c,_a]);
},displayedValue:"",_getDisplayedValueAttr:function(){
return this.filter(this.textbox.value);
},_setDisplayedValueAttr:function(_d){
if(_d==null){
_d="";
}else{
if(typeof _d!="string"){
_d=String(_d);
}
}
this.textbox.value=_d;
this._setValueAttr(this.get("value"),undefined);
this._set("displayedValue",this.get("displayedValue"));
},format:function(_e){
return _e==null?"":(_e.toString?_e.toString():_e);
},parse:function(_f){
return _f;
},_refreshState:function(){
},onInput:function(){
},_onInput:function(evt){
this._lastInputEventValue=this.textbox.value;
this._processInput(this._lastInputProducingEvent||evt);
delete this._lastInputProducingEvent;
if(this.intermediateChanges){
this._handleOnChange(this.get("value"),false);
}
},_processInput:function(){
this._refreshState();
this._set("displayedValue",this.get("displayedValue"));
},postCreate:function(){
this.textbox.setAttribute("value",this.textbox.value);
this.inherited(arguments);
function _10(e){
var _11;
if(e.type=="keydown"&&e.keyCode!=229){
_11=e.keyCode;
switch(_11){
case _5.SHIFT:
case _5.ALT:
case _5.CTRL:
case _5.META:
case _5.CAPS_LOCK:
case _5.NUM_LOCK:
case _5.SCROLL_LOCK:
return;
}
if(!e.ctrlKey&&!e.metaKey&&!e.altKey){
switch(_11){
case _5.NUMPAD_0:
case _5.NUMPAD_1:
case _5.NUMPAD_2:
case _5.NUMPAD_3:
case _5.NUMPAD_4:
case _5.NUMPAD_5:
case _5.NUMPAD_6:
case _5.NUMPAD_7:
case _5.NUMPAD_8:
case _5.NUMPAD_9:
case _5.NUMPAD_MULTIPLY:
case _5.NUMPAD_PLUS:
case _5.NUMPAD_ENTER:
case _5.NUMPAD_MINUS:
case _5.NUMPAD_PERIOD:
case _5.NUMPAD_DIVIDE:
return;
}
if((_11>=65&&_11<=90)||(_11>=48&&_11<=57)||_11==_5.SPACE){
return;
}
var _12=false;
for(var i in _5){
if(_5[i]===e.keyCode){
_12=true;
break;
}
}
if(!_12){
return;
}
}
}
_11=e.charCode>=32?String.fromCharCode(e.charCode):e.charCode;
if(!_11){
_11=(e.keyCode>=65&&e.keyCode<=90)||(e.keyCode>=48&&e.keyCode<=57)||e.keyCode==_5.SPACE?String.fromCharCode(e.keyCode):e.keyCode;
}
if(!_11){
_11=229;
}
if(e.type=="keypress"){
if(typeof _11!="string"){
return;
}
if((_11>="a"&&_11<="z")||(_11>="A"&&_11<="Z")||(_11>="0"&&_11<="9")||(_11===" ")){
if(e.ctrlKey||e.metaKey||e.altKey){
return;
}
}
}
var _13={faux:true},_14;
for(_14 in e){
if(!/^(layer[XY]|returnValue|keyLocation)$/.test(_14)){
var v=e[_14];
if(typeof v!="function"&&typeof v!="undefined"){
_13[_14]=v;
}
}
}
_6.mixin(_13,{charOrCode:_11,_wasConsumed:false,preventDefault:function(){
_13._wasConsumed=true;
e.preventDefault();
},stopPropagation:function(){
e.stopPropagation();
}});
this._lastInputProducingEvent=_13;
if(this.onInput(_13)===false){
_13.preventDefault();
_13.stopPropagation();
}
if(_13._wasConsumed){
return;
}
if(_4("ie")<=9){
switch(e.keyCode){
case _5.TAB:
case _5.ESCAPE:
case _5.DOWN_ARROW:
case _5.UP_ARROW:
case _5.LEFT_ARROW:
case _5.RIGHT_ARROW:
break;
default:
if(e.keyCode==_5.ENTER&&this.textbox.tagName.toLowerCase()!="textarea"){
break;
}
this.defer(function(){
if(this.textbox.value!==this._lastInputEventValue){
on.emit(this.textbox,"input",{bubbles:true});
}
});
}
}
};
this.own(on(this.textbox,"keydown, keypress, paste, cut, compositionend",_6.hitch(this,_10)),on(this.textbox,"input",_6.hitch(this,"_onInput")),on(this.domNode,"keypress",function(e){
e.stopPropagation();
}));
},_blankValue:"",filter:function(val){
if(val===null){
return this._blankValue;
}
if(typeof val!="string"){
return val;
}
if(this.trim){
val=_6.trim(val);
}
if(this.uppercase){
val=val.toUpperCase();
}
if(this.lowercase){
val=val.toLowerCase();
}
if(this.propercase){
val=val.replace(/[^\s]+/g,function(_15){
return _15.substring(0,1).toUpperCase()+_15.substring(1);
});
}
return val;
},_setBlurValue:function(){
this._setValueAttr(this.get("value"),true);
},_onBlur:function(e){
if(this.disabled){
return;
}
this._setBlurValue();
this.inherited(arguments);
},_isTextSelected:function(){
return this.textbox.selectionStart!=this.textbox.selectionEnd;
},_onFocus:function(by){
if(this.disabled||this.readOnly){
return;
}
if(this.selectOnClick&&by=="mouse"){
this._selectOnClickHandle=on.once(this.domNode,"mouseup, touchend",_6.hitch(this,function(evt){
if(!this._isTextSelected()){
_8.selectInputText(this.textbox);
}
}));
this.own(this._selectOnClickHandle);
this.defer(function(){
if(this._selectOnClickHandle){
this._selectOnClickHandle.remove();
this._selectOnClickHandle=null;
}
},500);
}
this.inherited(arguments);
this._refreshState();
},reset:function(){
this.textbox.value="";
this.inherited(arguments);
}});
if(_4("dojo-bidi")){
_8=_2("dijit.form._TextBoxMixin",_8,{_setValueAttr:function(){
this.inherited(arguments);
this.applyTextDir(this.focusNode);
},_setDisplayedValueAttr:function(){
this.inherited(arguments);
this.applyTextDir(this.focusNode);
},_onInput:function(){
this.applyTextDir(this.focusNode);
this.inherited(arguments);
}});
}
_8._setSelectionRange=_7._setSelectionRange=function(_16,_17,_18){
if(_16.setSelectionRange){
_16.setSelectionRange(_17,_18);
}
};
_8.selectInputText=_7.selectInputText=function(_19,_1a,_1b){
_19=_3.byId(_19);
if(isNaN(_1a)){
_1a=0;
}
if(isNaN(_1b)){
_1b=_19.value?_19.value.length:0;
}
try{
_19.focus();
_8._setSelectionRange(_19,_1a,_1b);
}
catch(e){
}
};
return _8;
});


;define("dojo/text!dijit/form/templates/TextBox.html", '<div class="dijit dijitReset dijitInline dijitLeft" id="widget_${id}" role="presentation"	><div class="dijitReset dijitInputField dijitInputContainer"		><input class="dijitReset dijitInputInner" data-dojo-attach-point=\'textbox,focusNode\' autocomplete="off"			${!nameAttrSetting} type=\'${type}\'	/></div></div>');

;define("dijit/form/TextBox",["dojo/_base/declare","dojo/dom-construct","dojo/dom-style","dojo/_base/kernel","dojo/_base/lang","dojo/on","dojo/sniff","./_FormValueWidget","./_TextBoxMixin","dojo/text!./templates/TextBox.html","../main"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a){
var _b=_1("dijit.form.TextBox"+(_6("dojo-bidi")?"_NoBidi":""),[_7,_8],{templateString:_9,_singleNodeTemplate:"<input class=\"dijit dijitReset dijitLeft dijitInputField\" data-dojo-attach-point=\"textbox,focusNode\" autocomplete=\"off\" type=\"${type}\" ${!nameAttrSetting} />",_buttonInputDisabled:_6("ie")?"disabled":"",baseClass:"dijitTextBox",postMixInProperties:function(){
var _c=this.type.toLowerCase();
if(this.templateString&&this.templateString.toLowerCase()=="input"||((_c=="hidden"||_c=="file")&&this.templateString==this.constructor.prototype.templateString)){
this.templateString=this._singleNodeTemplate;
}
this.inherited(arguments);
},postCreate:function(){
this.inherited(arguments);
if(_6("ie")<9){
this.defer(function(){
try{
var s=_3.getComputedStyle(this.domNode);
if(s){
var ff=s.fontFamily;
if(ff){
var _d=this.domNode.getElementsByTagName("INPUT");
if(_d){
for(var i=0;i<_d.length;i++){
_d[i].style.fontFamily=ff;
}
}
}
}
}
catch(e){
}
});
}
},_setPlaceHolderAttr:function(v){
this._set("placeHolder",v);
if(!this._phspan){
this._attachPoints.push("_phspan");
this._phspan=_2.create("span",{className:"dijitPlaceHolder dijitInputField"},this.textbox,"after");
this.own(on(this._phspan,"mousedown",function(_e){
_e.preventDefault();
}),on(this._phspan,"touchend, pointerup, MSPointerUp",_5.hitch(this,function(){
this.focus();
})));
}
this._phspan.innerHTML="";
this._phspan.appendChild(this._phspan.ownerDocument.createTextNode(v));
this._updatePlaceHolder();
},_onInput:function(_f){
this.inherited(arguments);
this._updatePlaceHolder();
},_updatePlaceHolder:function(){
if(this._phspan){
this._phspan.style.display=(this.placeHolder&&!this.textbox.value)?"":"none";
}
},_setValueAttr:function(_10,_11,_12){
this.inherited(arguments);
this._updatePlaceHolder();
},getDisplayedValue:function(){
_4.deprecated(this.declaredClass+"::getDisplayedValue() is deprecated. Use get('displayedValue') instead.","","2.0");
return this.get("displayedValue");
},setDisplayedValue:function(_13){
_4.deprecated(this.declaredClass+"::setDisplayedValue() is deprecated. Use set('displayedValue', ...) instead.","","2.0");
this.set("displayedValue",_13);
},_onBlur:function(e){
if(this.disabled){
return;
}
this.inherited(arguments);
this._updatePlaceHolder();
if(_6("mozilla")){
if(this.selectOnClick){
this.textbox.selectionStart=this.textbox.selectionEnd=undefined;
}
}
},_onFocus:function(by){
if(this.disabled||this.readOnly){
return;
}
this.inherited(arguments);
this._updatePlaceHolder();
}});
if(_6("ie")<9){
_b.prototype._isTextSelected=function(){
var _14=this.ownerDocument.selection.createRange();
var _15=_14.parentElement();
return _15==this.textbox&&_14.text.length>0;
};
_a._setSelectionRange=_8._setSelectionRange=function(_16,_17,_18){
if(_16.createTextRange){
var r=_16.createTextRange();
r.collapse(true);
r.moveStart("character",-99999);
r.moveStart("character",_17);
r.moveEnd("character",_18-_17);
r.select();
}
};
}
if(_6("dojo-bidi")){
_b=_1("dijit.form.TextBox",_b,{_setPlaceHolderAttr:function(v){
this.inherited(arguments);
this.applyTextDir(this._phspan);
}});
}
return _b;
});


;define("dojo/text!dijit/templates/InlineEditBox.html", '<span data-dojo-attach-point="editNode" role="presentation" class="dijitReset dijitInline dijitOffScreen"	><span data-dojo-attach-point="editorPlaceholder"></span	><span data-dojo-attach-point="buttonContainer"		><button data-dojo-type="./form/Button" data-dojo-props="label: \'${buttonSave}\', \'class\': \'saveButton\'"			data-dojo-attach-point="saveButton" data-dojo-attach-event="onClick:save"></button		><button data-dojo-type="./form/Button"  data-dojo-props="label: \'${buttonCancel}\', \'class\': \'cancelButton\'"			data-dojo-attach-point="cancelButton" data-dojo-attach-event="onClick:cancel"></button	></span></span>');

;define("dijit/InlineEditBox",["require","dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/i18n","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/on","dojo/sniff","dojo/when","./a11yclick","./focus","./_Widget","./_TemplatedMixin","./_WidgetsInTemplateMixin","./_Container","./form/Button","./form/_TextBoxMixin","./form/TextBox","dojo/text!./templates/InlineEditBox.html","dojo/i18n!./nls/common"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,on,_d,_e,_f,fm,_10,_11,_12,_13,_14,_15,_16,_17){
var _18=_4("dijit._InlineEditor",[_10,_11,_12],{templateString:_17,contextRequire:_1,postMixInProperties:function(){
this.inherited(arguments);
this.messages=_9.getLocalization("dijit","common",this.lang);
_2.forEach(["buttonSave","buttonCancel"],function(_19){
if(!this[_19]){
this[_19]=this.messages[_19];
}
},this);
},buildRendering:function(){
this.inherited(arguments);
var Cls=typeof this.editor=="string"?(_c.getObject(this.editor)||_1(this.editor)):this.editor;
var _1a=this.sourceStyle,_1b="line-height:"+_1a.lineHeight+";",_1c=_8.getComputedStyle(this.domNode);
_2.forEach(["Weight","Family","Size","Style"],function(_1d){
var _1e=_1a["font"+_1d],_1f=_1c["font"+_1d];
if(_1f!=_1e){
_1b+="font-"+_1d+":"+_1a["font"+_1d]+";";
}
},this);
_2.forEach(["marginTop","marginBottom","marginLeft","marginRight","position","left","top","right","bottom","float","clear","display"],function(_20){
this.domNode.style[_20]=_1a[_20];
},this);
var _21=this.inlineEditBox.width;
if(_21=="100%"){
_1b+="width:100%;";
this.domNode.style.display="block";
}else{
_1b+="width:"+(_21+(Number(_21)==_21?"px":""))+";";
}
var _22=_c.delegate(this.inlineEditBox.editorParams,{style:_1b,dir:this.dir,lang:this.lang,textDir:this.textDir});
this.editWidget=new Cls(_22,this.editorPlaceholder);
if(this.inlineEditBox.autoSave){
this.saveButton.destroy();
this.cancelButton.destroy();
this.saveButton=this.cancelButton=null;
_7.destroy(this.buttonContainer);
}
},postCreate:function(){
this.inherited(arguments);
var ew=this.editWidget;
if(this.inlineEditBox.autoSave){
this.own(_3.after(ew,"onChange",_c.hitch(this,"_onChange"),true),on(ew,"keydown",_c.hitch(this,"_onKeyDown")));
}else{
if("intermediateChanges" in ew){
ew.set("intermediateChanges",true);
this.own(_3.after(ew,"onChange",_c.hitch(this,"_onIntermediateChange"),true));
this.saveButton.set("disabled",true);
}
}
},startup:function(){
this.editWidget.startup();
this.inherited(arguments);
},_onIntermediateChange:function(){
this.saveButton.set("disabled",(this.getValue()==this._resetValue)||!this.enableSave());
},destroy:function(){
this.editWidget.destroy(true);
this.inherited(arguments);
},getValue:function(){
var ew=this.editWidget;
return String(ew.get(("displayedValue" in ew||"_getDisplayedValueAttr" in ew)?"displayedValue":"value"));
},_onKeyDown:function(e){
if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){
if(e.altKey||e.ctrlKey){
return;
}
if(e.keyCode==_b.ESCAPE){
e.stopPropagation();
e.preventDefault();
this.cancel(true);
}else{
if(e.keyCode==_b.ENTER&&e.target.tagName=="INPUT"){
e.stopPropagation();
e.preventDefault();
this._onChange();
}
}
}
},_onBlur:function(){
this.inherited(arguments);
if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing){
if(this.getValue()==this._resetValue){
this.cancel(false);
}else{
if(this.enableSave()){
this.save(false);
}
}
}
},_onChange:function(){
if(this.inlineEditBox.autoSave&&this.inlineEditBox.editing&&this.enableSave()){
fm.focus(this.inlineEditBox.displayNode);
}
},enableSave:function(){
return this.editWidget.isValid?this.editWidget.isValid():true;
},focus:function(){
this.editWidget.focus();
if(this.editWidget.focusNode){
fm._onFocusNode(this.editWidget.focusNode);
if(this.editWidget.focusNode.tagName=="INPUT"){
this.defer(function(){
_15.selectInputText(this.editWidget.focusNode);
});
}
}
}});
var _23=_4("dijit.InlineEditBox"+(_d("dojo-bidi")?"_NoBidi":""),_10,{editing:false,autoSave:true,buttonSave:"",buttonCancel:"",renderAsHtml:false,editor:_16,editorWrapper:_18,editorParams:{},disabled:false,onChange:function(){
},onCancel:function(){
},width:"100%",value:"",noValueIndicator:_d("ie")<=6?"<span style='font-family: wingdings; text-decoration: underline;'>&#160;&#160;&#160;&#160;&#x270d;&#160;&#160;&#160;&#160;</span>":"<span style='text-decoration: underline;'>&#160;&#160;&#160;&#160;&#x270d;&#160;&#160;&#160;&#160;</span>",constructor:function(){
this.editorParams={};
},postMixInProperties:function(){
this.inherited(arguments);
this.displayNode=this.srcNodeRef;
this.own(on(this.displayNode,_f,_c.hitch(this,"_onClick")),on(this.displayNode,"mouseover, focus",_c.hitch(this,"_onMouseOver")),on(this.displayNode,"mouseout, blur",_c.hitch(this,"_onMouseOut")));
this.displayNode.setAttribute("role","button");
if(!this.displayNode.getAttribute("tabIndex")){
this.displayNode.setAttribute("tabIndex",0);
}
if(!this.value&&!("value" in this.params)){
this.value=_c.trim(this.renderAsHtml?this.displayNode.innerHTML:(this.displayNode.innerText||this.displayNode.textContent||""));
}
if(!this.value){
this.displayNode.innerHTML=this.noValueIndicator;
}
_6.add(this.displayNode,"dijitInlineEditBoxDisplayMode");
},setDisabled:function(_24){
_a.deprecated("dijit.InlineEditBox.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");
this.set("disabled",_24);
},_setDisabledAttr:function(_25){
this.domNode.setAttribute("aria-disabled",_25?"true":"false");
if(_25){
this.displayNode.removeAttribute("tabIndex");
}else{
this.displayNode.setAttribute("tabIndex",0);
}
_6.toggle(this.displayNode,"dijitInlineEditBoxDisplayModeDisabled",_25);
this._set("disabled",_25);
},_onMouseOver:function(){
if(!this.disabled){
_6.add(this.displayNode,"dijitInlineEditBoxDisplayModeHover");
}
},_onMouseOut:function(){
_6.remove(this.displayNode,"dijitInlineEditBoxDisplayModeHover");
},_onClick:function(e){
if(this.disabled){
return;
}
if(e){
e.stopPropagation();
e.preventDefault();
}
this._onMouseOut();
this.defer("edit");
},edit:function(){
if(this.disabled||this.editing){
return;
}
this._set("editing",true);
this._savedTabIndex=_5.get(this.displayNode,"tabIndex")||"0";
if(!this.wrapperWidget){
var _26=_7.create("span",null,this.domNode,"before");
var Ewc=typeof this.editorWrapper=="string"?_c.getObject(this.editorWrapper):this.editorWrapper;
this.wrapperWidget=new Ewc({value:this.value,buttonSave:this.buttonSave,buttonCancel:this.buttonCancel,dir:this.dir,lang:this.lang,tabIndex:this._savedTabIndex,editor:this.editor,inlineEditBox:this,sourceStyle:_8.getComputedStyle(this.displayNode),save:_c.hitch(this,"save"),cancel:_c.hitch(this,"cancel"),textDir:this.textDir},_26);
if(!this.wrapperWidget._started){
this.wrapperWidget.startup();
}
if(!this._started){
this.startup();
}
}
var ww=this.wrapperWidget;
_6.add(this.displayNode,"dijitOffScreen");
_6.remove(ww.domNode,"dijitOffScreen");
_8.set(ww.domNode,{visibility:"visible"});
_5.set(this.displayNode,"tabIndex","-1");
var ew=ww.editWidget;
var _27=this;
_e(ew.onLoadDeferred,_c.hitch(ww,function(){
ew.set(("displayedValue" in ew||"_setDisplayedValueAttr" in ew)?"displayedValue":"value",_27.value);
this.defer(function(){
if(ww.saveButton){
ww.saveButton.set("disabled","intermediateChanges" in ew);
}
this.focus();
this._resetValue=this.getValue();
});
}));
},_onBlur:function(){
this.inherited(arguments);
if(!this.editing){
}
},destroy:function(){
if(this.wrapperWidget&&!this.wrapperWidget._destroyed){
this.wrapperWidget.destroy();
delete this.wrapperWidget;
}
this.inherited(arguments);
},_showText:function(_28){
var ww=this.wrapperWidget;
_8.set(ww.domNode,{visibility:"hidden"});
_6.add(ww.domNode,"dijitOffScreen");
_6.remove(this.displayNode,"dijitOffScreen");
_5.set(this.displayNode,"tabIndex",this._savedTabIndex);
if(_28){
fm.focus(this.displayNode);
}
},save:function(_29){
if(this.disabled||!this.editing){
return;
}
this._set("editing",false);
var ww=this.wrapperWidget;
var _2a=ww.getValue();
this.set("value",_2a);
this._showText(_29);
},setValue:function(val){
_a.deprecated("dijit.InlineEditBox.setValue() is deprecated.  Use set('value', ...) instead.","","2.0");
return this.set("value",val);
},_setValueAttr:function(val){
val=_c.trim(val);
var _2b=this.renderAsHtml?val:val.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/\n/g,"<br>");
if(this.editorParams&&this.editorParams.type==="password"){
this.displayNode.innerHTML="********";
}else{
this.displayNode.innerHTML=_2b||this.noValueIndicator;
}
this._set("value",val);
if(this._started){
this.defer(function(){
this.onChange(val);
});
}
},getValue:function(){
_a.deprecated("dijit.InlineEditBox.getValue() is deprecated.  Use get('value') instead.","","2.0");
return this.get("value");
},cancel:function(_2c){
if(this.disabled||!this.editing){
return;
}
this._set("editing",false);
this.defer("onCancel");
this._showText(_2c);
}});
if(_d("dojo-bidi")){
_23=_4("dijit.InlineEditBox",_23,{_setValueAttr:function(){
this.inherited(arguments);
this.applyTextDir(this.displayNode);
}});
}
_23._InlineEditor=_18;
return _23;
});


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.Observable");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.internal.util.Observable",null,{addListener:function(_1,_2){
if(!this._callbacksByProperty){
this._callbacksByProperty=new Object();
}
var _3=this._callbacksByProperty[_2];
if(!_3){
_3=new Array();
this._callbacksByProperty[_2]=_3;
}
_3.push(_1);
},removeListener:function(_4,_5){
if(this._callbacksByProperty){
var _6=this._callbacksByProperty[_5];
if(_6){
for(var i=0;i<_6.length;i++){
if(_6[i]===_4){
_6.splice(i,1);
break;
}
}
}
}
},propertyChanged:function(_7,_8){
if(this._callbacksByProperty){
var _9=this._callbacksByProperty[_7];
if(_9){
for(var i=0;i<_9.length;i++){
_9[i](_7,_8);
}
}
}
}});
})();

dojo.provide("com.ibm.team.dashboard.web.ui.internal.DashboardConfiguration");
com.ibm.team.dashboard.web.ui.internal.DashboardConfiguration={
    "hrefs": {
        "allProjectDashboards": "\/web\/projects\/${projectName}#action=com.ibm.team.dashboard.viewAllDashboards",
        "allProjects": "\/web",
        "projectDashboard": "\/web\/projects\/${projectName}#action=com.ibm.team.dashboard.viewDashboard",
        "teamDashboard": "\/web\/projects\/${projectName}#action=com.ibm.team.dashboard.viewDashboard&team=${team}"
    },
    "projectDetails": [
    ],
    "teamDetails": [
    ]
};
;(function(){
dojo.provide("com.ibm.team.dashboard.web.util.DashboardUtil");








var _1=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _2=com.ibm.team.dashboard.web.ui.internal.DashboardConfiguration;
var _3="${projectName}";
var _4="${team}";
com.ibm.team.dashboard.web.util.DashboardUtil={getDashboardHref:function(_5,_6,_7,_8,_9,_a){
var _b;
_8=_8||jazz.app.context.get().name;
switch(_5){
case _1.SCOPE_CONTRIBUTOR:
_b="/dashboards/"+_6;
break;
case _1.SCOPE_PROJECT_AREA:
_b=_2.hrefs.projectDashboard;
_b=_b.replace(_3,encodeURIComponent(_8));
break;
case _1.SCOPE_TEAM_AREA:
var _c=[];
var _d=_6.length;
for(var i=0;i<_d;++i){
_c.push(encodeURIComponent(_6[i]));
}
_b=_2.hrefs.teamDashboard;
_b=_b.replace(_3,encodeURIComponent(_8));
_b=_b.replace(_4,_c.join("/"));
break;
}
if(_7){
var _e=_b.indexOf("#");
_b+=((_e!==-1&&_e<_b.length-1)?"&":"#")+_1.URL_PARAM_TAB+"="+_7;
}
if(!_a&&djConfig.isDebug){
var _f=_b.split("#");
_f[0]+="?debug="+djConfig.isDebug;
_b=_f.join("#");
}
return (_9||net.jazz.ajax.contextRoot())+_b;
}};
})();

dojo.setObject("net.jazz.ajax.rootServices", function() {
return null;
});
dojo.provide("net.jazz.ajax.rootServices");
;dojo.provide("com.ibm.team.dashboard.web.util.internal.Util");




















(function(){
var _1=com.ibm.team.dashboard.web.util.DashboardUtil;
var _2=com.ibm.team.dashboard.web.ui.internal.DashboardConfiguration;
var _3=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _4=com.ibm.team.dashboard.web.ui.internal.Constants;
var _5=new dojo._Url(location.href);
var _6=["debug","view"];
var _7="${projectName}";
com.ibm.team.dashboard.web.util.internal.Util={addUIParams:function(_8){
var _9=false;
var _a=[];
var _b=location.search;
if(_b&&_b.length>1){
var _c=dojo.queryToObject(_b.substring(1));
for(var i=0;i<_6.length;++i){
_a[i]=_c[_6[i]];
_9=_9||_a[i];
}
}
if(_9){
var _d=new dojo._Url(_8);
var _e=dojo.queryToObject(_d.query||"");
for(var i=0;i<_6.length;++i){
if(_a[i]){
_e[_6[i]]=_a[i];
}
}
_d.query=dojo.objectToQuery(_e);
var _f=[];
_d.scheme&&_f.push(_d.scheme+"://"+_d.host);
_d.port&&_f.push(":"+_d.port);
_d.path&&_f.push(_d.path);
_d.query&&_f.push("?"+_d.query);
_d.fragment&&_f.push("#"+_d.fragment);
return _f.join("");
}
return _8;
},getContextPath:function(_10){
var _11=net.jazz.ajax.contextRoot();
if(_10){
_11=_5.scheme+"://"+_5.host+(_5.port?":"+_5.port:"")+_11;
}
return _11;
},getDefinitionId:function(_12){
var url=new dojo._Url(_12);
return url.query.match(/definitionIds=([^&]*)/)[1];
},getJTSURL:function(){
var _13=net.jazz.ajax.BootstrapProperties.DISCOVERYSERVICE_URL;
if(_13){
var _14=_13.lastIndexOf("/");
if(_14!==-1){
return _13.substring(0,_14);
}
}
},getServiceRoot:function(url){
if(url){
var _15=url.indexOf("/service/com.ibm.team.dashboard.common.internal.service.IDashboardRestService");
if(_15!=-1){
return url.substring(0,_15);
}
_15=url.indexOf("/viewlet/");
if(_15!=-1){
return url.substring(0,_15);
}
return;
}
return this.getContextPath(true);
},getWebUIRoot:function(url){
var _16=url.indexOf("/viewlet/");
if(_16>0){
return url.substring(0,_16);
}
var url=new dojo._Url(url);
if(!url.query){
return "";
}
return decodeURIComponent(url.query.match(/webUIRoot=([^&]*)/)[1]);
},getServiceURL:function(_17,_18,_19,_1a){
if(!_1a){
_1a=this.getContextPath();
}
var buf=[_1a,"/service/",_17];
if(_18){
buf.push("/");
buf.push(_18);
}
if(_19){
buf.push("?");
buf.push(dojo.objectToQuery(_19));
}
var url=buf.join("");
var _1b=new dojo._Url(url);
return this._isDifferentOrigin(_1b)?jazz.app.proxy.encodeProxiedURI(url):url;
},getDashboardHref:function(_1c,_1d,_1e){
var _1f=_1c.scope;
var _20;
switch(_1f){
case _3.SCOPE_TEAM_AREA:
_20=_1c.defaults.team.path;
break;
case _3.SCOPE_PROJECT_AREA:
_20=_1c.defaults.project.name;
break;
default:
var url=_1c.dashboardUrl;
_1f=_3.SCOPE_CONTRIBUTOR;
_20=url.substring(url.lastIndexOf("/")+1);
break;
}
return _1.getDashboardHref(_1f,_20,_1d,_1e);
},getAllPersonalDashboardsHref:function(){
return net.jazz.ajax.contextRoot()+"/dashboards/all";
},getAllPersonalDashboardsHash:function(){
return "#/all";
},getAllProjectDashboardsHref:function(_21){
return this.addUIParams(net.jazz.ajax.contextRoot()+_2.hrefs.allProjectDashboards.replace(_7,encodeURIComponent(_21)));
},getAllProjectsHref:function(){
return this.addUIParams(net.jazz.ajax.contextRoot()+_2.hrefs.allProjects);
},getDashboardUpdateHref:function(){
return net.jazz.ajax.contextRoot()+"/dashboards/update";
},getDashboardParams:function(_22,_23,_24){
var _25=_22.scope;
var _26=_25==_3.SCOPE_TEAM_AREA?_22.defaults.team.path.join("/"):null;
var url=_22.dashboardUrl;
var id=url.substring(url.lastIndexOf("/")+1);
return this._getDashboardParams(_25,id,_26,_23,_24);
},_getDashboardParams:function(_27,id,_28,_29,_2a){
var _2b=new Object();
switch(_27){
case _3.SCOPE_CONTRIBUTOR:
_2b[_3.URL_PARAM_ID]=decodeURIComponent(id);
break;
case _3.SCOPE_TEAM_AREA:
_2b[_3.URL_PARAM_TEAM]=decodeURIComponent(_28);
break;
case _3.SCOPE_PROJECT_AREA:
if(!_2a){
_2b[_3.URL_PARAM_ID]=decodeURIComponent(id);
}
break;
}
if(_29){
_2b[_3.URL_PARAM_TAB]=decodeURIComponent(_29);
}
return _2b;
},getScopeItemName:function(_2c){
var _2d=_2c.dashboard.scopeItem.itemId;
var _2e=_2c.itemNames;
for(var i=0;i<_2e.length;i++){
if(_2e[i].itemId==_2d){
return _2e[i].name;
}
}
},getView:function(){
var _2f=location.search;
if(_2f&&_2f.length>1){
var _30=dojo.queryToObject(_2f.substring(1));
var _31=_30["view"];
if(_31==="embedded"){
return _31;
}
}
},isLocal:function(_32){
return this.isLocalOrigin(_32.origin);
},isLocalDefinition:function(url){
var _33=this.getWebUIRoot(url);
if(!_33){
return false;
}
var _34=net.jazz.ajax.viewletWebUIRoot()||(this.getContextPath(true));
return this._urlEquals(_33,_34);
},isLocalOrigin:function(_35){
if(!_35){
return true;
}
return this._urlEquals(_35,net.jazz.ajax.rootServices());
},toEntryArray:function(obj){
var _36=new Array();
if(obj){
for(var i in obj){
_36.push({id:i,value:obj[i]});
}
}
return _36;
},toJson:function(_37){
var _38=dojo.isArray;
dojo.isArray=_39;
try{
return dojo.toJson(_37);
}
finally{
dojo.isArray=_38;
}
},toObject:function(_3a){
var obj=new Object();
if(_3a){
for(var i=0;i<_3a.length;i++){
var _3b=_3a[i];
obj[_3b.id]=_3b.value;
}
}
return obj;
},isScopeApplicible:function(_3c,_3d){
if(!_3d.scopeSensitive){
return false;
}
if(_3d.appliesTo==_4.SCOPE_APPLIES_TO_ALL){
return true;
}
switch(_3c){
case _3.SCOPE_CONTRIBUTOR:
return _3d.appliesTo==_4.SCOPE_APPLIES_TO_CONTRIBUTORS;
case _3.SCOPE_TEAM_AREA:
return _3d.appliesTo==_4.SCOPE_APPLIES_TO_TEAMS||_3d.appliesTo==_4.SCOPE_APPLIES_TO_PROCESS;
case _3.SCOPE_PROJECT_AREA:
return _3d.appliesTo==_4.SCOPE_APPLIES_TO_PROJECTS||_3d.appliesTo==_4.SCOPE_APPLIES_TO_PROCESS;
}
},_isDifferentOrigin:function(url){
if(!url.host){
return false;
}
this._normalizePort(url);
var _3e=["scheme","host","port"];
for(var i=0;i<_3e.length;i++){
var _3f=_3e[i];
if(url[_3f]!==_5[_3f]){
return true;
}
}
return false;
},_normalizePort:function(url){
var _40=url.scheme||"http";
if(!url.port){
url.port=_40==="http"?"80":"443";
}
},_urlEquals:function(_41,_42){
_41=new dojo._Url(_41);
_42=new dojo._Url(_42);
this._normalizePort(_41);
this._normalizePort(_42);
if(_41.host.toLowerCase()!=_42.host.toLowerCase()){
return false;
}
var _43=["scheme","port","path","query","fragment"];
for(var i=0;i<_43.length;i++){
var _44=_43[i];
if(_41[_44]!==_42[_44]){
return false;
}
}
return true;
},_cast:function(_45,_46){
if(_45===_4.SettingsArea.FIELD_INTEGER){
var _47=parseInt(_46);
if(isNaN(_47)){
return null;
}
return _47;
}else{
if(_45===_4.SettingsArea.FIELD_BOOLEAN){
if(_46===true||_46===false){
return _46;
}
return _46==="true"?true:false;
}
}
return _46;
}};
function _39(_48){
return _48&&(typeof _48=="array"||_48 instanceof Array||(typeof _48=="object"&&isFinite(_48.length)));
};
})();


;(function(){
dojo.provide("jazz.app.ua.PageHoverHelp");












dojo.requireLocalization("jazz.app.ua.internal","HelpMessages");
dojo.declare("jazz.app.ua.PageHoverHelp",[dijit._Widget,dijit._Templated],{templateString:"<span class='jazz-app-ua-PageHoverHelp' dojoAttachPoint='_helpImg'><img src='${_blankGif}' alt='${messages.help}' class='j-mirror'/><span aria-hidden='true'>[?]</span></span>",constructor:function(_1){
this.messages=dojo.i18n.getLocalization("jazz.app.ua.internal","HelpMessages");
},uaKey:"",contentNode:null,contentString:null,postCreate:function(){
if(this.uaKey){
this.hoverPopup=new jazz.app.ua.internal.HelpHoverPopup({uaKey:this.uaKey,around:this._helpImg});
}else{
if(!this.contentNode){
this.contentNode=dojo.create("div");
this.contentNode.appendChild(document.createTextNode(this.contentString));
}
this.hoverPopup=new jazz.ui.HoverPopup({around:this._helpImg,createContents:dojo.hitch(this,function(_2){
return this.contentNode;
})});
}
},destroy:function(){
if(this.hoverPopup){
this.hoverPopup.destroy();
this.hoverPopup=null;
}
this.inherited(arguments);
}});
})();


;dojo.provide("jazz.ui.Breadcrumbs");










(function(){
dojo.declare("jazz.ui.Breadcrumbs",[dijit._Widget,dijit._Templated,dijit._Container],{segments:[],constructor:function(){
this.segments=[];
},refresh:function(){
this._liveSegments=dojo.clone(this.segments);
dojo.forEach(this.getChildren(),function(_1){
_1.destroyRecursive();
});
while(this.domNode.firstChild){
this.domNode.removeChild(this.domNode.firstChild);
}
for(var i=0;i<this._liveSegments.length;i++){
this._createCrumb(this._liveSegments[i]);
}
delete this._lastTruncate;
delete this._ellipsis;
setTimeout(dojo.hitch(this,this._truncate));
},templateString:"<div class='jazz-ui-Breadcrumbs' dojoAttachPoint='containerNode'></div>",postCreate:function(){
this.refresh();
this._resizeHandle=jazz.util.ResizeNotifier.register({context:this,callback:this._truncate});
},_createCrumb:function(_2){
var _3=new jazz.ui.internal.Crumb(_2);
_2.domNode=_3.domNode;
this.addChild(_3);
},_truncate:function(){
if(!this.domNode){
return;
}
var n,i,l=this._liveSegments.length;
if(this._lastTruncate){
if(this._lastTruncate.width===this.domNode.clientWidth){
return;
}else{
if(this._lastTruncate.width>this.domNode.clientWidth){
n=this._lastTruncate.n;
i=this._lastTruncate.i;
}else{
this._showAllSegments(l);
}
}
}
if(typeof n==="undefined"){
n=0;
i=Math.floor((l-1)/2);
}
while(this.domNode.clientHeight>16&&n<l-2){
if(!this._ellipsis){
this._ellipsis=document.createTextNode("... > ");
dojo.place(this._ellipsis,this._liveSegments[i].domNode,"after");
}
i+=n%2===l%2?-n:n;
dojo.addClass(this._liveSegments[i].domNode,"dijitHidden");
n++;
}
this._lastTruncate={width:this.domNode.clientWidth,n:n,i:i};
},_showAllSegments:function(l){
if(this._ellipsis&&this._ellipsis.parentNode){
this._ellipsis.parentNode.removeChild(this._ellipsis);
delete this._ellipsis;
}
for(var i=0;i<l;i++){
dojo.removeClass(this._liveSegments[i].domNode,"dijitHidden");
}
},destroy:function(){
jazz.util.ResizeNotifier.unregister(this._resizeHandle);
this.inherited(arguments);
}});
dojo.declare("jazz.ui.internal.Crumb",[dijit._Widget],{onClick:null,constructor:function(_4){
_4.clickHandler=_4.onClick;
delete _4.onClick;
},buildRendering:function(){
var _5,_6=this.domNode=dojo.create("span");
if(this.icon){
dojo.create("img",{src:this.icon,alt:this.altText||""},_6);
}else{
if(this.iconClass){
dojo.create("img",{src:this._blankGif,className:this.iconClass,alt:this.altText||""},_6);
}
}
if(this.href||this.clickHandler){
_5=dojo.create("a",{href:this.href,title:this.tooltip?this.tooltip:""},_6);
if(this.clickHandler){
this.connect(_5,"onclick",function(_7){
_7.preventDefault();
this.clickHandler(_7);
});
}
}else{
_5=dojo.create("span",{className:"plain-text",title:this.tooltip?this.tooltip:""},_6);
}
if(this.label){
_5.appendChild(document.createTextNode(this.label));
}else{
if(this.labelHTML){
_5.innerHTML=this.labelHTML;
}
}
this.applyTextDir(_5,_5.textContent);
var _8=dojo.create("span",{"aria-hidden":"true",innerHTML:" /",role:"presentation"},_6);
dojo.addClass(_8,"breadCrumbsSeparator");
}});
})();


;dojo.provide("jazz.ui.toolbar.Separator");


(function(){
dojo.declare("jazz.ui.toolbar.Separator",[dijit._Widget,dijit._Templated],{templateString:"<span class='jazz-ui-toolbar-Separator'></span>"});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/MetaNav.html", "<div class=\"com-ibm-team-dashboard-metanav\">	<div dojoAttachPoint=\"_breadcrumbs\" dojotype=\"jazz.ui.Breadcrumbs\"></div>	<div class=\"left-wrapper\"><span class=\"dashboard-title loading-title\" dojoAttachPoint=\"_dashboardTitle\">${messages.loading}</span></div>	<div class=\"header-links\" dojoAttachPoint=\"_headerLinks\">		<span class=\"dashboard-toolbar\" dojotype=\"jazz.ui.Toolbar\" dojoattachpoint=\"_toolbar\" style=\"display: none\" aria-label=\"${messages.toolbarAriaLabel}\">			<span imgClass=\"refresh-button\" dojotype=\"jazz.ui.toolbar.Button\" dojoattachpoint=\"_refreshButton\" dojoattachevent=\"onClick: _refresh\" imgSrc=\"${_blankGif}\" title=\"${messages.refresh}\"></span>		</span><span class=\"auto-save-area\" dojoattachpoint=\"_autoSaveArea\" style=\"display: none\">			<span class=\"auto-save\">				<input dojoattachpoint=\"_autoSave\" dojoattachevent=\"onclick: _setAutoSave\" id=\"autoSave-${id}\" type=\"checkbox\"/>				<label for=\"autoSave-${id}\">${messages.autoSave}</label>			</span>			<input dojoattachpoint=\"_saveButton\" dojoattachevent=\"onclick: _saveEditingHandler\" class=\"j-button-primary saveButton\" type=\"button\" value=\"${messages.save}\" disabled=\"disabled\"/>		</span>	</div>	<div dojoType=\"jazz.ui.MessageBox\" dojoAttachPoint=\"_messageBox\"></div></div>");

;(function(){
dojo.provide("com.ibm.team.dashboard.web.ui.internal.MetaNav");
















































dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
var _1=net.jazz.ajax.BootstrapProperties;
var _2=com.ibm.team.dashboard.web.ui.internal.Constants;
var _3=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _4=com.ibm.team.dashboard.web.ui.internal.DashboardInitializationData;
var _5=jazz.util.html;
var _6=com.ibm.team.dashboard.web.ui.internal.util.Observable;
var _7=com.ibm.team.dashboard.web.util.internal.Util;
var _8=com.ibm.team.dashboard.web.util.DashboardUtil;
var _9;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.MetaNav",[dijit._Widget,dijit._Templated,_6],{templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/MetaNav.html"),widgetsInTemplate:true,dashboardContainer:null,constructor:function(_a){
this.messages=_9=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
},postCreate:function(){
if(!this.textDir){
this.textDir=jazz.app.i18n.getPreferredBaseTextDir();
}
this.subscribe(_2.serverError,"_showErrorMessage");
this.subscribe(_2.hideServerError,"hideMessage");
},init:function(_b){
if(this.isInitialized){
return;
}
this.dashboardBundle=_b.dashboardBundle;
this.dashboardBinding=this.dashboardBundle.dashboard.binding;
this.allowDelete=_b.allowDelete;
this.allowSharing=_b.allowSharing;
this.allowSetDefault=_b.allowSetDefault;
this._dashboardTitle.innerHTML="";
dojo.removeClass(this._dashboardTitle,"loading-title");
this.setEditMode(_b.editMode);
var _c=this.dashboardBundle.permissions;
if(_b.showBreadcrumbs&&(_c.viewTeam||_c.viewPersonal)){
this._addBreadcrumbs();
}else{
this._breadcrumbs.domNode.style.display="none";
}
if(this.dashboardBundle.isScopeArchived){
var _d;
var _e=this.dashboardBundle.scope;
switch(_e){
case _3.SCOPE_CONTRIBUTOR:
_d=_9.archivedContributor;
break;
case _3.SCOPE_TEAM_AREA:
_d=_9.archivedTeam;
break;
case _3.SCOPE_PROJECT_AREA:
_d=_9.archivedProject;
break;
}
this.showMessage({type:jazz.ui.MessageBox.STATUS_TYPES.INFO,summary:_d,closable:true});
}
this._helpHover=new jazz.app.ua.PageHoverHelp({"class":"dashboard-hover-help",uaKey:jazz.app.context.get().name?"com.ibm.team.dashboard.web.dash_proj_team":"com.ibm.team.dashboard.web.dash_personal"}).placeAt(this._dashboardTitle.parentNode,"last");
this._toolbar.domNode.style.display="";
this._toolbar.startup();
},_showErrorMessage:function(_f){
this.dashboardContainer.errorState=true;
var _10={type:_f.type?_f.type:jazz.ui.MessageBox.STATUS_TYPES.ERROR,closable:_f.closeable};
if(_f.status==409||_f.status==412){
var _11=(this.dashboardBundle.scope==_3.SCOPE_CONTRIBUTOR);
var msg=_f.customMessage;
var _12="com-ibm-team-dashboard-web-ui-internal-MetaNav-refreshLink";
var _13=0;
if(msg){
msg=_14(msg,_12+(_13++));
}else{
msg=_11?_9.errorConflictSelf:_9.errorConflict;
}
_10.summary=msg;
var buf=[_11?_9.errorConflictSelf_explanation:_9.errorConflict_explanation];
buf.push(" ");
buf.push(_14(_9.errorConflict_userAction,_12+(_13++)));
_10.details=[{message:buf.join(""),code:jazz.ui.MessageBox.STATUS_TYPES.OK}];
this.showMessage(_10);
for(var i=0;i<_13;++i){
var a=dojo.byId(_12+i);
this.connect(a,"onclick",dojo.hitch(this.dashboardContainer,this.dashboardContainer.refresh));
}
}else{
if(_f.status==403){
_10.summary=_9.errorNoPermissionSave;
_10.details=[{message:_f.responseText}];
this.showMessage(_10);
}else{
if(_f.status==503){
_10.summary=_9.errorSaveReadOnly;
_10.details=[{message:_f.responseText}];
this.showMessage(_10);
}else{
if(_f.status>0){
var buf=["HTTP/1.1 ",_f.status];
if(_f.statusText){
buf.push(" ");
buf.push(_f.statusText);
}
_10.summary=_9.errorSave;
_10.details=[{message:buf.join("")}];
var _15=_f.responseText;
if(_15&&_15.length>0){
_15=_15.replace(/\r?\n/g,"<br/>");
_15=_15.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");
try{
_15=JSON.parse(_15);
if(_15.errorClass&&_15.errorMessage){
_10.details.push({message:this.messages.errorClass+_15.errorClass+this.messages.errorMessage+_15.errorMessage});
}
}
catch(e){
_10.details.push({message:_15});
}
}
_10.errorObject=_f;
this.showMessage(_10);
}else{
_10.errorObject=_f;
this.showMessage(_10);
}
}
}
}
},_addBreadcrumbs:function(){
var _16=[];
var _17=this.dashboardBundle.defaults,_18=jazz.app.context.get();
if(_18.name){
_16.push({label:dojo.string.substitute(_9.allProjectDash,[_18.name]),href:_7.getAllProjectDashboardsHref(_18.name)});
}else{
_16.push({label:_9.allPersonalDashboards,href:_7.getAllPersonalDashboardsHref()});
}
if(this.dashboardBundle.scope==_3.SCOPE_TEAM_AREA){
_16.push({label:_17.project.name,href:_8.getDashboardHref(_3.SCOPE_PROJECT_AREA,_17.project.name)});
var _19=_17.team.path;
var _1a=[];
for(var i=0;i<_19.length-1;i++){
_1a.push(_19[i]);
_16.push({label:_19[i],href:_8.getDashboardHref(_3.SCOPE_TEAM_AREA,_1a)});
}
}
this._breadcrumbs.segments=_16;
this._breadcrumbs.refresh();
},destroy:function(){
if(this._title){
this._title.destroy();
delete this._title;
}
if(this._helpHover){
this._helpHover.destroy();
delete this._helpHover;
}
this.inherited(arguments);
},setEditMode:function(_1b){
var _1c=this.editMode;
this.editMode=_1b;
if(_1b!=_1c){
if(_1b==_2.EDIT_AUTO_SAVE||_1b==_2.EDIT_DEFERRED_SAVE){
if(!this._title){
var _1d=this.dashboardBinding.getTitle();
var _1e=document.createElement("span");
_1e.appendChild(document.createTextNode(_1d));
this._dashboardTitle.appendChild(_1e);
this._title=new dijit.InlineEditBox({title:_9.clickToEdit,autoSave:true,width:"400px",noValueIndicator:"?",editorParams:{maxLength:"60"},onChange:dojo.hitch(this,this._onTitleChange),textDir:this.textDir,value:_1d},_1e);
this._title.startup();
}
this._toolbar.addChild(new jazz.ui.toolbar.Separator(),1);
this.showSaveControls(true);
this._setAutoSave();
}else{
if(this._title){
this._title.destroy();
delete this._title;
}
this._dashboardTitle.appendChild(document.createTextNode(this.dashboardBinding.getTitle()));
this.applyTextDir(this._dashboardTitle,this.dashboardBinding.getTitle());
this.showSaveControls(false);
if(typeof (this.beforeMode)!="undefined"&&this.beforeMode!=_2.READ_ONLY){
this.dashboardContainer.setDirty(false);
}
}
}
},showSaveControls:function(_1f){
if(!this._editEvents){
this._editEvents=new Array();
}
this._autoSaveArea.style.display=_1f?"":"none";
if(_1f){
if(typeof this.editMode!="undefined"&&this.editMode==_2.EDIT_AUTO_SAVE){
this._saveButton.style.display="none";
}
}else{
while(this._editEvents&&this._editEvents.length>0){
this.disconnect(this._editEvents.pop());
}
}
var _20=this.dashboardBundle;
if(!this._separator&&(_20.permissions["modify"]||_20.permissions["modify"])){
this._separator=this._toolbar.addChild(new jazz.ui.toolbar.Separator(),0);
}
if(this.allowSetDefault&&!this._defaultButton&&_20.scope==_3.SCOPE_CONTRIBUTOR&&_20.permissions["modify"]){
var _21=_20.isDefaultDashboard;
this._defaultButton=new jazz.ui.toolbar.Button({onClick:dojo.hitch(this,this._setDefaultDashboard),imgClass:"default-dash",title:_9[_21?"defaultDisabled":"default"]});
this._toolbar.addChild(this._defaultButton,0);
if(_21){
this._defaultButton.set("enabled",false);
}
}
if(this.allowSharing&&!this._shareButton&&_20.scope==_3.SCOPE_CONTRIBUTOR&&_20.permissions["modify"]){
var _22=this.dashboardContainer.dashboardResource;
var _23=_4.getAuthenticatedContributorUri();
var _24=_22.securityContext!=_23;
this._shareButton=new jazz.ui.toolbar.TwoStateButton({pressed:_24,onClick:dojo.hitch(this,this._shareDashboard),imgClass:"shared-dash",imgClassPressed:"unshared-dash",title:_9.sharing},0);
this._toolbar.addChild(this._shareButton,0);
}
if(!this._pasteButton&&_20.permissions["modify"]){
this._pasteButton=new jazz.ui.toolbar.Button({onClick:dojo.hitch(this,this._paste),imgClass:"paste-button",title:_9.paste});
this._toolbar.addChild(this._pasteButton,0);
}
if(this.allowDelete&&!this._deleteButton&&_20.scope==_3.SCOPE_CONTRIBUTOR&&_20.permissions["delete"]){
this._deleteButton=new jazz.ui.toolbar.Button({onClick:dojo.hitch(this,this._deleteDashboard),imgClass:"delete-button",title:_9.del});
this._toolbar.addChild(this._deleteButton,0);
}
if(!this._restoreButton&&_20.scope!=_3.SCOPE_CONTRIBUTOR&&this.dashboardBundle.permissions["modify"]&&_4.getAllowRestore()){
this._restoreButton=new jazz.ui.toolbar.Button({onClick:dojo.hitch(this,this._restoreDashboard),imgClass:"restore-button",title:_9.restoreDefault});
this._toolbar.addChild(this._restoreButton,0);
}
var _25=(location.search.indexOf("internal")!==-1);
if(_25){
if(!this._historyButton){
this._historyButton=new jazz.ui.toolbar.Button({onClick:dojo.hitch(this,this._showHistory),imgClass:"history-button",title:"Show History"});
this._toolbar.addChild(this._historyButton,0);
}
}
},_refresh:function(_26){
var _27=dojo.isIE||!!window.navigator.userAgent.match(/Trident\/7\./);
if(_27&&!_26.shiftKey){
location.reload();
}else{
this.dashboardContainer.refresh();
}
},_paste:function(_28){
if(_28){
dojo.stopEvent(_28);
}
try{
var _29=localStorage["net-jazz-ajax-clipboard"];
}
catch(e){
alert(_9.featureNotSupported);
return;
}
if(!_29){
alert(_9.clipboardEmpty);
return;
}
var _2a=dojox.xml.parser.parse(_29);
var _2b=_2a.documentElement;
var _2c=this.dashboardBinding.elem.ownerDocument;
if(_2c.importNode){
_2b=_2c.importNode(_2b,true);
}
if(_2b.nodeName.indexOf("Page")!=-1){
this.dashboardContainer.addPage(_2b);
}else{
this.dashboardContainer.currentPage.addWidgetFromElement(_2b);
}
},_setAutoSave:function(_2d){
var dc=this.dashboardContainer;
if((_2d&&_2d.target.checked)||(!_2d&&dc.autoSave)){
if(_2d){
dc.setEditMode(_2.EDIT_AUTO_SAVE,true);
this.editMode=_2.EDIT_AUTO_SAVE;
}
var _2e=dc.isDirty();
this._saveButton.style.display="none";
dc.setDirty(false);
dc.autoSave=true;
this._autoSave.checked="checked";
if(_2e){
this.propertyChanged(_2.PROPERTY_DASHBOARD);
}
}else{
if(_2d){
dc.setEditMode(_2.EDIT_DEFERRED_SAVE,true);
this.editMode=_2.EDIT_DEFERRED_SAVE;
}
this._saveButton.style.display="";
dc.autoSave=false;
}
},_setDefaultDashboard:function(){
if(confirm(_9.defaultConfirm)){
var _2f=this.dashboardBundle.dashboardUrl;
this.dashboardBundle.isDefaultDashboard=true;
var _30={};
_30["Content-Type"]="text/plain";
jazz.client.xhrPut({url:_7.getServiceRoot()+"/dashboard-user-prefs/default-dashboard",headers:_30,putData:_2f,error:dojo.hitch(this,this._showErrorMessage)});
this._defaultButton.set("enabled",false);
this._defaultButton.set("title",_9.defaultDisabled);
dojo.publish(jazz.app.events.HOME_MENU_REFRESH);
dojo.publish("/jazz/dashboard/setDefault",[_2f]);
}
},_saveEditingHandler:function(_31){
if(_31){
dojo.stopEvent(_31);
}
this.dashboardContainer.saveDashboard();
this.dashboardContainer.setDirty(false);
if(this.editMode==_2.EDIT_DEFERRED_SAVE){
this.dashboardContainer.propertyChanged("title",this.dashboardBinding.getTitle());
}
},_shareDashboard:function(_32){
if(_32){
dojo.stopEvent(_32);
}
var _33=!this._shareButton.get("pressed");
var _34=this.dashboardContainer;
if(this.editMode==_2.EDIT_DEFERRED_SAVE&&_34.isDirty()){
alert(_9.alertShareDirty);
this._shareButton.set("pressed",_33);
return;
}
var msg=_33?_9.confirmUnshare:_9.confirmShare;
if(confirm(msg)){
var _35=_33?_4.getAuthenticatedContributorUri():_2.CONTEXT_PUBLIC;
_34.dashboardResource.securityContext=_35;
if(this.editMode==_2.EDIT_AUTO_SAVE){
this.propertyChanged(_2.PROPERTY_DASHBOARD);
if(!_33){
this._autoSave.checked=false;
this._setAutoSave({target:this._autoSave});
}
}else{
if(this.editMode==_2.EDIT_DEFERRED_SAVE){
if(!_33){
_34.setEditMode(_2.EDIT_AUTO_SAVE,true);
this.propertyChanged(_2.PROPERTY_DASHBOARD);
_34.setEditMode(_2.EDIT_DEFERRED_SAVE,true);
}else{
this._autoSave.checked="checked";
this._setAutoSave({target:this._autoSave});
this.propertyChanged(_2.PROPERTY_DASHBOARD);
}
}
}
_34.dashboardWidget.propertyChanged("shared",!_33);
}else{
this._shareButton.set("pressed",_33);
}
},_showHistory:function(_36){
if(_36){
dojo.stopEvent(_36);
}
var _37=_1.DISCOVERYSERVICE_URL;
var _38=_37.substring(0,_37.lastIndexOf("/"));
var _39=this.dashboardBundle.dashboardUrl;
var _3a=_39.substring(_39.lastIndexOf("/")+1);
var _3b=_3a.indexOf("?");
if(_3b!==-1){
_3a=_3a.substring(0,_3b);
}
var url=location.href;
var _3c=new dojo._Url(url);
var _3d=_3c.query;
var _3e=dojo.queryToObject(_3d);
delete _3e.internal;
_3c.query=dojo.objectToQuery(_3e)||null;
var buf=[_3c.scheme,"://",_3c.host];
_3c.port&&buf.push(":"+_3c.port);
_3c.path&&buf.push(_3c.path);
_3c.query&&buf.push("?"+_3c.query);
_3c.fragment&&buf.push("#"+_3c.fragment);
url=buf.join("");
var _3f=_38+"/dashboard-history/"+_3a+"?url="+encodeURIComponent(url);
location.href=_3f;
},_deleteDashboard:function(_40){
if(_40){
dojo.stopEvent(_40);
}
var _41=dojo.string.substitute(_9.delConfirmPrivate,[this.dashboardBinding.getTitle()||""]);
if(!confirm(_41)){
return;
}
this.dashboardContainer.propertyChanged("ondelete");
},_restoreDashboard:function(_42){
if(_42){
dojo.stopEvent(_42);
}
var _43=dojo.string.substitute(_9.restoreDashboard);
if(!confirm(_43)){
return;
}
this.dashboardContainer.restoreDashboard();
},_onTitleChange:function(_44){
this.dashboardBinding.setTitle(_44);
this.propertyChanged(_2.PROPERTY_DASHBOARD);
if(this.editMode!=_2.EDIT_DEFERRED_SAVE){
this.dashboardContainer.propertyChanged("title",_44);
}
},showMessage:function(_45){
this._messageBox.showMessage(_45);
},hideMessage:function(_46){
this._messageBox.hideMessage(_46);
this.dashboardContainer.errorState=false;
},_onChange:function(_47){
this.propertyChanged(_47);
},setDirty:function(_48){
if(_48&&!this.dashboardContainer.autoSave){
if(!this.dirtyIcon){
this.dirtyIcon=dojo.create("span",{innerHTML:"*","class":"dirtyStar",title:_9.dashboardModified},this._dashboardTitle);
}
this._saveButton.disabled="";
}else{
if(this.dirtyIcon){
this._dashboardTitle.removeChild(this.dirtyIcon);
delete this.dirtyIcon;
}
this._saveButton.disabled="disabled";
}
}});
function _14(msg,id){
var buf=[];
var _49=jazz.util.i18n.split(msg);
var len=_49.length;
for(var i=0;i<len;++i){
var _4a=_49[i];
if(_4a.id==0){
buf.push("<a href=\"#\" id=\""+id+"\">");
buf.push(_4a.text);
buf.push("</a>");
}else{
buf.push(_4a.text);
}
}
return buf.join("");
};
})();


;dojo.provide("jazz.ensemble.WidgetContext");
(function(){
dojo.declare("jazz.ensemble.WidgetContext",null,{menuContributions:[],properties:{},getIcon:function(){
},getMemento:function(){
},getPreferences:function(){
},getSecondaryTitle:function(){
},getTitle:function(){
},getToolbar:function(){
},isShared:function(){
},setEditContentHandler:function(_1){
},setIcon:function(_2){
},setMaximizeHandler:function(_3){
},setMemento:function(_4){
},setMenuContributions:function(_5){
},setPreferences:function(_6){
},setPreMaximizeHandler:function(_7){
},setSecondaryTitle:function(_8){
},setSettingsHandler:function(_9){
},setTitle:function(_a){
},setTitleURL:function(_b){
}});
})();


;dojo.provide("jazz.ensemble.internal.WidgetFactory");




(function(){
var _1=jazz.core.RegistryFactory;
var _2={};
var _3={};
jazz.ensemble.internal.WidgetFactory={createWidget:function(_4,_5,_6,_7){
var _8=new dojo.Deferred();
var _9={context:_5,definition:_4.getDefinition(),memento:_4.getMemento(),readOnly:_6,uuid:_7};
var _a=_4.getType();
var _b=_c(_a);
_b.addCallback(function(_d){
var _e=_d.createWidget(_9);
_8.callback(_e);
return _d;
});
_b.addErrback(function(e){
_8.errback(e);
return e;
});
return _8;
}};
function _c(_f){
var _10=_2[_f];
if(_10){
var dfd=new dojo.Deferred();
dfd.callback(_10);
return dfd;
}
return _11(_f);
};
function _12(_13){
var _14=_1.getRegistry();
var _15=_14.getExtensionPoint("net.jazz.web.ensemble.widgetSystems");
if(_15){
var _16=_15.getExtensions();
for(var i=0;i<_16.length;i++){
var _17=_16[i].getConfigurationElements();
for(var j=0;j<_17.length;j++){
var _18=_17[j];
if(_18.getName()=="widgetSystem"&&_18.getAttribute("type")==_13){
var _19=_18.getAttribute("widgetFactory");
if(_19){
return _19;
}
}
}
}
}
};
function _11(_1a){
var dfd=_3[_1a];
if(dfd){
return dfd;
}
dfd=new dojo.Deferred();
_3[_1a]=dfd;
var _1b=_12(_1a);
if(_1b){
try{
jazz.core.loader.load_async(_1b,function(){
var _1c=dojo.getObject(_1b);
try{
var _1d=new _1c();
_2[_1a]=_1d;
delete _3[_1a];
dfd.callback(_1d);
}
catch(e){
dfd.errback(e);
}
});
}
catch(e){
dfd.errback(e);
}
}else{
dfd.errback("No widget factory registered for widget type '"+_1a+"'");
}
return dfd;
};
})();

dojo.provide("jazz.ensemble.internal.nls.Messages")._built=true;
dojo.provide("jazz.ensemble.internal.nls.Messages.en_us");
jazz.ensemble.internal.nls.Messages.en_us={"wizardsConfigureDimensions":"Configure Dimensions","wizardsWidth":"Width","undefinedTitle":"the widget","wizardsSnippetInstruction":"Copy and paste this code snippet into an HTML webpage.","menuAppearance":"Appearance","dlgNotSupported":"Your browser does not support this feature.","trimEditTitle":"Edit Contents","wizardsDimensionsInstruction":"Specify the dimensions of the widget in pixels.","wizardsAuto":"auto","appearBackTitle":"Show Background Color","menuCollapse":"Collapse","remove":"Remove","menuCopy":"Copy Widget","menuOpenSocial":"OpenSocial Gadget","menuExportWidget":"Export Widget","menuExpand":"Expand","appearBackDesc":"Indicates whether trim color should fill the background of the widget. May not work for all widgets.","trimEditImgAlt":"Edit","appearTrimDesc":"The trim color selection affects widget borders and background.","settingsOk":"OK","wizardsHeight":"Height","settingsCancel":"Cancel","widgetToolbarAriaLabel":"Widget actions","confirmRemoveWidget":"Remove the \"${0}\" widget?","saveInProgress":"A save operation is already in progress","trimRestoreImgAlt":"Restore","menuRefresh":"Refresh","appearTrimTitle":"Trim","appearRevertTitle":"Restore default title","menuDuplicate":"Duplicate Widget","loading":"Loading...","wizardsGetCodeSnippet":"Get Code Snippet","menuSettings":"Settings","appearTitleTitle":"Title","menuEditContent":"Edit Content","settingsClose":"Close","appearTitleDesc":"The text that appears in the heading of the widget.","wizardsExportWidget":"Export Widget","trimMaximizeImgAlt":"Maximize","settingsReq":"required field"};

;dojo.cache("jazz.ensemble", "internal/settings/templates/SlideoutPanel.html", "<div class=\"jazz-ensemble-internal-settings-SlideoutPanel\" style=\"display: none\">	<div dojoAttachPoint=\"_slideoutDiv\">		<div dojoAttachPoint=\"_paddingDiv\" class=\"padding-div\">			<div dojoAttachPoint=\"contentNode\">				<!-- content goes here -->			</div>			<div class=\"button-panel\" dojoAttachPoint=\"_buttonPanel\">				<!-- button panel -->			</div>		</div>	</div></div>");

;dojo.provide("jazz.ensemble.internal.settings.SlideoutPanel");






dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
dojo.declare("jazz.ensemble.internal.settings.SlideoutPanel",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("jazz.ensemble","internal/settings/templates/SlideoutPanel.html"),_messages:_1,animate:true,postCreate:function(){
if(this.animate){
dojo.style(this._slideoutDiv,{height:"0px"});
}
},open:function(){
this.domNode.style.display="";
if(this.animate){
if(this._animation){
this._animation.stop();
}
this._animation=dojo.fx.wipeIn({node:this._slideoutDiv,duration:250});
this._isClosing=false;
this.connect(this._animation,"onEnd",dojo.hitch(this,function(){
delete this._animation;
}));
this._animation.play();
}
},close:function(_2){
if(this.animate){
if(this._animation){
this._animation.stop();
}
this._animation=dojo.fx.wipeOut({node:this._slideoutDiv,duration:250});
this._isClosing=true;
this.connect(this._animation,"onEnd",dojo.hitch(this,function(){
this.domNode.style.display="none";
if(_2){
_2();
}
delete this._animation;
}));
this._animation.play();
}else{
this.domNode.style.display="none";
}
},toggle:function(){
var _3=dojo.style(this.domNode,"display");
if(_3==="block"&&!this._isClosing){
this.close();
}else{
this.open();
}
}});
})();


;dojo.provide("jazz.ensemble.internal.settings.SettingsPanel");






(function(){
var _1=jazz.ensemble.internal.settings.SlideoutPanel;
var _2=jazz.ui.HoverPopup;
var _3={LIST:"LIST",BOOLEAN:"BOOLEAN",STRING:"STRING",HIDDEN:"HIDDEN"};
dojo.declare("jazz.ensemble.internal.settings.SettingsPanel",_1,{settings:null,readOnly:null,onChange:function(id,_4){
},onCancel:null,onOk:null,postCreate:function(){
this.inherited(arguments);
this.oldSettings=dojo.clone(this.settings);
this.settingsNode=dojo.create("div",{className:"jazz-ensemble-internal-settings-SettingsPanel"},this.contentNode);
this._hoverPopups=[];
this._populateButtonPanel();
this._populate();
},getSettingValue:function(id){
return this.settings[this.settingsMap[id]].value;
},hasSettingChanged:function(id){
var _5=this.settingsMap[id];
return this.settings[_5].value!==this.oldSettings[_5].value;
},_populateButtonPanel:function(){
dojo.create("div",{className:"required-field",innerHTML:"* "+this._messages.settingsReq},this._buttonPanel);
if(!this.readOnly){
var _6=dojo.create("div",{className:"flexrow"},this._buttonPanel);
var _7=dojo.create("button",{innerHTML:this._messages.settingsCancel},_6);
var _8=dojo.create("button",{innerHTML:this._messages.settingsOk},_6);
this.connect(_8,"onclick",this._handleOk);
this.connect(_7,"onclick",this._handleCancel);
}else{
var _9=dojo.create("input",{type:"button",value:this._messages.settingsClose},this._buttonPanel);
this.connect(_9,"onclick",this._handleCancel);
}
},_populate:function(){
this.settingsMap={};
var _a=dojo.create("table",null,this.settingsNode);
var _b=dojo.create("tbody",null,_a);
for(var i=0;i<this.settings.length;i++){
var _c=this.settings[i];
this.settingsMap[_c.id]=i;
if(_c.type===_3.HIDDEN){
continue;
}
var tr=dojo.create("tr",null,_b);
var _d=dojo.create("td",{className:"label"},tr);
var _e=dojo.create("td",{className:"field"},tr);
var _f=document.createElement("td");
_f.className="field";
var _10=_c.label.substr(0,1).toUpperCase()+_c.label.substr(1)+(_c.required?"<span class=\"j-required\">*</span>":"");
var _11=dojo.create("label",{htmlFor:this.id+"-"+_c.id,innerHTML:_10},_d);
if(_c.description){
var _12=new _2({around:_11,html:_c.description,persist:false});
_11.className="hover-style";
this._hoverPopups.push(_12);
}
this.createFormField(_c,_e);
}
},createFormField:function(_13,_14){
switch(_13.type){
case _3.STRING:
var _15=dojo.create("div",null,_14);
var _16=new dijit.form.TextBox({name:_13.id,value:_13.value,trim:true,id:this.id+"-"+_13.id,intermediateChanges:true,disabled:this.readOnly||_13.startDisabled?true:false});
dijit.setWaiState(_16.domNode,"label",_13.label);
this.connect(_16,"onChange",dojo.partial(this._handleTextboxChange,_13.id));
_15.appendChild(_16.domNode);
return _16.domNode;
case _3.BOOLEAN:
var _15=dojo.create("div",null,_14);
var _17=dojo.create("input",{name:_13.id,type:"checkbox",className:"checkbox",id:this.id+"-"+_13.id},_15);
dijit.setWaiState(_17,"label",_13.label);
if(this.readOnly||_13.startDisabled){
_17.disabled=true;
}
this.connect(_17,"onclick",this._handleCheckboxChange);
var _18=_13.value==="true"?true:false;
if(_18){
_17.checked=true;
_17.defaultChecked=true;
}
return _17;
case _3.LIST:
var _15=dojo.create("div",null,_14);
var _19=dojo.create("select",{name:_13.id,id:this.id+"-"+_13.id},_15);
if(_13.options){
this._populateComboOptions(_13.options,_19,_13.computedDefault?_13.computedDefault:_13.value);
}else{
for(var i=0;i<_13.groups.length;i++){
if(_13.groups[i].name){
dojo.create("group",{label:_13.groups[i].name},_19);
var _1a=document.createElement("optgroup");
this._populateComboOptions(_13.groups[i].options,_1a,_13.value);
}else{
this._populateComboOptions(_13.groups[i].options,_19,_13.value);
}
}
}
if(this.readOnly||_13.startDisabled){
_19.disabled=true;
}
this.connect(_19,"onchange",this._handleComboboxChange);
return _19;
}
},_populateComboOptions:function(_1b,_1c,_1d){
for(var i=0;i<_1b.length;i++){
var _1e=dojo.create("option",{value:_1b[i].value},_1c);
if(_1b[i].padding){
_1e.style.paddingLeft=_1b[i].padding+"px";
}
_1e.appendChild(document.createTextNode(_1b[i].label));
if(_1d==_1b[i].value){
_1e.selected="selected";
}
}
},_handleTextboxChange:function(_1f,_20){
this.settings[this.settingsMap[_1f]].value=_20;
this.onChange(_1f,_20);
},_handleComboboxChange:function(_21){
var box=_21.target;
this.settings[this.settingsMap[box.name]].value=box.options[box.selectedIndex].value;
this.onChange(box.name,box.options[box.selectedIndex].value);
},_handleCheckboxChange:function(_22){
var box=_22.target;
var _23=box.checked?"true":"false";
this.settings[this.settingsMap[box.name]].value=_23;
this.onChange(box.name,_23);
},_handleOk:function(){
if(this.onOk){
this.onOk();
}
},_handleCancel:function(){
if(this.onCancel){
this.onCancel();
}
},destroy:function(){
while(this._hoverPopups.length>0){
this._hoverPopups.pop().destroy();
}
this.inherited(arguments);
}});
jazz.ensemble.internal.settings.SettingsPanel.TYPES=_3;
})();


;dojo.provide("jazz.ensemble.internal.settings.AppearancePanel");








dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.ensemble.internal.settings.SettingsPanel;
var _2=jazz.ui.StyledBox.TrimStyles;
var _3={"blue":_2.BLUE,"gray":_2.GRAY,"gold":_2.GOLD,"green":_2.GREEN,"teal":_2.TEAL,"purple":_2.PURPLE,"orange":_2.ORANGE,"none":_2.TRIMLESS};
var _4=dojo.clone(_1.TYPES);
dojo.mixin(_4,{COLOR:"COLOR",TITLE:"TITLE"});
var _5="blue";
var _3={"blue":_2.BLUE,"gray":_2.GRAY,"gold":_2.GOLD,"green":_2.GREEN,"teal":_2.TEAL,"purple":_2.PURPLE,"orange":_2.ORANGE,"none":_2.TRIMLESS};
var _6=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
dojo.declare("jazz.ensemble.internal.settings.AppearancePanel",_1,{postCreate:function(){
this.init();
this.inherited(arguments);
},init:function(){
var _7=this.container.state.getTitle();
this.settings=[{label:_6.appearTitleTitle,id:"title",value:this.container.state.isCustomTitle()?_7:"",description:_6.appearTitleDesc,type:_4.TITLE,defaultText:this.container._latestTitle||(!this.container.state.isCustomTitle()?_7:"")||this.container.getDefaultTitle()},{label:_6.appearTrimTitle,id:"trim",value:this.container.state.getTrim()||"blue",description:_6.appearTrimDesc,type:_4.COLOR},{label:_6.appearBackTitle,id:"showBackground",value:this.container.state.getShowBackground()?"true":"false",description:_6.appearBackDesc,type:_4.BOOLEAN}];
},onChange:function(id,_8){
if(id==="showBackground"){
this.container.setBackground(_8==="true"?true:false);
}
},createFormField:function(_9,_a){
switch(_9.type){
case _4.TITLE:
var _b=dojo.create("div",null,_a);
var _c=new jazz.ui.FilterBox({value:_9.value,defaultText:_9.defaultText,onChange:dojo.hitch(this,this._handleTitleChange),_maintainCase:true,_clearTooltip:_6.appearRevertTitle});
_b.appendChild(_c.domNode);
return;
case _4.COLOR:
var _b=document.createElement("div");
dojo.addClass(_b,"color-picker");
var _d=["blue","gray","gold","green","teal","purple","orange","none"];
for(var i=0;i<_d.length;i++){
var _e=dojo.create("div",{innerHTML:"<div></div>",className:_d[i]+"-option",value:_d[i]},_b);
if(_9.value===_d[i]){
dojo.addClass(_e,"selected");
this.selectedColor=_e;
}
}
this.connect(_b,"onclick",this._handleColorChange);
_a.appendChild(_b);
return;
}
return this.inherited(arguments);
},_handleTitleChange:function(_f){
this.settings[this.settingsMap["title"]].value=_f;
},_handleColorChange:function(_10){
if(!_10.target||!_10.target.value){
return;
}
dojo.addClass(_10.target,"selected");
if(this.selectedColor){
dojo.removeClass(this.selectedColor,"selected");
}
this.selectedColor=_10.target;
var _11=_10.target.value;
this.settings[this.settingsMap["trim"]].value=_11;
this.container.setTrim(_3[_11]);
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
}});
jazz.ensemble.internal.settings.AppearancePanel.TYPES=_4;
jazz.ensemble.internal.settings.AppearancePanel.TRIM_BY_ID=_3;
jazz.ensemble.internal.settings.AppearancePanel.DEFAULT_TRIM=_5;
})();


;define("dijit/form/_CheckBoxMixin",["dojo/_base/declare","dojo/dom-attr"],function(_1,_2){
return _1("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:false,_aria_attr:"aria-checked",_setReadOnlyAttr:function(_3){
this._set("readOnly",_3);
_2.set(this.focusNode,"readOnly",_3);
},_setLabelAttr:undefined,_getSubmitValue:function(_4){
return (_4==null||_4==="")?"on":_4;
},_setValueAttr:function(_5){
_5=this._getSubmitValue(_5);
this._set("value",_5);
_2.set(this.focusNode,"value",_5);
},reset:function(){
this.inherited(arguments);
this._set("value",this._getSubmitValue(this.params.value));
_2.set(this.focusNode,"value",this.value);
},_onClick:function(e){
if(this.readOnly){
e.stopPropagation();
e.preventDefault();
return false;
}
return this.inherited(arguments);
}});
});


;define("dojo/text!dijit/form/templates/CheckBox.html", '<div class="dijit dijitReset dijitInline" role="presentation"	><input	 	${!nameAttrSetting} type="${type}" role="${type}" aria-checked="false" ${checkedAttrSetting}		class="dijitReset dijitCheckBoxInput"		data-dojo-attach-point="focusNode"	 	data-dojo-attach-event="ondijitclick:_onClick"/></div>');

;define("dijit/form/CheckBox",["require","dojo/_base/declare","dojo/dom-attr","dojo/has","dojo/query","dojo/ready","./ToggleButton","./_CheckBoxMixin","dojo/text!./templates/CheckBox.html","dojo/NodeList-dom","../a11yclick","jazz/inverted!./RadioButton"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){
return _2("dijit.form.CheckBox",[_7,_8],{templateString:_9,baseClass:"dijitCheckBox",_setValueAttr:function(_a,_b){
if(typeof _a=="string"){
this.inherited(arguments);
_a=true;
}
if(this._created){
this.set("checked",_a,_b);
}
},_getValueAttr:function(){
return this.checked&&this._get("value");
},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){
this.inherited(arguments);
this.checkedAttrSetting="";
},_fillContent:function(){
},_onFocus:function(){
if(this.id){
_5("label[for='"+this.id+"']").addClass("dijitFocusedLabel");
}
this.inherited(arguments);
},_onBlur:function(){
if(this.id){
_5("label[for='"+this.id+"']").removeClass("dijitFocusedLabel");
}
this.inherited(arguments);
}});
});


;define("dojo/selector/lite",["../has","../_base/kernel"],function(_1,_2){
"use strict";
var _3=document.createElement("div");
var _4=_3.matches||_3.webkitMatchesSelector||_3.mozMatchesSelector||_3.msMatchesSelector||_3.oMatchesSelector;
var _5=_3.querySelectorAll;
var _6=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;
_1.add("dom-matches-selector",!!_4);
_1.add("dom-qsa",!!_5);
var _7=function(_8,_9){
if(_a&&_8.indexOf(",")>-1){
return _a(_8,_9);
}
var _b=_9?_9.ownerDocument||_9:_2.doc||document,_c=(_5?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(_8);
_9=_9||_b;
if(_c){
var _d=_1("ie")===8&&_1("quirks")?_9.nodeType===_b.nodeType:_9.parentNode!==null&&_9.nodeType!==9&&_9.parentNode===_b;
if(_c[2]&&_d){
var _e=_2.byId?_2.byId(_c[2],_b):_b.getElementById(_c[2]);
if(!_e||(_c[1]&&_c[1]!=_e.tagName.toLowerCase())){
return [];
}
if(_9!=_b){
var _f=_e;
while(_f!=_9){
_f=_f.parentNode;
if(!_f){
return [];
}
}
}
return _c[3]?_7(_c[3],_e):[_e];
}
if(_c[3]&&_9.getElementsByClassName){
return _9.getElementsByClassName(_c[4]);
}
var _e;
if(_c[5]){
_e=_9.getElementsByTagName(_c[5]);
if(_c[4]||_c[6]){
_8=(_c[4]||"")+_c[6];
}else{
return _e;
}
}
}
if(_5){
if(_9.nodeType===1&&_9.nodeName.toLowerCase()!=="object"){
return _10(_9,_8,_9.querySelectorAll);
}else{
return _9.querySelectorAll(_8);
}
}else{
if(!_e){
_e=_9.getElementsByTagName("*");
}
}
var _11=[];
for(var i=0,l=_e.length;i<l;i++){
var _12=_e[i];
if(_12.nodeType==1&&_13(_12,_8,_9)){
_11.push(_12);
}
}
return _11;
};
var _10=function(_14,_15,_16){
var _17=_14,old=_14.getAttribute("id"),nid=old||"__dojo__",_18=_14.parentNode,_19=/^\s*[+~]/.test(_15);
if(_19&&!_18){
return [];
}
if(!old){
_14.setAttribute("id",nid);
}else{
nid=nid.replace(/'/g,"\\$&");
}
if(_19&&_18){
_14=_14.parentNode;
}
var _1a=_15.match(_6);
for(var i=0;i<_1a.length;i++){
_1a[i]="[id='"+nid+"'] "+_1a[i];
}
_15=_1a.join(",");
try{
return _16.call(_14,_15);
}
finally{
if(!old){
_17.removeAttribute("id");
}
}
};
if(!_1("dom-matches-selector")){
var _13=(function(){
var _1b=_3.tagName=="div"?"toLowerCase":"toUpperCase";
var _1c={"":function(_1d){
_1d=_1d[_1b]();
return function(_1e){
return _1e.tagName==_1d;
};
},".":function(_1f){
var _20=" "+_1f+" ";
return function(_21){
return _21.className.indexOf(_1f)>-1&&(" "+_21.className+" ").indexOf(_20)>-1;
};
},"#":function(id){
return function(_22){
return _22.id==id;
};
}};
var _23={"^=":function(_24,_25){
return _24.indexOf(_25)==0;
},"*=":function(_26,_27){
return _26.indexOf(_27)>-1;
},"$=":function(_28,_29){
return _28.substring(_28.length-_29.length,_28.length)==_29;
},"~=":function(_2a,_2b){
return (" "+_2a+" ").indexOf(" "+_2b+" ")>-1;
},"|=":function(_2c,_2d){
return (_2c+"-").indexOf(_2d+"-")==0;
},"=":function(_2e,_2f){
return _2e==_2f;
},"":function(_30,_31){
return true;
}};
function _32(_33,_34,_35){
var _36=_34.charAt(0);
if(_36=="\""||_36=="'"){
_34=_34.slice(1,-1);
}
_34=_34.replace(/\\/g,"");
var _37=_23[_35||""];
return function(_38){
var _39=_38.getAttribute(_33);
return _39&&_37(_39,_34);
};
};
function _3a(_3b){
return function(_3c,_3d){
while((_3c=_3c.parentNode)!=_3d){
if(_3b(_3c,_3d)){
return true;
}
}
};
};
function _3e(_3f){
return function(_40,_41){
_40=_40.parentNode;
return _3f?_40!=_41&&_3f(_40,_41):_40==_41;
};
};
var _42={};
function and(_43,_44){
return _43?function(_45,_46){
return _44(_45)&&_43(_45,_46);
}:_44;
};
return function(_47,_48,_49){
var _4a=_42[_48];
if(!_4a){
if(_48.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,function(t,_4b,_4c,_4d,_4e,_4f,_50){
if(_4d){
_4a=and(_4a,_1c[_4c||""](_4d.replace(/\\/g,"")));
}else{
if(_4b){
_4a=(_4b==" "?_3a:_3e)(_4a);
}else{
if(_4e){
_4a=and(_4a,_32(_4e,_50,_4f));
}
}
}
return "";
})){
throw new Error("Syntax error in query");
}
if(!_4a){
return true;
}
_42[_48]=_4a;
}
return _4a(_47,_49);
};
})();
}
if(!_1("dom-qsa")){
var _a=function(_51,_52){
var _53=_51.match(_6);
var _54=[];
for(var i=0;i<_53.length;i++){
_51=new String(_53[i].replace(/\s*$/,""));
_51.indexOf=escape;
var _55=_7(_51,_52);
for(var j=0,l=_55.length;j<l;j++){
var _56=_55[j];
_54[_56.sourceIndex]=_56;
}
}
var _57=[];
for(i in _54){
_57.push(_54[i]);
}
return _57;
};
}
_7.match=_4?function(_58,_59,_5a){
if(_5a&&_5a.nodeType!=9){
return _10(_5a,_59,function(_5b){
return _4.call(_58,_5b);
});
}
return _4.call(_58,_59);
}:_13;
return _7;
});


;define("dijit/form/_RadioButtonMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/_base/lang","dojo/query!css2","../registry"],function(_1,_2,_3,_4,_5,_6){
return _2("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){
var _7=[];
_5("input[type=radio]",this.focusNode.form||this.ownerDocument).forEach(_4.hitch(this,function(_8){
if(_8.name==this.name&&_8.form==this.focusNode.form){
var _9=_6.getEnclosingWidget(_8);
if(_9){
_7.push(_9);
}
}
}));
return _7;
},_setCheckedAttr:function(_a){
this.inherited(arguments);
if(!this._created){
return;
}
if(_a){
_1.forEach(this._getRelatedWidgets(),_4.hitch(this,function(_b){
if(_b!=this&&_b.checked){
_b.set("checked",false);
}
}));
}
},_getSubmitValue:function(_c){
return _c==null?"on":_c;
},_onClick:function(e){
if(this.checked||this.disabled){
e.stopPropagation();
e.preventDefault();
return false;
}
if(this.readOnly){
e.stopPropagation();
e.preventDefault();
_1.forEach(this._getRelatedWidgets(),_4.hitch(this,function(_d){
_3.set(this.focusNode||this.domNode,"checked",_d.checked);
}));
return false;
}
var _e=false;
var _f;
_1.some(this._getRelatedWidgets(),function(_10){
if(_10.checked){
_f=_10;
return true;
}
return false;
});
this.checked=true;
_f&&(_f.checked=false);
if(this.onClick(e)===false||e.defaultPrevented){
_e=true;
}
this.checked=false;
_f&&(_f.checked=true);
if(_e){
e.preventDefault();
}else{
this.set("checked",true);
}
return !_e;
}});
});


;define("dijit/form/RadioButton",["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(_1,_2,_3){
return _1("dijit.form.RadioButton",[_2,_3],{baseClass:"dijitRadio"});
});

dojo.provide("jazz.ensemble.internal.nls.WidgetCatalogMessages")._built=true;
dojo.provide("jazz.ensemble.internal.nls.WidgetCatalogMessages.en_us");
jazz.ensemble.internal.nls.WidgetCatalogMessages.en_us={"errTemplate":"${0}: ${1}","auto":"auto","backToResults":"Back to results","statusAdding":"Adding...","disabledWidgetHoverPopup_CMDisabled":"This widget is not available because Configuration Management must be enabled on the project.","externalWidgets":"Add External Widgets","errPermission":"CRJAZ5034E The widget was not added.","noDescription":"No description available.","configureWidget":"Export Widget","noPreview":"No preview available","selectServer":"Select Catalog","gadgetUrlError":"CRJAZ5035E The OpenSocial gadget cannot be accessed because an error occurred while generating its URL.","noOrigins":"Failed to retrieve origins.","gagdetUrlDialog":"OpenSocial Gadget","getCode":"Get Code","statusAdded":"Added","selected":"Selected:","height":"Height","all":"All","addIWidgetInstruction":"Specify a URL to an IBM iWidget.","errInvalidConfiguration_explanation":"During an attempt to open the widget catalog, the server did not return the expected results. The configuration of the Widget Catalog might be incorrect.","invalidUrl":"The specified URL is invalid","loading":"Loading...","friends":"Friends","errPermission_useraction":"Contact an administrator to request access to the data.","errAddWidget":"Failed to add widget","dialogTitle":"Add Widget","getEntriesFailed":"Failed to retrieve entries.","addGadgetTitle":"Add OpenSocial Gadget","snippetInstruction":"Copy and paste this code snippet into an HTML webpage.","addGadgetInstruction":"Specify a URL to an OpenSocial gadget.","dialogClose":"Close","openGadgetUrl":"Open gadget URL","disabledWidgetHoverPopup_CMEnabled":"This widget is not available because Configuration Management need not be enabled on the project.","getCategoriesFailed":"Failed to retrieve categories.","snippetDialogTitle":"Code Snippet","errPermission_explanation":"The widget could not be added because you do not have permission to read the associated data.","noResults":"No widgets found.","browseCategory":"Select Category","statusFailed":"Failed","gadgetUrlError_explanation":"The server host name or widget definition could not be detected.","errInvalidConfiguration_useraction":"To find more details about this issue, open the JavaScript console of your browser by pressing F12, refresh the widget, and check the JavaScript console for any resulting errors.","backToDetails":"Back to details","addIWidgetTitle":"Add IBM iWidget","errInvalidConfiguration":"CRJAZ5033E The widget catalog cannot be opened.","gadgetUrlError_useraction":"To find more details about this issue, open the JavaScript console of your browser by pressing F12, refresh the widget, and check the JavaScript console for any resulting errors.","width":"Width","addWidget":"Add Widget","buttonOK":"OK","gadgetUrlDescription":"The URL below is a link to the OpenSocial gadget version of this widget. Paste this URL into an OpenSocial container to use this widget outside of a dashboard.","exportGadget":"OpenSocial Gadget","applications":"Applications"};

;dojo.cache("jazz.ensemble", "internal/adapter/templates/WidgetGadgetUri.html", "<div class=\"jazz-ensemble-internal-adapter-WidgetGadgetUri\">	<div>${msg.gadgetUrlDescription}</div>	<div class=\"cd-url-box\">		<input dojoType=\"dijit.form.TextBox\" class=\"urlbox\" type=\"text\" dojoattachpoint=\"_gadgetizedUrlTextArea\" id=\"_gadgetizedUrlTextArea\" onMouseUp=\"return false;\" readonly=\"true\" value=\"\"/>	</div></div>");

;dojo.provide("jazz.ensemble.internal.adapter.WidgetGadgetUri");










dojo.requireLocalization("jazz.ensemble.internal","WidgetCatalogMessages");
(function(){
var _1="gadgetAdapter";
dojo.declare("jazz.ensemble.internal.adapter.WidgetGadgetUri",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("jazz.ensemble","internal/adapter/templates/WidgetGadgetUri.html"),settings:null,frontsizeUrl:null,viewletEntryId:null,viewletDefinitionId:null,constructor:function(_2){
this.msg=dojo.i18n.getLocalization("jazz.ensemble.internal","WidgetCatalogMessages");
},postCreate:function(){
this._settingsStr=this._serializeSettings();
if(this.frontsizeUrl.substr(this.frontsizeUrl.length-1)!=="/"){
this.frontsizeUrl+="/";
}
this._createWidgetUrl();
},_serializeSettings:function(){
if(this.settings){
var _3=[];
for(var i=0;i<this.settings.length;i++){
var _4=this.settings[i];
if(!_4.value){
continue;
}
_3.push("&");
_3.push(_4.id);
_3.push("=");
_3.push(_4.value);
}
return _3.join("");
}
return null;
},_createWidgetUrl:function(){
if(!this.frontsizeUrl||(!this.viewletEntryId&&!this.viewletDefinitionId)){
this._gadgetizedUrlTextArea.value=[this.msg.gadgetUrlError,this.msg.gadgetUrlError_explanation,this.msg.gadgetUrlError_useraction].join(" ");
}else{
var _5=[];
_5.push(this.frontsizeUrl);
_5.push(_1);
if(this.viewletEntryId){
_5.push("?viewletEntryId=");
_5.push(this.viewletEntryId);
}else{
if(this.viewletDefinitionId){
_5.push("?viewletDefinitionId=");
_5.push(this.viewletDefinitionId);
}
}
this._settingsStr&&_5.push(this._settingsStr);
this._gadgetizedUrlTextArea.set("value",_5.join(""));
}
},destroy:function(){
this.inherited(arguments);
}});
})();


;dojo.provide("jazz.ensemble.internal.adapter.WidgetGadgetUriDialog");






dojo.requireLocalization("jazz.ensemble.internal","WidgetCatalogMessages");
(function(){
var _1=dojo.i18n.getLocalization("jazz.ensemble.internal","WidgetCatalogMessages");
var _2=jazz.ensemble.internal.adapter.WidgetGadgetUri;
var _3=com.ibm.team.dashboard.web.util.internal.Util;
dojo.declare("jazz.ensemble.internal.adapter.WidgetGadgetUriDialog",jazz.ui.Dialog,{heading:_1.gagdetUrlDialog,width:"900px",constructor:function(_4){
},postCreate:function(){
this.inherited(arguments);
this._createContent();
},_createContent:function(){
this.contentNode=dojo.create("div",{"class":"jazz-ensemble-internal-adapter-WidgetGadgetUriDialog"},this.containerNode);
if(this.viewlet&&this.viewletDefinition){
this._initSettings();
this._openSocialUriContent=new _2({frontsizeUrl:this.viewlet.getWebURL(),viewletDefinitionId:this.viewletDefinition.id,settings:this._settings});
}else{
this._openSocialUriContent=new _2({frontsizeUrl:this.frontsizeUrl,viewletEntryId:this.viewletEntryId});
}
this._openSocialUriContent.placeAt(this.contentNode);
},_initSettings:function(){
var _5=this.context.getPreferences();
var _6=this.viewletDefinition.preferenceDefinitions;
this._settings=[];
this._settings.push({id:"_viewletTitle",value:encodeURIComponent(this.context.getTitle())});
if(this._hasScope()){
this._settings.push({id:"_scope",value:encodeURIComponent(this.viewlet.getScope())});
var _7=this.viewlet.getScopeItem()?this.viewlet.getScopeItem().itemId:null;
this._settings.push({id:"_scopeItem",value:encodeURIComponent(_7)});
if(this._hasScopeSubteams()){
this._settings.push({id:"_scopeSubteams",value:this.viewlet.getScopeSubteams()?"true":"false"});
}
}
if(this._hasPrefs()){
for(var i=0;i<_6.length;i++){
var _8=this.viewlet.getPreference(_6[i].id);
if(typeof _8==="undefined"||_8===null){
continue;
}
var _9={id:_6[i].id,value:encodeURIComponent(_8)};
this._settings.push(_9);
}
}
var _a=this.viewlet.getViewletState();
if(_a!=undefined){
this._settings.push({id:"_viewletContentMemento",value:encodeURIComponent(_3.toJson(_a.getState()))});
}
},_hasScope:function(){
return this.viewletDefinition.scopeSensitive;
},_hasScopeSubteams:function(){
return this.viewletDefinition.scopeSubteams=="yes"||this.viewletDefinition.scopeSubteams=="yes-and-check";
},_hasPrefs:function(){
var _b=this.viewletDefinition.preferenceDefinitions;
if(!_b||_b.length==0){
return false;
}
for(var i=0;i<_b.length;i++){
if(_b[i].preferenceType!="HIDDEN"){
return true;
}
}
return false;
},destroy:function(){
this._openSocialUriContent.destroy();
this.inherited(arguments);
}});
})();


;(function(){
dojo.provide("jazz.util.ui");
jazz.util.ui={findMaxStringDisplayWidth:function(_1,_2,_3){
if(!_4(_2)){
return -1;
}
var _5=document.createElement("div");
dojo.style(_5,"position","absolute");
dojo.style(_5,"left","-10000px");
_2.appendChild(_5);
var _6=_3||-1;
dojo.forEach(_1,function(_7){
var _8=document.createElement("div");
dojo.style(_8,"float","right");
_8.innerHTML=_7;
_5.appendChild(_8);
_6=_8.clientWidth>_6?_8.clientWidth:_6;
_5.removeChild(_8);
_8=null;
});
_2.removeChild(_5);
return _6;
},convertToEms:function(_9,_a){
return _a/jazz.util.ui.measureEm(_9);
},measureEm:function(_b){
var _c=document.createElement("div");
_c.style.height="100em";
_b.appendChild(_c);
var _d=_c.offsetHeight/100;
_b.removeChild(_c);
return _d;
},convertToExs:function(_e,_f){
return _f/jazz.util.ui.measureEx(_e);
},measureEx:function(_10){
var _11=document.createElement("div");
_11.style.height="100ex";
_10.appendChild(_11);
var _12=_11.offsetHeight/100;
_10.removeChild(_11);
return _12;
}};
function _4(o){
return o&&o.nodeType&&o.cloneNode;
};
})();


;dojo.cache("jazz.ui", "templates/WizardStepList.html", "<div dojoAttachPoint=\"_wizardStepsWrapper\" class=\"wizardStepsWrapper dialogOnly\">	<div dojoAttachPoint=\"wizardSteps\" class=\"wizardSteps\"></div></div>");

;(function(){
dojo.provide("jazz.ui.wizard.WizardStepList");




function _1(_2,_3,_4){
var _5=_2.stepTitle;
if(!_5){
console.error("Step title cannot be empty");
return;
}
var _6=dojo.create("div",{id:"stepNum_"+_3,className:_4?"activeStep":"inactiveStep",title:_5});
dojo.create("span",{innerHTML:_5},_6);
_2.connect(_6,"onclick","trySelect");
return _6;
};
function _7(_8,_9,_a){
var _b=_8.stepTitle;
if(!_b){
console.error("Step title cannot be empty");
return;
}
var _c="<span class=\"number\">"+_9+"</span><span class=\"sectionLabel\">"+_b+"</span>";
if(_a){
var _d=dojo.create("a",{title:_b,innerHTML:_c,href:"#"});
_8.connect(_d,"onclick","trySelect");
return _d;
}else{
return dojo.create("div",{className:"inactiveStep",title:_b,innerHTML:_c});
}
};
function _e(_f,_10){
var div=dojo.create("div",{className:"stepGroup"});
var _11=dojo.create("div",{className:"section",innerHTML:_f},div);
_10.connect(_11,"onclick",function(e){
dojo.stopEvent(e);
dojo.toggleClass(div,"collapsed");
});
return div;
};
dojo.declare("jazz.ui.wizard.WizardStepList",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("jazz.ui","templates/WizardStepList.html"),postCreate:function(){
if(this.orientation.toLowerCase()=="horizontal"){
this.isHorizontal=true;
dojo.addClass(this.wizardSteps,"horizontal");
}else{
this.isHorizontal=false;
dojo.addClass(this.wizardSteps,"vertical");
}
this.lastIndex=0;
},addStep:function(_12,_13){
var _14=this.lastIndex+1;
this.lastIndex++;
var _15;
if(this.isHorizontal){
_15=_7(_12,_14,_12.enabled);
}else{
_15=_1(_12,_14,_12.enabled);
}
_15.position=_12.position;
if(_13){
_13.appendChild(_15);
_12._groupNode=_13;
}else{
this.wizardSteps.appendChild(_15);
}
_12._stepListDOM=_15;
return _12;
},removeStep:function(_16){
if(_16._groupNode){
_16._groupNode.removeChild(_16._stepListDOM);
}else{
if(_16&&_16.position>0){
var _17=dojo.byId("stepNum_"+_16.position);
if(_17){
this.wizardSteps.removeChild(_17);
}
}
}
},removeGroup:function(_18){
if(_18&&_18.isGroup){
this.wizardSteps.removeChild(_18);
}
},enableStep:function(_19){
var _1a=this.wizardSteps.getElementsByTagName("DIV");
var _1b;
for(var i=0;i<_1a.length;i++){
if(_1a[i].position===_19.position){
_1b=_1a[i];
break;
}
}
if(this.isHorizontal){
var _1c=_7(_19,_19.position,true);
_1c.position=_19.position;
_1b.parentNode.replaceChild(_1c,_1b);
}else{
if(_1b){
dojo.removeClass(_1b,"inactiveStep");
dojo.addClass(_1b,"activeStep");
}
}
_19.enabled=true;
_19.visited=true;
},disableStep:function(_1d){
if(this.isHorizontal){
var _1e=this.wizardSteps.getElementsByTagName("A");
}else{
var _1e=this.wizardSteps.getElementsByTagName("DIV");
}
var _1f;
for(var i=0;i<_1e.length;i++){
if(_1e[i].position===_1d.position){
_1f=_1e[i];
break;
}
}
if(this.isHorizontal){
var _20=_7(_1d,_1d.position,false);
_20.position=_1d.position;
_1f.parentNode.replaceChild(_20,_1f);
}else{
if(_1f){
dojo.removeClass(_1f,"activeStep");
dojo.addClass(_1f,"inactiveStep");
}
}
_1d.enabled=false;
},selectStep:function(_21){
if(!_21.enabled){
this.enableStep(_21);
}
if(this.isHorizontal){
var _22=this.wizardSteps.getElementsByTagName("A");
}else{
var _22=this.wizardSteps.getElementsByTagName("DIV");
}
for(var i=0;i<_22.length;i++){
if(_21.position===_22[i].position){
dojo.addClass(_22[i],"selected");
}else{
dojo.removeClass(_22[i],"selected");
}
}
},addStepGroup:function(_23){
if(!this.isHorizontal&&_23&&typeof _23=="string"){
var _24=_e(_23,this);
_24.isGroup=true;
this.wizardSteps.appendChild(_24);
return _24;
}
}});
var _25=jazz.ui.wizard.WizardStepList;
})();

dojo.provide("jazz.ui.nls.WizardMessages")._built=true;
dojo.provide("jazz.ui.nls.WizardMessages.en_us");
jazz.ui.nls.WizardMessages.en_us={"cancel":"Cancel","next":"Next \x3e","previous":"\x3c Back","unspecifiedServerError":"An unspecified server error has occurred.","hideDetails":"Hide Details","serverUnreachable":"The server is unreachable.  Check network connectivity.","loading":"Loading...","help":"Help","stepNotFound":"Cannot find requested step. Redirecting to the first step.","reset":"Reset","finish":"Finish","loadedTimestamp":"Loaded: ${0}","showDetails":"Show Details"};

;dojo.cache("jazz.ui", "templates/Wizard.html", "<div class=\"jazz-ui-wizard\">	<div dojoAttachPoint=\"wizardContainer\">		<div class=\"wizard-wrapper\">				<div dojoAttachPoint=\"wizardHeaderArea\" class=\"wizardHeader\"></div>				<div dojoAttachPoint=\"wizardStepArea\" class=\"wizardStepArea\"></div>				<div dojoAttachPoint=\"wizardPanelArea\" class=\"wizardPanelArea dialogOnly\">					<div dojoAttachPoint=\"loadingDiv\" class=\"loading\">${messages.loading}</div>				</div>				<div dojoAttachPoint=\"wizardNavigationArea\" class=\"wizardNavigationArea\">					<div dojoAttachPoint=\"wizardButtonArea\" class=\"jazz-ui-wizard-nav\">						<div class=\"buttonArea\" dojoattachpoint=\"buttonGroupArea\">							<button dojoAttachPoint=\"wizardCancelButton\" class=\"j-button-secondary\"									dojoAttachEvent=\"onclick: onNavigationButtonClick\">${messages.cancel}</button>							<button dojoAttachPoint=\"wizardPreviousButton\" disabled class=\"noDisplay j-button-secondary\"									dojoAttachEvent=\"onclick: onNavigationButtonClick\">${messages.previous}</button>							<button dojoAttachPoint=\"wizardNextButton\" disabled class=\"noDisplay j-button-secondary\"									dojoAttachEvent=\"onclick: onNavigationButtonClick\">${messages.next}</button>							<button dojoAttachPoint=\"wizardFinishButton\" class=\"j-button-primary\"									dojoAttachEvent=\"onclick: onNavigationButtonClick\">${messages.finish}</button>						</div>					</div>							</div>			</div>		<div dojoAttachPoint=\"wizardFooterArea\" class=\"wizardFooter\"></div>	</div>	<div dojoAttachPoint=\"embedPanelArea\" class=\"embedPanelArea noDisplay\"></div></div>");

;dojo.provide("jazz.ui.Wizard");
















dojo.requireLocalization("jazz.ui","WizardMessages");
(function(){
var ui=jazz.util.ui;
var _1=jazz.ui.StyledBox.TrimStyles;
var _2=48;
var _3=20;
var _4="/steps/";
var _5={};
dojo.declare("jazz.ui.Wizard",dijit._Widget,{width:"944px",contentArgs:null,dialogTrim:null,dialogClass:"jazz-ui-wizard-dialog",iconClass:null,constructor:function(_6){
this.contentArgs=dojo.mixin({steps:[],showStepSummary:true,footerNode:null,headerNode:null,customProcessFinish:null,customProcessCancel:null,includeCancel:null,stepListLayout:"horizontal",hideTrim:false,customPrefix:null},_6);
this.contentArgs.container=this;
this.isEmbedded=_7();
this.contentWidget=new jazz.ui.WizardContent(this.contentArgs);
var _8={contentNode:this.contentWidget.domNode,destroyContents:true};
var _9;
if(_6.fullPageContainer&&_a(_6.fullPageContainer)){
_8.closable=false;
_8.closeOnEsc=false;
this.containerNode=_6.fullPageContainer;
_9=_6.includeCancel!=null?_6.includeCancel:false;
dojo.toggleClass(this.contentWidget.wizardCancelButton,"noDisplay",!_9);
dojo.toggleClass(this.contentWidget.wizardButtonArea,"dialogOnly",false);
dojo.toggleClass(this.contentWidget.wizardPanelArea,"dialogOnly",false);
if(this.isEmbedded||_6.hideTrim){
this.containerNode.appendChild(this.contentWidget.domNode);
}else{
_8.trim=_1.WIZARD;
this.viewBox=new jazz.ui.StyledBox(_8);
this.containerNode.appendChild(this.viewBox.domNode);
}
}else{
var _b=this;
_8.destroyContents=false;
_8.onFinishClose=this.onDestroy.bind(this);
_8.footerNode=this.contentWidget.buttonGroupArea;
_9=_6.includeCancel!=null?_6.includeCancel:true;
dojo.toggleClass(this.contentWidget.wizardCancelButton,"noDisplay",!_9);
_8.heading=_6.primaryTitle||"";
_8.width=_6.width?_6.width:this.width;
var _c=_6.dialogTrim||jazz.ui.Wizard.prototype.dialogTrim;
if(_c){
_8.trim=_c;
}
this.viewBox=new jazz.ui.Dialog(_8);
var _d=_6.dialogClass||jazz.ui.Wizard.prototype.dialogClass;
if(_d){
dojo.addClass(this.viewBox.domNode,_d);
}
this.contentWidget._viewBox=this.viewBox;
}
},startup:function(){
this.inherited(arguments);
if(this.viewBox){
this.viewBox.startup();
}
if(this.contentWidget&&this.contentWidget._steps&&this.contentWidget._steps.length){
dojo.forEach(this.contentWidget._steps,function(_e){
_e.startup();
});
}
},addStep:function(_f){
this.contentWidget.addStep(_f);
_f.startup();
},removeStep:function(_10){
this.contentWidget.removeStep(_10);
},addStepGroup:function(_11){
return this.contentWidget.addStepGroup(_11);
},removeGroup:function(_12){
this.contentWidget.removeGroup(_12);
},selectStep:function(_13){
this.contentWidget.selectStep(_13);
},checkForPendingStepRequest:function(){
this.contentWidget.checkForPendingStepRequest();
},close:function(){
if(this.viewBox){
this.viewBox.close();
}
},onDestroy:function(){
if(this&&dojo.isFunction(this.destroyRecursive)){
this.destroyRecursive();
}
},uninitialize:function(){
this.contentWidget.destroyRecursive();
var _14;
for(var i=0;i<this.contentArgs.steps.length;i++){
_14=this.contentArgs.steps[i];
if(dojo.isFunction(_14.destroyRecursive)){
_14.destroyRecursive();
}
}
this.inherited(arguments);
}});
dojo.declare("jazz.ui.WizardContent",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("jazz.ui","templates/Wizard.html"),constructor:function(){
this.messages=_5=dojo.i18n.getLocalization("jazz.ui","WizardMessages");
this.isEmbedded=_7();
this.validSteps=new Array();
this.stepGroups=new Array();
this.selectedStepPosition=0;
this._steps=[];
this._isFirstLoad=true;
},postCreate:function(){
if(this.headerNode&&_a(this.headerNode)){
this.wizardHeaderArea.appendChild(this.headerNode);
}
if(this.footerNode&&_a(this.footerNode)){
this.wizardFooterArea.appendChild(this.footerNode);
}
this.domPrefix=this.customPrefix||"stepDOM_";
this._stepList=new jazz.ui.wizard.WizardStepList({orientation:this.stepListLayout});
this.wizardStepArea.appendChild(this._stepList.domNode);
if(this.fullPageContainer&&_a(this.fullPageContainer)){
dojo.removeClass(this._stepList._wizardStepsWrapper,"dialogOnly");
if(this.stepListLayout.toLowerCase()=="vertical"){
dojo.addClass(this._stepList._wizardStepsWrapper,"vertical");
dojo.addClass(this.wizardPanelArea,"vertical");
dojo.addClass(this.wizardButtonArea,"vertical");
}
if(this.isEmbedded){
this.subscribe("/dojo/hashchange","checkNavigationStatus");
}else{
this.subscribe("/dojo/hashchange","_hashChanged");
}
}else{
dojo.toggleClass(this.domNode,"dialogOnly",true);
}
if(this.isEmbedded){
dojo.removeClass(this.embedPanelArea,"noDisplay");
}
if(!this.showStepSummary){
this.hideStepList();
}
if(this.steps&&this.steps.length>0){
var _15=this;
dojo.forEach(this.steps,function(_16){
_15.addStep(_16);
});
var _17=1;
var _18=window.location.hash.indexOf(_4);
if(_18!=-1){
var _19=this._getStepFromHash();
if(this._isValidStep(_19)){
_17=parseInt(_19);
}
}
this.selectStep(_17);
}
},updateButtonBleedClass:function(){
if(!this.fullPageContainer){
dojo.toggleClass(this.wizardButtonArea,"dialogOnly",true);
dojo.removeClass(this.buttonGroupArea);
dojo.replaceClass(this.wizardCancelButton,"j-button-ghost","j-button-secondary");
var _1a="j-buttonGroup-bleed-four";
var _1b=dojo.query("> button:not(.noDisplay)",this.buttonGroupArea);
if(_1b){
switch(_1b.length){
case 1:
_1a="j-buttonGroup-bleed-one";
break;
case 2:
_1a="j-buttonGroup-bleed-two";
break;
case 3:
_1a="j-buttonGroup-bleed-three";
break;
case 4:
_1a="j-buttonGroup-bleed-four";
break;
}
dojo.addClass(this.buttonGroupArea,_1a);
}
}
},showStepList:function(){
this._stepList.domNode.style.display="block";
},hideStepList:function(){
this._stepList.domNode.style.display="none";
},getSelectedStep:function(){
return this._steps[this.selectedStepPosition-1];
},addStep:function(_1c,_1d){
this._steps.push(_1c);
_1c.position=this._steps.length;
if(_1c.isExternal){
_1c.setStepPosition(_1c.position);
}
_1c._stepDOM=dojo.create("div",{id:this.domPrefix+_1c.position,style:{display:"none"}});
_1c._stepDOM.appendChild(_1c.domNode);
this.wizardPanelArea.appendChild(_1c._stepDOM);
this.validSteps.push(_1c.position);
_1c.wizard=this;
if(_1c.inStepList){
_1c=this._stepList.addStep(_1c,_1d);
}
if(this._steps.length>1){
dojo.toggleClass(this.wizardPreviousButton,"noDisplay",false);
dojo.toggleClass(this.wizardNextButton,"noDisplay",false);
}
return _1c;
},removeStep:function(_1e){
if(_1e&&_1e.position>0){
var _1f=dojo.byId(this.domPrefix+_1e.position);
if(_1f){
this.wizardPanelArea.removeChild(_1f);
}
_1e.wizard=this;
if(_1e.inStepList){
this._stepList.removeStep(_1e);
}
var _20=dojo.indexOf(this.validSteps,_1e.position);
this.validSteps.splice(_20,1);
}
},removeGroup:function(_21){
if(_21&&_21._stepIndexes){
dojo.forEach(_21._stepIndexes,function(x){
var _22=this._steps[x-1];
this.removeStep(_22);
},this);
this._stepList.removeGroup(_21);
}
},addStepGroup:function(_23){
if(!_23){
return;
}
if(_23.name){
var _24=this._stepList.addStepGroup(_23.name);
}
var _25;
var _26=new Array();
if(_23.steps&&_23.steps.length>0){
dojo.forEach(_23.steps,function(_27){
this.addStep(_27,_24);
_25=_27;
_26.push(this._steps.length);
},this);
}
_24._stepIndexes=_26;
_24._lastStepIndex=this._steps.length;
this.stepGroups.push(_24);
dojo.addClass(_25._stepListDOM,"lastStep");
return _24;
},selectStep:function(_28){
if(!this._isValidStep(_28)){
console.error(this.messages.stepNotFound);
_28=1;
}
if(this.fullPageContainer&&_a(this.fullPageContainer)){
this.updateURI(_28);
}else{
this._processSelectedStep(_28);
}
},_processSelectedStep:function(_29){
if(!this._isValidStep(_29)){
console.error(this.messages.stepNotFound);
_29=1;
}
var _2a=this.selectedStepPosition;
this.selectedStepPosition=_29;
var _2b=this.getSelectedStep();
if(_2a!=_29){
_2b.focusStep();
}
if(_2b.isExternal){
_2b.checkNavigationStatus();
}
if(this.stepGroups.length>0&&!this.isEmbedded){
this._updateGroupUI(_2a,_29);
}
this.updateSummaryHighlight();
this.displayStepContent();
this.updateNavigationControls();
if(this.buttonGroupArea){
this.updateButtonBleedClass();
}
},_isValidStep:function(_2c){
if(isNaN(_2c)){
return false;
}
var _2d=parseInt(_2c);
if(_2d>0&&_2d<=this._steps.length){
return true;
}
return false;
},_updateGroupUI:function(_2e,_2f){
dojo.forEach(this.stepGroups,function(_30){
dojo.toggleClass(_30,"collapsed",true);
if(_2e==_30._lastStepIndex){
dojo.removeClass(_30,"inProgress");
dojo.addClass(_30,"collapsed completed");
}
if(dojo.indexOf(_30._stepIndexes,_2f)!=-1){
dojo.removeClass(_30,"collapsed");
dojo.addClass(_30,"inProgress");
}
});
},trySelectStep:function(_31){
if(!this._isValidStep(_31)){
return false;
}
var _32=this._steps[_31-1];
var _33=dojo.hasClass(_32,"inactiveStep");
if(_32.enabled&&!_33){
this.selectStep(_31);
return true;
}
return false;
},_hashChanged:function(){
this.updateURI(null);
},updateURI:function(_34){
var _35=this._getStepFromHash();
if(_34){
var _36=_34;
if(_35!=_36){
var _37="#"+_4+_36;
self.location.hash=_37;
if(this.isEmbedded){
this._hashChanged();
}
return;
}
}else{
var _36=_35||1;
}
var pos=dojo.indexOf(this.validSteps,_36);
if(pos===-1){
this._hideChildren(this.wizardPanelArea);
this.loadingDiv.style.display="block";
this.requestedStepNumber=_36;
this.requestedStepTimeout=window.setTimeout(dojo.hitch(this,"pendingStepRequestTimeOut"),10000);
}else{
this._processSelectedStep(_36);
if(this._isFirstLoad){
this.enablePreviousSteps(_36);
}
}
this._isFirstLoad=false;
},checkForPendingStepRequest:function(){
if(this.requestedStepTimeout){
window.clearTimeout(this.requestedStepTimeout);
}
if(this.requestedStepNumber){
var _38=this.requestedStepNumber;
var pos=dojo.indexOf(this.validSteps,_38);
if(pos===-1){
_38=1;
}
this.requestedStepNumber=null;
this._processSelectedStep(_38);
this.enablePreviousSteps(_38);
}
},pendingStepRequestTimeOut:function(){
this._processSelectedStep(1);
},enablePreviousSteps:function(_39){
dojo.forEach(this._steps,function(_3a){
if(!_3a.enabled&&_3a.position<=_39){
this._stepList.enableStep(_3a);
}
},this);
},disablePreviousSteps:function(_3b){
dojo.forEach(this._steps,function(_3c){
if(_3c.enabled&&_3c.position<_3b){
this._stepList.disableStep(_3c);
}
},this);
},enabledVisitedFutureSteps:function(_3d){
dojo.forEach(this._steps,function(_3e){
if(!_3e.enabled&&_3e.visited&&_3e.position>=_3d){
this._stepList.enableStep(_3e);
}
},this);
},disableFutureSteps:function(_3f){
dojo.forEach(this._steps,function(_40){
if(_40.enabled&&_40.position>_3f){
this._stepList.disableStep(_40);
}
},this);
},_getStepFromHash:function(){
var _41=self.location.hash.indexOf(_4);
if(_41!=-1){
var _42=self.location.hash.substr(1);
var _43=_42.split("&");
for(var x=0;x<_43.length;x++){
var i=_43[x].indexOf(_4);
if(i!=-1){
return parseInt(_43[x].substring(i+_4.length));
}
}
}
},updateSummaryHighlight:function(){
this._stepList.selectStep(this.getSelectedStep());
},updateNavigationControls:function(){
var _44=this.getSelectedStep();
if(typeof _44==="undefined"||this.selectedStepPosition<=0){
return;
}
var _45=_44.canFlipToPreviousPage()&&this.selectedStepPosition>1;
var _46=_44.canFlipToNextPage()&&this._steps.length>this.selectedStepPosition;
var _47=_44.canFinish();
var _48=_44.canCancel();
if(this.isEmbedded){
var _49=_4a();
if(!_49){
return;
}
_45=_44.canFlipToPreviousPage();
_46=_44.canFlipToNextPage();
var h=1000;
if(this.embedPanelArea&&this.embedPanelArea.offsetHeight>0){
h=this.embedPanelArea.offsetHeight;
}
parent.location.href=_49+"&h="+h+"&cf="+_47*1+"&cn="+_46*1+"&cp="+_45*1+"&cc="+_48*1;
}else{
this.wizardPreviousButton.disabled=!_45;
this.wizardNextButton.disabled=!_46;
this.wizardFinishButton.disabled=!_47;
this.wizardCancelButton.disabled=!_48;
dojo.toggleClass(this.wizardButtonArea,"noDisplay",!_44.includeNavigationUI);
if(!_44.canFlipToPreviousPage()){
this.disablePreviousSteps(this.selectedStepPosition);
}else{
this.enablePreviousSteps(this.selectedStepPosition);
}
if(!_44.canFlipToNextPage()){
this.disableFutureSteps(this.selectedStepPosition);
}else{
this.enabledVisitedFutureSteps(this.selectedStepPosition);
}
}
if(this.customUpdateControls&&dojo.isFunction(this.customUpdateControls)){
this.customUpdateControls();
}
},displayStepContent:function(){
if(this.isEmbedded){
dojo.empty(this.embedPanelArea);
dojo.addClass(this.wizardContainer,"noDisplay");
this.embedPanelArea.appendChild(this.getSelectedStep().domNode);
}else{
dojo.removeClass(this.wizardContainer,"noDisplay");
this._hideChildren(this.wizardPanelArea);
var st=dojo.byId(this.domPrefix+this.selectedStepPosition);
if(st){
st.style.display="block";
}else{
if(!this.DOMChecker){
this.DOMChecker=window.setInterval(dojo.hitch(this,"_isDOMReady"),30);
}
}
}
},_isDOMReady:function(){
var st=dojo.byId(this.domPrefix+this.selectedStepPosition);
if(st){
st.style.display="block";
window.clearInterval(this.DOMChecker);
this.DOMChecker=null;
}else{
this.updateURI();
}
},_hideChildren:function(_4b){
for(var x=0;x<_4b.childNodes.length;x++){
if(_4b.childNodes[x]&&_4b.childNodes[x].style){
_4b.childNodes[x].style.display="none";
}
}
},onNavigationButtonClick:function(e){
var _4c=e.target;
var _4d=this.getSelectedStep();
if(_4c===this.wizardPreviousButton&&_4d.canFlipToPreviousPage()){
_4d.onPrevious();
}else{
if(_4c===this.wizardNextButton&&_4d.canFlipToNextPage()){
_4d.onNext();
}else{
if(_4c===this.wizardFinishButton&&_4d.canFinish()){
_4d.onFinish();
}else{
if(_4c===this.wizardCancelButton&&_4d.canCancel()){
_4d.onCancel();
}
}
}
}
e.stopPropagation();
},processPrevious:function(){
if(!this.isEmbedded){
var pos=dojo.indexOf(this.validSteps,this.selectedStepPosition);
this.selectStep(this.validSteps[pos-1]);
}else{
if(_4a()){
parent.location.href=_4a()+"&pp=1";
}
}
},processNext:function(){
if(!this.isEmbedded){
var pos=dojo.indexOf(this.validSteps,this.selectedStepPosition);
this.selectStep(this.validSteps[pos+1]);
}else{
if(_4a()){
parent.location.href=_4a()+"&pn=1";
}
}
},processFinish:function(){
var _4e=this.customProcessFinish&&dojo.isFunction(this.customProcessFinish);
if(!_4e){
this.container.close();
return;
}
var _4f=this;
dojo.when(this.customProcessFinish(),function(){
_4f.container.close();
},function(_50){
if(dojo.config.isDebug){
console.error("Error during wizard finish callback",e);
}
});
},processCancel:function(){
if(this.customProcessCancel&&dojo.isFunction(this.customProcessCancel)){
this.customProcessCancel();
}
this.container.close();
},checkNavigationStatus:function(){
var _51=self.location.hash.substr(1);
var _52=dojo.queryToObject(_51);
if(_52&&_52.previous==="true"){
this.getSelectedStep().onPrevious();
}else{
if(_52&&_52.next==="true"){
this.getSelectedStep().onNext();
}
}
},uninitialize:function(){
this._stepList.destroyRecursive();
this.inherited(arguments);
}});
function _4a(){
var _53=self.location.hash.substr(1);
var _54=dojo.queryToObject(_53);
var _55=_54.parent;
if(!_55){
try{
url=parent.location.href;
var i=url.indexOf("#");
if(i){
var _56=url.substr(i);
var _57=_56.split("&");
_56=_57[0];
_55=url.substr(0,i)+_56;
self.location.hash=self.location.hash+"&parent="+encodeURIComponent(_55);
}
}
catch(e){
}
if(!_55){
console.warn("This embedded step cannot find its parent URL. Additional errors may occur.");
_55="";
}
}
return _55;
};
function _a(o){
return o&&o.nodeType&&o.cloneNode;
};
function _7(){
var _58=self.location.search.substr(1);
var _59=dojo.queryToObject(_58);
return (_59&&_59.embed==="true")?true:false;
};
})();


;(function(){
dojo.provide("jazz.ui.wizard.WizardStep");
dojo.declare("jazz.ui.wizard.WizardStep",null,{stepTitle:"defaultTitle",includeNavigationUI:true,enabled:false,inStepList:true,canFlipToNextPage:function(){
return this.validate().length===0;
},canFinish:function(){
return false;
},canCancel:function(){
return true;
},canFlipToPreviousPage:function(){
return true;
},triggerButtonStateUpdate:function(){
if(this.wizard){
this.wizard.updateNavigationControls();
}
},focusStep:function(){
},trySelect:function(e){
e.preventDefault();
dojo.stopEvent(e);
if(this.wizard){
this.wizard.trySelectStep(this.position);
}
},onNext:function(){
if(this.customOnNext&&dojo.isFunction(this.customOnNext)){
this.customOnNext();
}
this.wizard.processNext();
},onCancel:function(){
if(this.customOnCancel&&dojo.isFunction(this.customOnCancel)){
this.customOnCancel();
}
this.wizard.processCancel();
},onFinish:function(){
if(this.customOnFinish&&dojo.isFunction(this.customOnFinish)){
this.customOnFinish();
}
this.wizard.processFinish();
},onPrevious:function(){
if(this.customOnPrevious&&dojo.isFunction(this.customOnPrevious)){
this.customOnPrevious();
}
this.wizard.processPrevious();
},validate:function(){
return [];
},finalStep:function(){
if(this.position&&this.wizard){
return this.position===this.wizard._steps.length;
}
return false;
}});
})();


;dojo.cache("jazz.ensemble", "internal/wizards/templates/ExportWidgetWizardStep1.html", "<div class=\"jazz-ensemble-internal-wizards-ExportWidgetWizardStep1\">	<!-- Message Site -->	<div class=\"message-site\">${messages.wizardsDimensionsInstruction}</div>	<!-- Content Site -->	<div class=\"content-site\">		<div class=\"row\">			<div class=\"field\">${messages.wizardsWidth}</div>			<input type=\"text\" 				dojoAttachPoint=\"_textBoxWidth\" 				dojoType=\"dijit.form.TextBox\"				trim=\"true\" style=\"width:8em;\">		</div>		<div class=\"row\">			<div class=\"field\">${messages.wizardsHeight}</div>			<input type=\"text\" 				dojoAttachPoint=\"_textBoxHeight\" 				dojoType=\"dijit.form.TextBox\"				trim=\"true\" style=\"width:8em;\">		</div>	</div>	</div>");

;dojo.provide("jazz.ensemble.internal.wizards.ExportWidgetWizardStep1");






dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.ui.wizard.WizardStep;
var _2=400;
dojo.declare("jazz.ensemble.internal.wizards.ExportWidgetWizardStep1",[dijit._Widget,dijit._Templated,_1],{context:null,templatePath:dojo.moduleUrl("jazz.ensemble","internal/wizards/templates/ExportWidgetWizardStep1.html"),widgetsInTemplate:true,constructor:function(_3){
this.messages=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
this.stepTitle=this.messages.wizardsConfigureDimensions;
},postCreate:function(){
this.inherited(arguments);
this._initFields();
this._initHandlers();
},_initFields:function(){
if(this._isValidWidth(this.context.width)){
this._textBoxWidth.set("value",this.context.width);
}else{
this._textBoxWidth.set("value",_2);
}
if(this._isValidHeight(this.context.height)){
this._textBoxHeight.set("value",this.context.height);
}else{
this._textBoxHeight.set("value",this.messages.wizardsAuto);
}
},_isValidWidth:function(_4){
if(isNaN(_4)||(_4<100)||(_4>9999)){
return false;
}
return true;
},_isValidHeight:function(_5){
if(isNaN(_5)||(_5<50)||(_5>9999)){
return false;
}
return true;
},_initHandlers:function(){
this.connect(this._textBoxWidth.textbox,"onchange",this._handleEventOnChangeWidth);
this.connect(this._textBoxHeight.textbox,"onchange",this._handleEventOnChangeHeight);
},_handleEventOnChangeWidth:function(_6){
if(_6){
dojo.stopEvent(_6);
}
var _7=parseInt(this._textBoxWidth.get("value"),10);
if(this._isValidWidth(_7)){
this.context.width=_7;
}else{
this.context.width=_2;
this._textBoxWidth.set("value",_2);
}
return true;
},_handleEventOnChangeHeight:function(_8){
if(_8){
dojo.stopEvent(_8);
}
var _9=parseInt(this._textBoxHeight.get("value"),10);
if(this._isValidHeight(_9)){
this.context.height=_9;
}else{
this.context.height=0;
this._textBoxHeight.set("value",this.messages.wizardsAuto);
}
return true;
},destroy:function(){
this.inherited(arguments);
}});
})();


;define("dijit/form/SimpleTextarea",["dojo/_base/declare","dojo/dom-class","dojo/sniff","./TextBox"],function(_1,_2,_3,_4){
return _1("dijit.form.SimpleTextarea",_4,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"<textarea ${!nameAttrSetting} data-dojo-attach-point='focusNode,containerNode,textbox' autocomplete='off'></textarea>",postMixInProperties:function(){
if(!this.value&&this.srcNodeRef){
this.value=this.srcNodeRef.value;
}
this.inherited(arguments);
},buildRendering:function(){
this.inherited(arguments);
if(_3("ie")&&this.cols){
_2.add(this.textbox,"dijitTextAreaCols");
}
},filter:function(_5){
if(_5){
_5=_5.replace(/\r/g,"");
}
return this.inherited(arguments);
},_onInput:function(e){
if(this.maxLength){
var _6=parseInt(this.maxLength);
var _7=this.textbox.value.replace(/\r/g,"");
var _8=_7.length-_6;
if(_8>0){
var _9=this.textbox;
if(_9.selectionStart){
var _a=_9.selectionStart;
var cr=0;
if(_3("opera")){
cr=(this.textbox.value.substring(0,_a).match(/\r/g)||[]).length;
}
this.textbox.value=_7.substring(0,_a-_8-cr)+_7.substring(_a-cr);
_9.setSelectionRange(_a-_8,_a-_8);
}else{
if(this.ownerDocument.selection){
_9.focus();
var _b=this.ownerDocument.selection.createRange();
_b.moveStart("character",-_8);
_b.text="";
_b.select();
}
}
}
}
this.inherited(arguments);
}});
});


;dojo.provide("jazz.ensemble.internal.catalog.ErrorUtility");
(function(){
jazz.ensemble.internal.catalog.ErrorUtility={logInfo:function(_1,id){
if(djConfig.isDebug){
console.log(this.getErrorMessage("INFO",_1,id));
}
},logError:function(_2,id){
console.error(this.getErrorMessage("ERROR",_2,id),_2);
},logWarning:function(_3,id){
console.warn(this.getErrorMessage("WARNING",_3,id));
},getErrorMessage:function(_4,_5,id){
var _6="";
var _7="";
var _8="";
if(id){
_6=id+": ";
}
if(_5){
if(_5.lineNumber){
_7="(line "+_5.lineNumber+"): ";
}
if(_5.message){
_8=_5.message;
}else{
_8="Message unavailable";
}
if(_5.status===403){
_8=_8+": You do not have permission to read the associated data.";
}
}else{
_8="Undefined exception";
}
var _9="["+_4+"]: "+_6+_7+_8;
return _9;
}};
})();


;dojo.provide("jazz.ensemble.internal.util.WidgetCodeSnippetGenerator");








(function(){
var _1=net.jazz.ajax.BootstrapProperties;
var _2=jazz.app.internal.applicationAbout;
var _3=jazz.ensemble.internal.catalog.ErrorUtility;
var _4="1.0";
jazz.ensemble.internal.util.WidgetCodeSnippetGenerator={getUniqueID:function(){
return "jazz-viewlet_"+this._getCurrentTimeMS();
},getCode:function(_5,_6,_7){
var id=this.getUniqueID();
var _8=_5.getDefinition();
var _9=this._getFrontSideURL(_8);
var _a=_2.getCurrent();
var _b;
if(_a&&_a.version){
_b=_a.version;
}else{
_3.logError(new Error("Unable to determine the verson of the current application"),this.id);
_b="?";
}
var _c=_9+"/web/jazz.ensemble/internal/IFrameWidgetLoader.js";
var _d=id+"_widget-state";
var _e=id+"_frontside-url";
var _f=id+"_height";
var _10=id+"_width";
var _11=this._serializeWidgetState(_5);
var _12="<div id=\""+id+"\" data-version=\""+_4+"\" data-server-version=\""+_b+"\">"+"\n"+"   "+this._getHTMLParameter(_10,_6)+"\n"+"   "+this._getHTMLParameter(_f,_7)+"\n"+"   "+this._getHTMLParameter(_e,_9)+"\n"+"   "+this._getHTMLParameter(_d,_11)+"\n"+"</div>"+"\n"+"<script src=\""+_c+"\"></script>"+"\n"+this._generateIFrameLoaderHelperScript(id)+"\n";
return _12;
},_getWebUIRoot:function(url){
var _13=url.indexOf("/viewlet/");
if(_13>0){
return url.substring(0,_13);
}
var _14=new dojo._Url(url);
if(!_14.query){
return "";
}
var _15=_14.query.match(/webUIRoot=([^&]*)/);
if((_15 instanceof Array)&&(_15.length===2)){
return decodeURIComponent(_15[1]);
}
return "";
},_getFrontSideURL:function(url){
var _16=this._getWebUIRoot(url);
if(!_16){
_3.logError(new Error("Encountered an invalid viewlet definition URL: "+url),this.id);
_16=_1.FRONTSIDE_URL;
}
return _16;
},debugState:function(_17){
var _18=this._widgetPreferencesToString(_17)+this._mementoToString(_17);
return _18;
},_getCurrentTimeMS:function(){
return +(new Date());
},_serializeWidgetState:function(_19){
var _1a=dojox.xml.parser.innerXML(_19.elem);
var _1b=_1a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/~/gm,"&tilde;");
return _1b;
},_getHTMLParameter:function(id,_1c){
var _1d="<textarea id=\""+id+"\" style=\"display:none;\">"+_1c+"</textarea>";
return _1d;
},_generateIFrameLoaderHelperScript:function(id){
var _1e="<script> new IFrameWidgetLoader(\""+id+"\").instance.run(); </script>";
return _1e;
},_widgetPreferencesToString:function(_1f){
var _20="--------------------------------\n"+"PREFERENCES:\n"+"--------------------------------\n";
var _21=_1f.getPreferences();
if(_21&&_21.length){
for(var _22=0;_22<_21.length;_22++){
var _23=_21[_22];
if(!_23){
continue;
}
_20+=_23.getName()+" = "+_23.getValue()+"\n";
}
}
return _20+"\n";
},_mementoToString:function(_24){
var _25="--------------------------------\n"+"MEMENTO:\n"+"--------------------------------\n";
var _26=_24.getMemento();
if(!_26){
_26="";
}
return _25+_26+"\n";
}};
})();


;dojo.cache("jazz.ensemble", "internal/wizards/templates/ExportWidgetWizardStep2.html", "<div class=\"jazz-ensemble-internal-wizards-ExportWidgetWizardStep2\">	<!-- Message Site -->	<div class=\"message-site\">${messages.wizardsSnippetInstruction}</div>	<!-- Content Site -->	<div class=\"content-site\">		<textarea dojoType=\"dijit.form.SimpleTextarea\" 			selectOnClick=\"true\" 			rows=\"10\"			cols=\"60\"			dojoAttachPoint=\"_textArea\"></textarea>	</div>	</div>");

;dojo.provide("jazz.ensemble.internal.wizards.ExportWidgetWizardStep2");








dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.ui.wizard.WizardStep;
var _2=jazz.ensemble.internal.util.WidgetCodeSnippetGenerator;
dojo.declare("jazz.ensemble.internal.wizards.ExportWidgetWizardStep2",[dijit._Widget,dijit._Templated,_1],{templatePath:dojo.moduleUrl("jazz.ensemble","internal/wizards/templates/ExportWidgetWizardStep2.html"),widgetsInTemplate:true,constructor:function(_3){
this.messages=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
this.stepTitle=this.messages.wizardsGetCodeSnippet;
},postCreate:function(){
this.inherited(arguments);
},canFinish:function(){
return true;
},focusStep:function(){
var _4=this.context.state;
var _5=this.context.width;
var _6=this.context.height;
if(!_4){
console.error("951");
return;
}
var _7=_2.getCode(_4,_5,_6);
if(!_7){
console.error("952");
return;
}
this._textArea.domNode.spellcheck=false;
this._textArea.domNode.style.width="562px";
this._textArea.set("value",_7);
},destroy:function(){
this.inherited(arguments);
}});
})();


;dojo.provide("jazz.ensemble.internal.wizards.ExportWidgetWizard");








dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.ui.Wizard;
var _2=jazz.ensemble.internal.wizards.ExportWidgetWizardStep1;
var _3=jazz.ensemble.internal.wizards.ExportWidgetWizardStep2;
dojo.declare("jazz.ensemble.internal.wizards.ExportWidgetWizard",[dijit._Widget],{state:null,width:0,height:0,constructor:function(_4){
this.messages=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
},postCreate:function(){
this.inherited(arguments);
this._wizard=null;
this._step1=null;
this._step2=null;
},show:function(){
this._step1=new _2({context:this});
this._step2=new _3({context:this});
this._wizard=new _1({steps:[this._step1,this._step2],primaryTitle:this.messages.wizardsExportWidget,width:"600px",stepListLayout:"horizontal"});
},hide:function(){
if(this._wizard){
this._wizard.close();
}
this._uninitializeWizard();
},_uninitializeWizard:function(){
if(this._step1){
this._step1.destroy();
delete this._step1;
}
if(this._step2){
this._step2.destroy();
delete this._step2;
}
if(this._wizard){
this._wizard.destroy();
delete this._wizard;
}
},destroy:function(){
this._uninitializeWizard();
this.inherited(arguments);
}});
})();


;dojo.provide("jazz.ensemble.internal.WidgetContainer");
























dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.ensemble.internal.settings.AppearancePanel;
var _2=jazz.ui.menu.MenuItem;
var _3=jazz.ui.StyledBox;
var _4=jazz.ui.StyledBox.TrimStyles;
var _5=jazz.ensemble.WidgetContext;
var _6=jazz.ensemble.internal.WidgetFactory;
var _7=jazz.ensemble.internal.adapter.WidgetGadgetUriDialog;
var _8=jazz.ensemble.internal.wizards.ExportWidgetWizard;
var _9="blue";
var _a={"blue":_4.BLUE,"gray":_4.GRAY,"gold":_4.GOLD,"green":_4.GREEN,"teal":_4.TEAL,"purple":_4.PURPLE,"orange":_4.ORANGE,"none":_4.TRIMLESS};
var _b=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
dojo.declare("jazz.ensemble.internal.WidgetContainer",[_5,_3,dijit._Contained],{"class":"jazz-ensemble-internal-WidgetContainer",collapsed:false,onStateChange:null,panelId:null,readOnly:false,shared:true,state:null,trim:_a[_9],type:null,uuid:null,widget:null,widgetId:null,isCollapsible:true,_appearancePanel:null,_definition:null,_editContentHandler:null,_loadingDiv:null,_maximizeHandler:null,_maximizeContainerHandler:null,_memento:null,_preferences:null,_preMaximizeHandler:null,_settingsHandler:null,_started:false,_exportWidgetWizard:null,constructor:function(_c){
var _d=_c.state;
this.closable=!_c.readOnly;
this.collapsed=_d.isCollapsed()||false;
this.iconPath=_d.getIcon();
this.primaryTitle=_d.getTitle();
this.showBackground=_d.getShowBackground()||false;
var _e=_d.getTrim();
if(_e){
this.trim=_a[_e];
}
this.type=_d.getType();
this.widgetId=_d.getId();
if(_c.panelId){
this.uuid=_c.panelId+"|"+this.widgetId;
}
this._definition=_d.getDefinition();
this.contentNode=dojo.create("div",{className:"jazz-ensemble-internal-WidgetContainer-content"});
this._loadingDiv=dojo.create("div",{className:"loading-text",innerHTML:_b.loading},this.contentNode);
},buildRendering:function(){
this.inherited(arguments);
if(this.toolbar){
this.toolbar.setAttribute("aria-label",_b.widgetToolbarAriaLabel);
}
},postCreate:function(){
this.inherited(arguments);
var _f=_6.createWidget(this.state,this,this.readOnly,this.uuid);
_f.addCallback(dojo.hitch(this,this._createContents));
_f.addErrback(dojo.hitch(this,this._showError));
this.toolbar.updateButton(this._closeButton,{label:_b.remove});
this._isInitialized=true;
},getDefaultTitle:function(){
return this.widget?this.widget.getDefaultTitle():"";
},getIcon:function(){
return this.iconPath;
},getMemento:function(){
if(!this._memento){
this._memento=this.state.getMemento();
}
return this._memento;
},getPreferences:function(){
if(!this._preferences){
var _10=this._preferences={};
var _11=this.state.getPreferences();
if(_11){
var len=_11.length;
for(var i=0;i<len;++i){
var _12=_11[i];
_10[_12.getName()]=_12.getValue();
}
}
}
return this._preferences;
},getSecondaryTitle:function(){
return this.secondaryTitle;
},getTitle:function(){
return this.primaryTitle;
},getToolbar:function(){
return this.toolbar;
},isDirty:function(){
return this.widget&&this.widget.isDirty();
},isShared:function(){
return this.shared;
},menuProvider:function(){
if(!this._widgetMenu){
var _13=this._widgetMenu=new jazz.ui.Menu();
dojo.addClass(_13.domNode,"jazz-ensemble-internal-WidgetContainer-menu");
_13.addChild(new _2({label:_b.menuRefresh,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-refresh",onClick:dojo.hitch(this,this._handleRefresh)}));
_13.addChild(new dijit.MenuSeparator());
if(this._settingsHandler){
_13.addChild(new _2({label:_b.menuSettings,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-settings",onClick:dojo.hitch(this,this._handleSettings)}));
}
if(this._editContentHandler&&!this.readOnly){
_13.addChild(new _2({label:_b.menuEditContent,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-edit-content",onClick:dojo.hitch(this,this._handleEditContent)}));
}
if(!this.readOnly){
_13.addChild(new _2({label:_b.menuAppearance,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-appearance",onClick:dojo.hitch(this,this._handleAppearance)}));
}
if(_13.getChildren().length>2){
_13.addChild(new dijit.MenuSeparator());
}
var _14=this.menuContributions;
if(_14&&_14.length>0){
for(var i=0;i<_14.length;i++){
_13.addChild(new _2({label:_14[i].label,icon:_14[i].icon,onClick:_14[i].onClick}));
}
_13.addChild(new dijit.MenuSeparator());
}
if(!this.maximized){
_13.addChild(new _2({label:_b.menuCopy,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-copy",onClick:dojo.hitch(this,this._handleCopy)}));
if(this._duplicateHandler){
_13.addChild(new _2({label:_b.menuDuplicate,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-duplicate",onClick:dojo.hitch(this,this._handleDuplicate)}));
}
_13.addChild(new dijit.MenuSeparator());
}
if(!this.maximized&&this.isCollapsible){
if(this.collapsed){
_13.addChild(new _2({label:_b.menuExpand,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-expand",onClick:dojo.hitch(this,this.setCollapsed,false)}));
}else{
_13.addChild(new _2({label:_b.menuCollapse,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-collapse",onClick:dojo.hitch(this,this.setCollapsed,true)}));
}
_13.addChild(new dijit.MenuSeparator());
}
if(this.panelId){
_13.addChild(new _2({label:_b.menuExportWidget,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-export",onClick:dojo.hitch(this,this._handleExportWidget)}));
}
if(this.widget._viewletDefinition&&this.widget._viewletDefinition.gadgetable){
_13.addChild(new _2({label:_b.menuOpenSocial,iconClass:"jazz-ensemble-internal-WidgetContainer-menu-opensocial",onClick:dojo.hitch(this,this._handleGadgetUrlDialog)}));
}
_13.startup();
}
return this._widgetMenu;
},onCollapse:function(){
if(!this.readOnly&&!this.maximized){
this.state.setCollapsed(true);
this.onStateChange();
}
this._onMenuChange();
},onExpand:function(){
if(!this.readOnly&&!this.maximized){
this.state.setCollapsed(null);
this.onStateChange();
}
this._onMenuChange();
},onMove:function(){
this.widget&&this.widget.onMove();
},onShow:function(){
this.widget&&this.widget.onShow();
},onHide:function(){
this.widget&&this.widget.onHide();
},refresh:function(){
this.widget&&this.widget.refresh();
},setMaximizeContainerHandler:function(_15){
if(_15!=this._maximizeContainerHandler){
this._maximizeContainerHandler=_15;
}
},setDuplicateHandler:function(_16){
if(_16!=this._duplicateHandler){
this._onMenuChange();
this._duplicateHandler=_16;
}
},setEditContentHandler:function(_17){
if(_17!==this._editContentHandler){
if(!this.readOnly&&!this._editButton){
this._editButton=this.toolbar.addButton(this,this._handleEditContent,{className:"trim-edit-button",index:this.toolbar.items.length-1,label:_b.trimEditImgAlt});
}
this._onMenuChange();
this._editContentHandler=_17;
}
},setMaximizeHandler:function(_18){
if(_18!==this._maximizeHandler){
if(this._maximizeContainerHandler&&!this._maximizeButton){
this._maximizeButton=this.toolbar.addButton(this,this._handleMaximize,{className:"trim-maximize-button",index:this.toolbar.items.length-(this.readOnly?0:1),label:_b.trimMaximizeImgAlt});
}
this._maximizeHandler=_18;
}
},setMemento:function(_19){
this._memento=_19;
this.state.setMemento(_19);
this.onStateChange();
},setMenuContributions:function(_1a){
if(_1a!==this.menuContributions){
this._onMenuChange();
this.menuContributions=_1a;
}
},setPreferences:function(_1b){
var _1c=this.state.getPreferencesParseType();
if(_1c!=="Collection"){
this.state.setPreferencesParseType("Collection");
}
var _1d=[];
for(var i in _1b){
_1d.push({name:i,value:_1b[i]||""});
}
this.state.setPreferences(_1d);
this._preferences=dojo.clone(_1b);
if(this.type!=="com.ibm.team.dashboard.viewlet"){
this.onStateChange();
}
},setPreMaximizeHandler:function(_1e){
if(_1e!==this._preMaximizeHandler){
this._preMaximizeHandler=_1e;
}
},setSettingsHandler:function(_1f){
if(_1f!=this._settingsHandler){
this._onMenuChange();
this._settingsHandler=_1f;
}
},setTitle:function(_20){
if(this._isInitialized){
if(!this.state.isCustomTitle()){
this.state.setTitle(_20);
this.inherited(arguments);
}
this._latestTitle=_20;
}else{
this.inherited(arguments);
}
},setTrim:function(_21){
if(!this.maximized){
this.inherited(arguments);
}
},startup:function(){
this.inherited(arguments);
this.widget&&this.widget.startup();
this._started=true;
},uninitialize:function(){
if(this._exportWidgetWizard){
this._exportWidgetWizard.destroy();
delete this._exportWidgetWizard;
}
if(this._widgetMenu){
this._widgetMenu.destroyRecursive();
}
if(this.widget){
this.widget.destroy();
}
},_createContents:function(_22){
this.widget=_22;
this.contentNode.replaceChild(_22.domNode,this._loadingDiv);
if(this._started){
_22.startup();
}
return _22;
},_handleAppearance:function(){
if(!this._appearancePanel){
this._appearancePanel=new _1({onCancel:dojo.hitch(this,this._handleAppearanceCancel),onOk:dojo.hitch(this,this._handleAppearanceOk),container:this});
dojo.place(this._appearancePanel.domNode,this.contentNode,"first");
this._appearancePanel.open();
this.collapsed&&this.setCollapsed(false);
}
},_handleAppearanceCancel:function(){
if(this._appearancePanel.hasSettingChanged("trim")){
this.setTrim(_a[this.state.getTrim()||_9]);
}
if(this._appearancePanel.hasSettingChanged("showBackground")){
this.setBackground(this.state.getShowBackground()||false);
}
this._appearancePanel.close(dojo.hitch(this,this._handleAppearanceClose));
},_handleAppearanceClose:function(){
this.contentNode.removeChild(this._appearancePanel.domNode);
this._appearancePanel.destroyRecursive();
delete this._appearancePanel;
},_handleAppearanceOk:function(){
var _23=false;
if(this._appearancePanel.hasSettingChanged("title")){
var _24=this._appearancePanel.getSettingValue("title");
var _25=_24||this._latestTitle||this.getDefaultTitle();
this.inherited("setTitle",[_25]);
this.state.setTitle(_25);
this.state.setCustomTitle(_24?true:false);
_23=true;
}
if(this._appearancePanel.hasSettingChanged("trim")){
this.state.setTrim(this._appearancePanel.getSettingValue("trim"));
_23=true;
}
if(this._appearancePanel.hasSettingChanged("showBackground")){
this.state.setShowBackground(this._appearancePanel.getSettingValue("showBackground")==="true"?true:false);
_23=true;
}
this._appearancePanel.close(dojo.hitch(this,this._handleAppearanceClose));
if(_23){
this.onStateChange();
}
},_handleCopy:function(){
try{
window.localStorage["net-jazz-ajax-clipboard"]=dojox.xml.parser.innerXML(this.state.elem);
}
catch(e){
alert(_b.dlgNotSupported);
}
},_handleDuplicate:function(_26){
if(_26){
dojo.stopEvent(_26);
}
this._duplicateHandler&&this._duplicateHandler();
},_handleEditContent:function(_27){
if(_27){
dojo.stopEvent(_27);
}
this._editContentHandler&&this._editContentHandler();
},_handleMaximize:function(_28){
if(_28){
dojo.stopEvent(_28);
}
var _29=!this.maximized;
this._preMaximizeHandler&&this._preMaximizeHandler(!this.maximized);
if(!_29){
if(this.state.isCollapsed()){
this.setCollapsed(true,false);
}
this.maximized=false;
}
this.setClosable(!this.readOnly&&!_29);
this.setTrim(_29?"":_a[this.state.getTrim()||_9]);
if(_29){
this.maximized=true;
if(this.collapsed){
this.setCollapsed(false,false);
}
}
this._maximizeContainerHandler(this.maximized);
this._maximizeHandler(this.maximized);
var _2a=this.maximized?{label:_b.trimRestoreImgAlt,className:"trim-restore-button"}:{label:_b.trimMaximizeImgAlt,className:"trim-maximize-button"};
this.toolbar.updateButton(this._maximizeButton,_2a);
},_handleRefresh:function(){
this.widget.refresh();
},_handleSettings:function(){
if(this._settingsHandler){
this._settingsHandler();
if(this.collapsed){
this.setCollapsed(false);
}
}
},_handleGadgetUrlDialog:function(){
if(this.widget._viewletDefinition&&this.widget._viewletDefinition.gadgetable){
this._dialog=new _7({modal:true,closeOnBlur:true,showBackground:true,context:this,viewletDefinition:this.widget._viewletDefinition,viewlet:this.widget.viewlet});
}
},_handleExportWidget:function(){
this._exportWidgetWizard=new _8({state:this.state,width:this._getWidth(),height:0});
this._exportWidgetWizard.show();
},_getWidth:function(){
if(!this.domNode){
return 0;
}
var _2b=dojo.position(this.domNode);
if(!_2b){
return 0;
}
return Math.floor(_2b.w)+1;
},_onMenuChange:function(){
if(this._widgetMenu){
this._widgetMenu.destroyRecursive();
delete this._widgetMenu;
}
},_showError:function(e){
console.error(e);
}});
})();


;dojo.provide("jazz.ensemble.internal.LayoutConverter");




(function(){
var _1=jazz.util.binding;
var _2=jazz.ensemble.internal.util.bindings;
jazz.ensemble.internal.LayoutConverter={convert:function(_3,_4,_5){
var _6=_1.bind(_5,_2.ColumnLayoutData);
var _7=_6.getColumns();
var _8=_9(_3);
var _a=_9(_4);
if(_a>_8){
var _b=_a-_8;
var _c=[];
for(var i=0;i<_b;i++){
_c.push({widgetReferences:[],widgetReferencesParseType:"Collection"});
}
_7.push.apply(_7,_c);
}else{
var _d=[];
for(var i=_a;i<_8;i++){
var _e=_7[i].getWidgetReferences();
_d=_d.concat(_e.splice(0,_e.length));
}
for(var i=0;i<_a;i++){
var _e=_7[i].getWidgetReferences();
for(var j=i;j<_d.length;j+=_a){
_e.push(_d[j]);
}
}
_7.splice(_a,_8-_a);
}
var _f=Math.floor(100/_7.length);
var _10=100-(_f*_7.length);
for(var i=0;i<_7.length;i++){
_7[i].setWidth(_f+(i<_10?1:0));
}
}};
function _9(_11){
switch(_11){
case "jazz.ensemble.layout.1column":
return 1;
case "jazz.ensemble.layout.2column":
return 2;
case "jazz.ensemble.layout.3column":
return 3;
}
};
})();


;dojo.provide("jazz.ensemble.internal.Layout");


(function(){
dojo.declare("jazz.ensemble.internal.Layout",[dijit._Widget],{data:null,items:null,onStateChange:function(){
},onAddWidget:function(_1){
},onRemoveWidget:function(_2){
},readOnly:false,getDefaultData:function(_3){
},add:function(_4,_5,_6){
},getState:function(){
},setMaximized:function(id,_7){
},remove:function(id){
},startup:function(){
}});
})();


;dojo.provide("jazz.ui.dnd.DraggableManager");


(function(){
jazz.ui.dnd.DraggableManager=function(){
this.avatar=null;
this.containers=new Array();
this.fromContainer=null;
this.overContainer=null;
this.widget=null;
this.isDragging=false;
this.paused=false;
this.onMouseMoveEvent=null;
this.events=[];
this.targets=new Array();
this.maxRow=0;
this._uniqueId=0;
};
dojo.extend(jazz.ui.dnd.DraggableManager,{destroy:function(){
dojo.disconnect(this.onMouseMoveEvent);
jazz.ui.dnd._draggableManager=null;
},onMouseMoveInitial:function(e){
var _1=Math.abs(e.pageX-this.initialMouseCoords.x);
var _2=Math.abs(e.pageY-this.initialMouseCoords.y);
if(!this.isDragging&&(_1>=4||_2>=4)){
this.startDrag();
this.onMouseMove(e);
}else{
this.dragStopEvent(e);
}
},getUniqueId:function(){
var id=this._uniqueId;
this._uniqueId++;
return "draggable"+id;
},onMouseMove:function(e){
if(this.paused){
return;
}
this.dragStopEvent(e);
var x=e.pageX;
var y=e.pageY;
this._updateAvatarPosition(x,y);
var _3=this.currentContainers;
var _4=null;
var fc=this.fromContainer;
for(var i=0;i<_3.length;i++){
var _5=_3[i];
var _6=_5.coords;
if(x<_6.x){
continue;
}
if(x>_6.x&&y<_6.y){
continue;
}
if((x>=_6.x&&x<=_6.x+_6.w)||(!_5.isTarget&&fc.constrainAvatar&&(fc.constrainAvatar=="Y"||fc.constrainAvatar=="A"))){
if((y>=_6.y&&y<=_6.y+_6.h)||(!_5.isTarget&&fc.constrainAvatar&&(fc.constrainAvatar=="X"||fc.constrainAvatar=="A"))){
this._notifyContainer(_5,e);
_3.splice(i,1);
_3.splice(0,0,_5);
return;
}else{
if(y>=_6.y&&!_5.isTarget){
_4=_5;
}
}
}
}
if(_4){
this._notifyContainer(_4,e);
return;
}
if(this.atEnd||this.atStart){
fc.onMouseMove(e);
}
this._notifyContainer({container:this.fromContainer,index:this.widget.index},e);
},_notifyContainer:function(c,e){
var _7=c.container;
if(this.overContainer&&_7!=this.overContainer){
_7.clearPlaceholder();
}
if(this.overContainer&&this.overContainer.node){
dojo.removeClass(this.overContainer.node,"dndOver");
}
this.overContainer=_7;
if(c.isTarget){
dojo.addClass(_7.node,"dndOver");
}else{
_7.onMouseMove(e,c.index);
}
},_updateAvatarPosition:function(_8,_9){
var a=this.avatar;
if(a){
var x=_8-this.initialMouseCoords.offsetX;
var y=_9-this.initialMouseCoords.offsetY;
if(this.fromContainer.relativeTo){
var rt=dojo.position(this.fromContainer.relativeTo,true);
x=x-rt.x;
y=y-rt.y;
}
if(!this.fromContainer.constrainAvatar){
dojo.marginBox(a.node,{l:x,t:y});
}else{
var _a=this.containerCoords;
var _b=this.widgetCoords;
if(this.fromContainer.constrainAvatar=="A"){
if(!this.yStart){
this.yStart=_a.y;
}
this.maxRow=Math.round(this.overContainer.node.parentNode.clientHeight/_b.h)-1;
var _c=Math.round(((y)-(_a.y))/_b.h);
if(_c>=0&&_c<=this.maxRow){
this.yStart=_a.y+_c*_b.h;
if(dojo.isIE){
this.yStart=this.yStart-_b.marginTop;
}
}
if(x<_a.x){
dojo.marginBox(a.node,{l:_a.x,t:this.yStart});
this.atStart=true;
this.atEnd=false;
this.atRowEnd=false;
}else{
if(x>_a.x+_a.w-_b.w-8){
dojo.marginBox(a.node,{l:_a.x+_a.w-_b.w-8,t:this.yStart});
this.atStart=false;
if(this.maxRow==_c){
this.atEnd=true;
}else{
this.atEnd=false;
}
this.atRowEnd=true;
}else{
dojo.marginBox(a.node,{l:x,t:this.yStart});
var _d=this.overContainer.widgets[this.overContainer.widgets.length-1].domNode;
var _e=dojo.marginBox(_d);
_e.x=dojo.position(_d,true);
if(_c==this.maxRow&&(x>_a.x+_a.w-_b.w-10||x>_e.x+_e.w)){
if(_c==this.maxRow){
this.atEnd=true;
}else{
this.atEnd=false;
}
this.atRowEnd=true;
this.atStart=false;
}else{
if(x<_a.x+18){
this.atEnd=false;
this.atRowEnd=false;
this.atStart=true;
}else{
this.atEnd=false;
this.atRowEnd=false;
this.atStart=false;
}
}
}
}
}else{
if(this.fromContainer.constrainAvatar=="X"){
if(!this.yStart){
this.yStart=_a.y+_b.marginTop;
}
if(x<_a.x){
dojo.marginBox(a.node,{l:_a.x,t:this.yStart});
}else{
dojo.marginBox(a.node,{l:x,t:this.yStart});
}
}else{
if(this.fromContainer.constrainAvatar=="Y"){
if(!this.xStart){
this.xStart=_a.x+_b.marginLeft;
}
if(y<_a.y){
dojo.marginBox(a.node,{l:this.xStart,t:_a.y});
}else{
dojo.marginBox(a.node,{l:this.xStart,t:y});
}
}
}
}
}
}
},initDrag:function(_f,_10,_11){
if(this.onMouseMoveEvent){
return;
}
this.widget=_10;
this.fromContainer=this.overContainer=_f;
var _12=dojo.marginBox(_10.domNode);
var _13=dojo.position(_10.domNode,true);
_12.x=_13.x;
_12.y=_13.y;
_12.marginTop=dojo.style(_10.domNode,"marginTop");
_12.marginLeft=dojo.style(_10.domNode,"marginLeft");
_12.marginBottom=dojo.style(_10.domNode,"marginBottom");
_12.marginRight=dojo.style(_10.domNode,"marginRight");
this.widgetCoords=_12;
this.initialMouseCoords={x:_11.pageX,y:_11.pageY,offsetX:_11.pageX-_12.x+_12.marginLeft,offsetY:_11.pageY-_12.y+_12.marginTop};
this.currentContainers=this._getValidContainers(_10.type);
this.events.push(dojo.connect(document,"ondragstart",this,this.dragStopEvent));
this.events.push(dojo.connect(document,"onselectstart",this,this.dragStopEvent));
this.onMouseMoveEvent=dojo.connect(dojo.doc,"onmousemove",this,"onMouseMoveInitial");
},_getValidContainers:function(_14){
var _15=new Array();
var _16=this.widget;
var _17=this.containers;
for(var i=0;i<_17.length;i++){
var _18=_17[i];
if(_18&&!_18._disabled&&dojo.isDescendant(_18.node,document.body)&&dojo.some(_18.accept,function(_19){
return _19==_16.type;
})){
var _1a=dojo.position(_18.node,true);
_1a.w=_18.node.offsetWidth;
_1a.h=_18.node.offsetHeight;
_15.push({container:_18,coords:_1a,isTarget:false});
}
}
var _1b=this.targets;
for(i=0;i<_1b.length;i++){
var _1c=_1b[i];
if(_1c&&!_1c._disabled&&dojo.isDescendant(_1c.node,document.body)==true&&dojo.some(_1c.accept,function(_1d){
return _1d==_16.type;
})){
var _1a=dojo.position(_1c.node,true);
_1a.w=_1c.node.offsetWidth;
_1a.h=_1c.node.offsetHeight;
_15.push({container:_1c,coords:_1a,isTarget:true});
}
}
_15.sort(dojo.hitch(this,this._compareContainers));
return _15;
},_compareContainers:function(a,b){
if(a.coords.x<b.coords.x){
return 1;
}else{
if(a.coords.x>b.coords.x){
return -1;
}else{
if(a.coords.y<b.coords.y){
return 1;
}else{
if(a.coords.y>b.coords.y){
return -1;
}
}
}
}
return 0;
},startDrag:function(){
dojo.disconnect(this.onMouseMoveEvent);
if(this.fromContainer.onStartDrag){
dojo.hitch(this.fromContainer,this.fromContainer.onStartDrag)();
}
jazz.ui.underlay.show({opacity:0,zIndex:2000});
if(this.overContainer){
if(this.overContainer!=this.fromContainer){
if(this.overContainer.node){
dojo.removeClass(this.overContainer.node,"dndOver");
}
this.overContainer=this.fromContainer;
}
}else{
if(this.fromContainer){
this.overContainer=this.fromContainer;
}
}
this.isDragging=true;
var de=document.documentElement;
this._scrollMaxX=de.scrollWidth-de.clientWidth;
this._scrollMaxY=de.scrollHeight-de.clientHeight;
this.containerCoords=dojo.marginBox(this.fromContainer.node);
var pos=dojo.position(this.fromContainer.node,true);
this.containerCoords.x=pos.x;
this.containerCoords.y=pos.y;
if(this.fromContainer.useAvatar===false){
this.widget.node=this.widget.domNode;
this.avatar=this.widget;
this.avatar.node.style.position="absolute";
this.avatar.node.style.width=this.widgetCoords.w-this.widgetCoords.marginLeft-this.widgetCoords.marginRight+"px";
this.avatar.node.style.zIndex="1999";
dojo.addClass(this.avatar.node,"jazz-ui-dnd-avatar");
if(this.fromContainer.avatarClass){
dojo.addClass(this.avatar.node,this.fromContainer.avatarClass);
}
}else{
this.avatar=new jazz.ui.dnd.Avatar(this,this.fromContainer.avatarClass);
dojo.body().appendChild(this.avatar.node);
}
this.onMouseMoveEvent=dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove");
},stopDrag:function(){
dojo.disconnect(this.onMouseMoveEvent);
this.onMouseMoveEvent=null;
jazz.ui.underlay.hide();
if(!this.overContainer.isSource){
dojo.removeClass(this.overContainer.node,"dndOver");
}
if(this.avatar){
if(this.fromContainer.useAvatar===false){
var _1e=this.avatar.node.style;
_1e.position=_1e.height=_1e.width=_1e.left=_1e.top=_1e.zIndex="";
dojo.removeClass(this.avatar.node,"jazz-ui-dnd-avatar");
if(this.fromContainer.avatarClass){
dojo.removeClass(this.avatar.node,this.fromContainer.avatarClass);
}
this.avatar.node=null;
}else{
this.avatar.destroy();
}
this.avatar=null;
}
this.fromContainer=null;
this.overContainer=null;
this.widget=null;
setTimeout(dojo.hitch(this,function(){
this.isDragging=false;
}),0);
while(this.events.length){
dojo.disconnect(this.events.pop());
}
this.yStart=null;
this.xStart=null;
this.widgetCoords=null;
this.containerCoords=null;
this.atEnd=false;
this.atStart=false;
this.paused=false;
this.currentContainers=null;
this.initialMouseCoords=null;
},stopForInput:function(){
this.paused=true;
},dragStopEvent:function(_1f){
if(_1f&&(this.isDragging||this.fromContainer)){
dojo.stopEvent(_1f);
}
}});
jazz.ui.dnd._draggableManager=null;
jazz.ui.dnd.draggableManager=function(){
if(!jazz.ui.dnd._draggableManager){
jazz.ui.dnd._draggableManager=new jazz.ui.dnd.DraggableManager();
}
return jazz.ui.dnd._draggableManager;
};
})();


;dojo.provide("jazz.ui.dnd.DraggableContainer");


(function(){
var _1=jazz.ui.dnd.draggableManager();
dojo.declare("jazz.ui.dnd.DraggableContainer",null,{constructor:function(_2,_3){
this.node=_2;
this.accept=_3.accept;
this.widgets=new Array();
this.overWidget=null;
this.isSource=true;
this.horizontal=false;
dojo.addClass(this.node,"jazz-ui-dnd-DraggableContainer");
this.registerContainer();
},registerContainer:function(){
_1.containers.push(this);
},setEnabled:function(_4){
this._disabled=!_4;
dojo.toggleClass(this.node,"jazz-ui-dnd-disabled",!_4);
},add:function(_5,_6){
var _7=_6.index;
if(typeof (_7)!="number"||_7>=this.widgets.length){
_7=this.widgets.length;
}
_5.type=_6.type;
_5.index=_7;
_5.handle=_6.handle;
if(!_5.handle){
_5.handle=_5.domNode;
}
if(_7==this.widgets.length){
if(!this.node.lastChild||dojo.hasClass(this.node.lastChild,"dndItem")){
this.node.appendChild(_5.domNode);
}else{
this.node.insertBefore(_5.domNode,this.node.lastChild);
}
}else{
this.node.insertBefore(_5.domNode,this.widgets[_7].domNode);
}
this.widgets.splice(_7,0,_5);
_5.dndEvent=dojo.connect(_5.handle,"onmousedown",this,this.onMouseDown);
dojo.addClass(_5.domNode,"dndItem");
dojo.addClass(_5.handle,"jazz-ui-dnd-handle");
this.updateIndices();
},destroy:function(){
while(this.widgets.length>0){
var _8=this.widgets.pop();
if(_8.dndEvent){
dojo.disconnect(_8.dndEvent);
}
if(_8.destroy){
_8.destroy();
}
}
var _9=_1.containers;
for(var i=0;i<_9.length;i++){
if(_9[i]==this){
_9.splice(i,1);
}
}
},move:function(_a,_b,_c){
var _d=_1.fromContainer;
var _e=_1.overContainer;
var _f=_d.widgets.splice(_a,1)[0];
_f.domNode.parentNode.removeChild(_f.domNode);
_e.node.insertBefore(_f.domNode,this.getPlaceholder());
_e.widgets.splice(_c,0,_f);
var _10=[_d,_e];
for(var j=0;j<_10.length;j++){
this.updateIndices(_10[j]);
if(_d==_e){
break;
}
}
},remove:function(_11){
var _12=this.widgets.splice(_11,1)[0];
_12.domNode.parentNode.removeChild(_12.domNode);
this.updateIndices();
},onMouseDown:function(_13){
if(this._disabled||_13.button!=0){
return;
}
var e=_13.currentTarget;
for(var i=0;i<this.widgets.length;i++){
if(e==this.widgets[i].handle){
var _14=this.widgets[i];
break;
}
}
if(_14){
_13.preventDefault();
this.onDndStart(_14,_13);
this.overWidget=_14;
}
},onMouseMove:function(_15,_16){
jazz.ui.dnd.autoScroll(_15);
this.dropAtEnd=false;
var x=_15.pageX;
var y=_15.pageY;
if(_16!=null&&!this.constrainAvatar){
this.overWidget=this.widgets[_16];
this.insertPlaceholder(false);
return;
}
for(var i=0;i<this.widgets.length;i++){
var _17=this.widgets[i];
var _18=dojo.position(_17.domNode,true);
_18.w=_17.domNode.clientWidth;
if((this.constrainAvatar&&this.constrainAvatar=="Y")||(_17!=_1.widget&&(!this.horizontal||(x>=_18.x&&x<=_18.x+_18.w)))){
_18.h=_17.domNode.offsetHeight+dojo.style(_17.domNode,"marginTop")+dojo.style(_17.domNode,"marginBottom");
if(this.constrainAvatar&&this.constrainAvatar=="A"){
var row=Math.round((_18.y-dojo.style(_17.domNode,"marginTop")-_1.containerCoords.y)/27);
}
if((this.constrainAvatar&&this.constrainAvatar=="X")||(y>=_18.y&&y<=_18.y+_18.h)||(this.constrainAvatar&&this.constrainAvatar=="A"&&((row==0&&y<_18.y)||(row==_1.maxRow&&y>_18.y+_18.h)))){
if(this.horizontal){
if(_1.atStart){
var _19=true;
}else{
if(_1.atRowEnd){
var _19=false;
}else{
var _19=(x-_18.x)<(_18.w/2);
}
}
}else{
var _19=(y-_18.y)<(_18.h/2);
}
if(this.overWidget!=_17){
this.overWidget=_17;
}
if(this.overWidget){
this.insertPlaceholder(_19);
}
return;
}
}
}
var _1a=this.getPlaceholder();
if(_1a){
var wc=_1.widgetCoords;
var pc=dojo.position(_1a,true);
pc.w=_1a.offsetWidth;
pc.h=_1a.offsetHeight+wc.marginTop+wc.marginBottom;
if((this.constrainAvatar&&this.constrainAvatar=="Y")||!this.horizontal||(x>=pc.x-wc.marginLeft&&x<=pc.x+pc.w)){
if((this.constrainAvatar&&this.constrainAvatar=="X")||(y>=pc.y-wc.marginTop-3&&y<=pc.y+pc.h)){
return;
}
}
}
if(!this.horizontal||_1.atEnd){
this.dropAtEnd=true;
this.insertPlaceholder(false);
this.overWidget=this.widgets[this.widgets.length-1];
}
},onMouseUp:function(_1b){
if(_1.isDragging){
var _1c=_1.widget.index;
if(_1.overContainer.isSource){
var _1d=_1.fromContainer;
var _1e=_1.overContainer;
var _1f=this.getPlaceholder();
if(_1f){
var _20=this.getPlaceholder().index;
}else{
this.onDndStop(false);
return;
}
try{
if(_1d!=_1e||_1c!=_20){
this.move(_1c,_1e,_20);
}
}
catch(err){
this.onDndStop(false);
console.error("Drag and drop error: ",err);
return;
}
}else{
var _21=_1.overContainer;
var _22=_21.move(_1c,_21);
if(_22){
_1.fromContainer.onDndStop(false);
return;
}
}
}
this.onDndStop(true);
},onDndStart:function(_23,_24){
if(_23.dndEvent){
dojo.disconnect(_23.dndEvent);
}
dojo.addClass(document.body,"jazz-ui-dnd-moveCursor");
_23.dndEvent=dojo.connect(document.body,"onmouseup",this,this.onMouseUp);
_1.initDrag(this,_23,_24);
},onDndStop:function(_25){
var _26=_1.widget;
dojo.removeClass(document.body,"jazz-ui-dnd-moveCursor");
if(_26){
if(_26.dndEvent){
dojo.disconnect(_26.dndEvent);
}
var _27=_25?_1.overContainer:this;
_26.dndEvent=dojo.connect(_26.handle,"onmousedown",_27,this.onMouseDown);
}
_1.stopDrag();
this.clearPlaceholder();
},insertPlaceholder:function(_28){
var _29=_1.widgetCoords;
this.height=_29.h-2;
if(this.height==0){
this.height=50;
}
this.clearPlaceholder();
var _2a=document.createElement("div");
_2a.id="jazz-ui-dnd-placeholder";
_2a.style.height=this.height-(_29.marginTop+_29.marginBottom)+"px";
if(this.horizontal){
_2a.style.width=_29.w+"px";
}
var dec=0;
if(this==_1.fromContainer&&this.overWidget.index>=_1.widget.index){
dec=1;
}
if(this.dropAtEnd){
if(!this.node.lastChild||dojo.hasClass(this.node.lastChild,"dndItem")){
this.node.appendChild(_2a);
}else{
this.node.insertBefore(_2a,this.node.lastChild);
}
_2a.index=this.widgets.length-dec;
return;
}
if(_28){
this.node.insertBefore(_2a,this.overWidget.domNode);
_2a.index=this.overWidget.index-dec;
}else{
var _2b=this.overWidget.domNode.nextSibling;
if(!_2b){
this.node.appendChild(_2a);
}else{
this.node.insertBefore(_2a,_2b);
}
_2a.index=this.overWidget.index+1-dec;
}
},clearPlaceholder:function(){
var _2c=this.getPlaceholder();
if(_2c){
_2c.parentNode.removeChild(_2c);
}
},getPlaceholder:function(){
return dojo.byId("jazz-ui-dnd-placeholder");
},updateIndices:function(col){
if(!col){
col=this;
}
for(var i=0;i<col.widgets.length;i++){
col.widgets[i].index=i;
}
}});
dojo.provide("jazz.ui.dnd.Avatar");
jazz.ui.dnd.Avatar=function(_2d,_2e){
this.manager=_2d;
this.construct(_2e);
};
dojo.extend(jazz.ui.dnd.Avatar,{construct:function(_2f){
var a=dojo.doc.createElement("div");
a.className="jazz-ui-dnd-avatar dndAvatar";
var _30=_2f.split(" ");
for(var i=0;i<_30.length;i++){
if(_30[i]){
dojo.addClass(a,_30[i]);
}
}
a.id="avatar";
a.style.position="absolute";
a.style.zIndex=10000;
a.style.margin="0px";
a.style.width="33%";
var _31=this.manager.widget;
var _32=_31.domNode.cloneNode(true);
a.style.width=this.manager.widgetCoords.w+"px";
_31.domNode.style.display="none";
_32.id="";
a.appendChild(_32);
this.node=a;
},destroy:function(){
dojo._destroyElement(this.node);
if(this.manager.widget.domNode){
this.manager.widget.domNode.style.display="";
}
this.node=false;
}});
jazz.ui.dnd.TRIGGER_AUTOSCROLL=32;
jazz.ui.dnd.AUTOSCROLL_OFFSET=16;
jazz.ui.dnd.autoScroll=function(e){
var dx=0;
var dy=0;
var _33=dijit.getViewport();
var _34=jazz.ui.dnd.TRIGGER_AUTOSCROLL;
var _35=jazz.ui.dnd.AUTOSCROLL_OFFSET;
var de=document.documentElement;
var _36=de.scrollTop?de.scrollTop:document.body.scrollTop;
var _37=de.scrollLeft?de.scrollLeft:document.body.scrollLeft;
if(e.clientX<_34){
dx=-_35;
}else{
if(e.clientX>_33.w-_34&&_37<_1._scrollMaxX){
dx=_35;
}
}
if(e.clientY<_34){
dy=-_35;
}else{
if(e.clientY>_33.h-_34&&_36<_1._scrollMaxY){
dy=_35;
}
}
window.scrollBy(dx,dy);
};
})();


;dojo.provide("jazz.ensemble.internal.layout.Column");










(function(){
var _1=jazz.ui.dnd.draggableManager();
dojo.declare("jazz.ensemble.internal.layout.Column",[dijit._Widget,dijit._Container,dijit._Templated],{index:null,onChange:null,readOnly:false,relativeTo:null,onAddWidget:null,onRemoveWidget:null,layout:null,_column:null,templateString:"<div class=\"jazz-ensemble-internal-layout-Column column${index}\"></div>",postCreate:function(){
this._column=new jazz.ensemble.internal.layout._Column(this.domNode,{accept:["widget"],enabled:!this.readOnly,columnIndex:this.index,relativeTo:this.relativeTo,onStateChange:this.onChange,onAddWidget:this.onAddWidget,onRemoveWidget:this.onRemoveWidget,layout:this.layout,widgetRefs:this.widgetRefs});
},add:function(_2,_3){
var _4={index:0,handle:_2.handle,type:"widget"};
if(_3!==null){
_4.index=_3;
}
this._column.add(_2,_4);
},remove:function(_5){
var _6=dijit.byNode(_5.domNode);
this._column.remove(_6.getIndexInParent());
},setEnabled:function(_7){
this._column.setEnabled(_7);
}});
dojo.declare("jazz.ensemble.internal.layout._Column",jazz.ui.dnd.DraggableContainer,{constructor:function(_8,_9){
this._disabled=true;
this.useAvatar=false;
this.index=_9.columnIndex;
this.relativeTo=_9.relativeTo;
this.containerNode=this.domNode=_8;
this.onStateChange=_9.onStateChange;
this.onAddWidget=_9.onAddWidget;
this.onRemoveWidget=_9.onRemoveWidget;
this.layout=_9.layout;
this.widgetRefs=_9.widgetRefs;
if(this.index===0){
this.avatarClass="column0";
}
this.setEnabled(_9.enabled);
},onMouseDown:function(_a){
this.inherited(arguments);
var _b=_1.widget;
if(_b&&_b.isZoomed){
var _c=dojo.position(_a.currentTarget,true);
var _d=dojo.marginBox(_b.zoomPlaceholder);
var _e=_a.pageX-_c.x;
var _f=_a.pageY-_c.y;
if(_e>_d.w-80){
_e=_d.w-80;
}
_1.initialMouseCoords.offsetX=_e;
_1.initialMouseCoords.offsetY=_f;
}
},onStartDrag:function(){
var _10=dojo.byId("content-cell");
if(_10){
_10.style.overflow="visible";
}
var _11=_1.widget;
if(_11&&_11.isZoomed){
_1.widget.toggleZoom(null,true);
var _12=dojo.position(_1.widget.domNode,true);
_1.widgetCoords.h=_12.h;
_1.widgetCoords.w=_12.w;
}
},move:function(_13,_14,_15){
var _16=_1.fromContainer;
var _17=_16.widgets;
if(_14.layout!=_16.layout&&_14.moveTo){
var _18=_17[_13];
var _19=_14.moveTo(_18,_15);
if(_19){
this.onRemoveWidget(dijit.byNode(_18.domNode));
}else{
throw new Error();
}
}else{
_18=_17.splice(_13,1)[0];
var _1a=_16.widgetRefs.splice(_13,1)[0];
_14.node.insertBefore(_18.domNode,this.getPlaceholder());
_14.widgets.splice(_15,0,_18);
_14.widgetRefs.splice(_15,0,_1a);
var _1b=[_16,_14];
for(var j=0;j<_1b.length;j++){
this.updateIndices(_1b[j]);
if(_16==_14){
break;
}
}
this.onStateChange();
var w=dijit.byNode(_18.domNode);
w&&w.onMove&&w.onMove();
}
},moveTo:function(_1c,_1d){
var w=dijit.byNode(_1c.domNode);
this.onAddWidget(w.state.elem,this.node,_1d);
w&&w.onMove&&w.onMove();
return true;
},onDndStop:function(_1e){
this.inherited(arguments);
var _1f=dojo.byId("content-cell");
if(_1f){
_1f.style.overflow="";
}
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
}});
})();


;dojo.provide("jazz.ensemble.internal.layout.ResizableColumns");








(function(){
var _1=jazz.util.ResizeNotifier;
var _2=jazz.ui.underlay;
dojo.declare("jazz.ensemble.internal.layout.ResizableColumns",[dijit._Widget,dijit._Templated],{columns:null,widths:null,minWidth:180,fadeInDuration:150,fadeOutDuration:300,readOnly:false,heightNode:null,onChange:null,_sliders:null,_currentWidth:0,_initWidths:false,templateString:"<div class=\"jazz-ensemble-internal-layout-ResizableColumns\"></div>",postCreate:function(){
this._resizeHandle=_1.register({context:this,callback:this._onResize});
},startup:function(_3){
if(_3){
this.columns=_3;
}else{
if(!this.columns){
console.error("Error: No columns passed to ResizableColumns");
return;
}
}
if(!this.widths||this.widths.length!=this.columns.length){
this.widths=new Array();
var _4=100/this.columns.length;
for(var i=0;i<this.columns.length;i++){
this.widths[i]=_4;
}
this._initWidths=true;
}
this.update();
this.inherited(arguments);
},_setReadOnlyAttr:function(_5){
this.readOnly=_5;
if(_5){
this._clearSliders();
}else{
if(this._started){
this.update();
}
}
},_onResize:function(){
this.update();
},update:function(_6){
if(!this.domNode){
return;
}
this._currentWidth=dojo.marginBox(this.domNode).w;
var _7=this._sliders&&this._sliders.length>0;
if(this._currentWidth){
this._validateWidths(_6);
}
if(this.readOnly&&_7){
this._clearSliders();
_7=false;
}
for(var i=0;i<this.columns.length;i++){
var _8=this.columns[i];
if(_8&&_8.domNode){
if(!_8.domNode.parentNode||_8.domNode.parentNode!=this.domNode){
this.domNode.appendChild(_8.domNode);
}
_8.domNode.style.width=this.widths[i]+"%";
if(!this.readOnly&&i!=this.columns.length-1){
if(_7){
this._updateSlider(_8.domNode,i);
}else{
this._addSlider(_8.domNode,i);
}
}
}
}
if(this._initWidths){
_6=true;
this._initWidths=false;
}
this._updateHeight();
setTimeout(dojo.hitch(this,this._updateHeight),2000);
if(_6&&this.onChange&&dojo.isFunction(this.onChange)){
this.onChange(this.widths);
}
},_validateWidths:function(_9){
if(this._cachedWidths&&_9!==true){
this.widths=this._cachedWidths;
}else{
this._cachedWidths=dojo.clone(this.widths);
}
var _a=new Array();
var _b=0,_c=0,_d=0;
for(var i=0;i<this.widths.length;i++){
if(this.widths[i]/100*this._currentWidth<this.minWidth){
_a[i]=this.minWidth/this._currentWidth*100;
_b+=Math.abs(this.widths[i]-_a[i]);
_c++;
}else{
_a[i]=0;
_d++;
}
}
var _e=_d?_b/_d:0;
var _f=0;
for(var j=0;j<_a.length;j++){
if(_a[j]==0){
_a[j]=this.widths[j]-_e;
}else{
_a[j]=_a[j];
}
_f+=_a[j];
}
this.widths=_a;
},_startDragging:function(e){
dojo.stopEvent(e);
this._currentSlider=e.currentTarget.index;
dojo.addClass(document.body,"jazz-ui-SideNavigationLayout-dragCursor");
if(this._dragListeners){
for(var i=0;i<this._dragListeners.length;i++){
this.disconnect(this._dragListeners[i]);
}
}
this._dragListeners=[this.connect(dojo.doc,"onmousemove","_drag"),this.connect(document.body,"onmouseout","_drag"),this.connect(document.body,"onmouseup","_stopDragging"),this.connect(document.body,"ondragstart","_cancelEvent"),this.connect(document.body,"onselectstart","_cancelEvent"),this.connect(document.body,"onmouseleave","_stopDragging")];
this._isDragging=true;
this._lastX=e.pageX;
this._delta=0;
this._pixelize();
jazz.ui.underlay.show({opacity:0,zIndex:2000});
},_pixelize:function(){
this._pixelCoords=new Array();
for(var i=0;i<this.columns.length;i++){
var col=this.columns[i].domNode;
var _10=dojo.marginBox(col).w+1;
col.style.width=_10+"px";
this._pixelCoords.push(_10);
}
},_drag:function(e){
var i=this._currentSlider;
var col=this.columns[i];
var _11=this.columns[i+1];
this._delta=e.pageX-this._lastX;
if(this._pixelCoords[i]+this._delta<=this.minWidth){
this._delta=this.minWidth-this._pixelCoords[i];
}else{
if(this._pixelCoords[i+1]-this._delta<=this.minWidth){
this._delta=this._pixelCoords[i+1]-this.minWidth;
}
}
col.domNode.style.width=this._pixelCoords[i]+this._delta+"px";
_11.domNode.style.width=this._pixelCoords[i+1]-this._delta+"px";
this._updateSlider(col.domNode,i);
this._updateHeight();
},_stopDragging:function(e){
dojo.removeClass(document.body,"jazz-ui-SideNavigationLayout-dragCursor");
if(this._dragListeners){
for(var i=0;i<this._dragListeners.length;i++){
this.disconnect(this._dragListeners[i]);
}
delete this._dragListeners;
}
this._pixelCoords[this._currentSlider]+=this._delta;
this._pixelCoords[this._currentSlider+1]-=this._delta;
this._isDragging=false;
var _12=this._sliders[this._currentSlider];
if(_12){
this._doFade(_12,dojo.fadeOut);
}
this._currentSlider=null;
var _13=0;
for(var i=0;i<this._pixelCoords.length;i++){
_13+=this._pixelCoords[i];
}
for(var i=0;i<this.widths.length;i++){
this.widths[i]=this._pixelCoords[i]/_13*100;
}
jazz.ui.underlay.hide();
_1.poke();
this.update(true);
},_cancelEvent:function(_14){
dojo.stopEvent(_14);
},_addSlider:function(_15,i){
if(!this._sliders){
this._sliders=new Array();
}
var div=dojo.create("div",{"class":"jazz-ensemble-internal-layout-ResizableColumns-Slider"});
dojo.create("div",{},div);
this.connect(div,"onmousedown",this._startDragging);
this.connect(div,"onmouseover",this._showSlider);
this.connect(div,"onmouseout",this._hideSlider);
dojo.place(div,this.domNode);
var _16=dojo.marginBox(_15);
div.style.left=_16.l+_16.w-8+"px";
dojo.style(div,{opacity:0});
div.index=i;
this._sliders[i]=div;
},uninitialize:function(){
if(this._currentFade&&this._currentFade.status()=="playing"){
this._currentFade.stop();
}
if(this._resizeHandle){
_1.unregister(this._resizeHandle);
}
},_clearSliders:function(){
while(this._sliders&&this._sliders.length>0){
var _17=this._sliders.pop();
if(_17.parentNode){
_17.parentNode.removeChild(_17);
}
}
},_updateSlider:function(_18,_19){
var _1a=dojo.marginBox(_18);
if(this._sliders){
if(this._sliders[_19]){
this._sliders[_19].style.left=_1a.l+_1a.w-8+"px";
}else{
this._addSlider(_1a,_19);
}
}
},_showSlider:function(_1b){
this._updateHeight();
this._doFade(_1b.currentTarget,dojo.fadeIn);
},_hideSlider:function(_1c){
this._doFade(_1c.currentTarget,dojo.fadeOut);
},_doFade:function(_1d,_1e){
if(!this._isDragging&&dojo.some(this._sliders,function(_1f){
return _1f;
})){
if(this._currentFade&&this._currentFade.status()=="playing"){
if(_1d==this._currentFade.node){
this._currentFade.stop();
}else{
dojo.style(this._currentFade.node,{opacity:this._currentFade.properties.opacity.end});
}
}
var _20={node:_1d,duration:(_1e==dojo.fadeOut)?this.fadeOutDuration:this.fadeInDuration,onEnd:dojo.hitch(this,function(){
this._currentFade=null;
})};
this._currentFade=_1e(_20);
this._currentFade.play();
}
},_updateHeight:function(){
if(!this.domNode||!this.heightNode){
return;
}
var _21=dojo.contentBox(this.heightNode).h;
if(_21>12){
_21-=12;
}
if(this._currentSlider){
var _22=this._sliders[this._currentSlider];
if(_22){
_22.style.height=_21+"px";
}
}else{
if(this._sliders){
for(var i=0;i<this._sliders.length;i++){
this._sliders[i].style.height=_21+"px";
}
}
}
}});
})();


;dojo.provide("jazz.ensemble.internal.layout.ColumnLayout");












(function(){
var _1=jazz.util.binding;
var _2=jazz.ensemble.internal.util.bindings;
var _3=jazz.ensemble.internal.layout.Column;
var _4=jazz.ensemble.internal.layout.ResizableColumns;
var _5="jazz.ensemble.layout.1column";
var _6="jazz.ensemble.layout.2column";
var _7="jazz.ensemble.layout.3column";
dojo.declare("jazz.ensemble.internal.layout.ColumnLayout",[jazz.ensemble.internal.Layout,dijit._Templated],{templateString:"<div class=\"jazz-ensemble-layout-column\"></div>",type:null,onStateChange:null,onAddWidget:null,onRemoveWidget:null,_data:null,_columns:null,_columnStates:null,_itemsById:null,_numColumns:null,postCreate:function(){
this._itemsById={};
switch(this.type){
case _5:
this._numColumns=1;
break;
case _6:
this._numColumns=2;
break;
case _7:
this._numColumns=3;
break;
}
for(var i=0;i<this.items.length;i++){
var _8=this.items[i];
dojo.addClass(_8.domNode,"normal");
this._itemsById[_8.id]=_8;
}
delete this.items;
var _9=this._data=_1.bind(this.data,_2.ColumnLayoutData);
var _a=this._columnStates=_9.getColumns();
if(this._numColumns>1){
var _b=new Array();
for(i=0;i<this._numColumns;i++){
_b.push(_a[i].getWidth());
}
this._resizableColumns=new _4({readOnly:this.readOnly,onChange:dojo.hitch(this,this._onChangeWidths),widths:_b});
this.domNode.appendChild(this._resizableColumns.domNode);
}
var _c=this._columns=new Array();
var _d;
switch(this._numColumns){
case 1:
_d="one-col";
break;
case 2:
_d="two-col";
break;
default:
_d="three-col";
}
for(i=0;i<this._numColumns;i++){
var _e=_a[i].getWidgetReferences();
var _f=new _3({"class":_d,index:i,readOnly:this.readOnly,relativeTo:this.domNode,onChange:dojo.hitch(this,this._onChangeWidgets),state:_a[i],onAddWidget:dojo.hitch(this,this._onAddWidget),onRemoveWidget:dojo.hitch(this,this._onRemoveWidget),layout:this,widgetRefs:_e});
dojo.addClass(_f.domNode,"normal");
for(var j=0;j<_e.length;j++){
_f.add(this._itemsById[_e[j].getId()]);
}
_c.push(_f);
}
},_onAddWidget:function(_10,_11,pos){
this.onAddWidget(_10,_11,pos);
},_onRemoveWidget:function(_12){
this.onRemoveWidget(_12);
},startup:function(){
if(this._resizableColumns){
this._resizableColumns.heightNode=this.domNode.parentNode.parentNode;
this._updateResizableColumns();
this._resizableColumns.startup(this._columns);
}else{
if(this._columns[0]){
dojo.place(this._columns[0].domNode,this.domNode);
}
}
},add:function(_13,ref,pos){
var _14=0;
var _15=0;
if(ref!=null){
if(ref.nodeType){
var col=dijit.byNode(ref);
var _14=col.index;
if(pos===null){
var _15=ref.childNodes.length;
}else{
if(typeof pos=="number"){
_15=pos;
}
}
}else{
if(dojo.isString(ref)){
refItem=this._itemsById[ref];
_14=dijit.byNode(refItem.domNode).getParent().index;
_15=refItem.index;
}
}
}
dojo.addClass(_13.domNode,"normal");
var _16=this._columns[_14];
_16.add(_13,_15);
_16.widgetRefs.splice(_15,0,{id:_13.id});
this._itemsById[_13.id]=_13;
this._updateResizableColumns();
},setMaximized:function(id,_17){
var _18=this._itemsById[id];
if(_18){
var _19=_18.domNode;
var _1a=_19.parentNode;
var _1b=dijit.byNode(_1a);
if(_17){
_1b.setEnabled(false);
if(this._resizableColumns){
this._resizableColumns.set("readOnly",true);
}
for(var i in this._itemsById){
if(i!=id){
var _1c=dijit.byNode(this._itemsById[i].domNode);
_1c.onHide();
}
}
dojo.removeClass(_19,"normal");
dojo.addClass(_19,"maximized");
dojo.removeClass(_1a,"normal");
dojo.addClass(_1a,"maximized");
dojo.addClass(this.domNode,"maximized");
}else{
_1b.setEnabled(!this.readOnly);
dojo.removeClass(_19,"maximized");
dojo.addClass(_19,"normal");
dojo.removeClass(_1a,"maximized");
dojo.addClass(_1a,"normal");
dojo.removeClass(this.domNode,"maximized");
this._updateResizableColumns();
setTimeout(dojo.hitch(this,function(){
for(var i in this._itemsById){
if(i!=id){
var _1d=dijit.byNode(this._itemsById[i].domNode);
_1d.onShow();
}
}
}),0);
}
}
},remove:function(id){
var _1e=this._itemsById[id];
if(_1e){
var _1f=dijit.byNode(_1e.domNode);
var _20=_1f.getParent();
_20.remove(_1e);
_20.widgetRefs.splice(_1e.index,1);
this._updateResizableColumns();
delete this._itemsById[id];
}
},_onChangeWidgets:function(){
this._updateResizableColumns();
this.onStateChange();
},_onChangeWidths:function(_21){
this._updateWidths(_21);
this.onStateChange();
},_updateResizableColumns:function(){
var rc=this._resizableColumns;
if(!rc){
return;
}
var _22=false;
for(var i=0;i<this._columns.length;i++){
var _23=[];
var _24=this._columns[i].getChildren();
if(_24.length>0){
_22=true;
break;
}
}
if(_22){
if(rc.get("readOnly")!=this.readOnly){
rc.set("readOnly",this.readOnly);
}
}else{
rc.set("readOnly",true);
}
},_updateWidths:function(_25){
for(var i=0;i<_25.length;i++){
var _26=Math.round(_25[i]*100)/100;
this._columnStates[i].setWidth(_26);
}
}});
dojo.mixin(jazz.ensemble.internal.layout.ColumnLayout,{ID_1:_5,ID_2:_6,ID_3:_7,addDefaultLayout:function(_27){
_27.setLayout({type:_7});
var _28=_1.bind(_27.getLayout().elem,_2.ColumnLayout);
_28.setData({columns:[{width:34,widgetReferences:[],widgetReferencesParseType:"Collection"},{width:33,widgetReferences:[],widgetReferencesParseType:"Collection"},{width:33,widgetReferences:[],widgetReferencesParseType:"Collection"}],columnsParseType:"Collection"});
}});
})();


;dojo.provide("jazz.ensemble.internal.LayoutFactory");


(function(){
var _1=jazz.ensemble.internal.layout.ColumnLayout;
var _2=_1.ID_3;
jazz.ensemble.internal.LayoutFactory={createLayout:function(_3,_4,_5){
var _6=_3.getData();
var _7=_3.getType();
var _8={data:_6.elem,items:_4,readOnly:_5,type:_7};
switch(_7){
case _1.ID_1:
case _1.ID_2:
case _1.ID_3:
return new _1(_8);
default:
throw new Error("Invalid layout type '"+_7+"'");
}
},addDefaultLayout:function(_9){
_1.addDefaultLayout(_9);
}};
})();


;dojo.cache("jazz.ensemble", "internal/templates/WidgetPanel.html", "<div class=\"jazz-ensemble-WidgetPanel\">	<div class=\"clear\"></div></div>");

;dojo.provide("jazz.ensemble.WidgetPanel");


















dojo.requireLocalization("jazz.ensemble.internal","Messages");
(function(){
var _1=jazz.util.binding;
var _2=jazz.ensemble.internal.util.bindings;
var _3=jazz.util.dom;
var _4=jazz.ensemble.internal.LayoutConverter;
var _5=jazz.ensemble.internal.LayoutFactory;
var _6=jazz.ensemble.internal.WidgetContainer;
var _7=dojo.i18n.getLocalization("jazz.ensemble.internal","Messages");
dojo.declare("jazz.ensemble.WidgetPanel",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("jazz.ensemble","internal/templates/WidgetPanel.html"),allowMaximize:true,onStateChange:function(){
},properties:{},readOnly:false,shared:true,state:null,uuid:null,_layout:null,_started:false,_state:null,_widgets:null,_widgetContainers:[],postCreate:function(){
if(this.state){
this.setState(this.state);
}
},addWidget:function(_8,_9){
var _a=this._addWidget.apply(this,arguments);
_a.domNode.style.height="1px";
dojo.style(_a.domNode,{opacity:0});
var _b={node:_a.domNode,duration:200};
var _c=dojo.fx.chain([dojo.fx.wipeIn(_b),dojo.fadeIn(_b)]);
var _d=dojo.connect(_c,"onEnd",_a,function(){
dojo.disconnect(_d);
var s=this.domNode.style;
s.overflow="";
s.opacity="";
if(s.removeAttribute){
s.removeAttribute("filter");
}
});
this._stateChanged();
_c.play();
},createWidget:function(){
var _e=this._state.elem;
var _f=_3.lookupPrefix(_e,_2.NAMESPACES.jw)||"jw";
widgetElem=_3.createElementNS(_e.ownerDocument,_2.NAMESPACES.jw,_f+":Widget");
this._createNamespaceWrapper().appendChild(widgetElem);
return widgetElem;
},uninitialize:function(){
if(this._layout){
this._layout.destroy();
}
for(var i=0;i<this._widgetContainers.length;i++){
this._widgetContainers[i].destroy();
}
},isDirty:function(){
var _10=this._widgetContainers;
var len=_10.length;
for(var i=0;i<len;++i){
if(_10[i].isDirty()){
return true;
}
}
return false;
},isEmpty:function(){
return (this._widgetContainers.length==0);
},onShow:function(){
for(var i=0;i<this._widgetContainers.length;i++){
this._widgetContainers[i].onShow();
}
},onHide:function(){
for(var i=0;i<this._widgetContainers.length;i++){
this._widgetContainers[i].onHide();
}
},refresh:function(){
for(var i=0;i<this._widgetContainers.length;i++){
this._widgetContainers[i].refresh();
}
},removeWidget:function(id){
for(var i=0;i<this._widgetContainers.length;i++){
var _11=this._widgetContainers[i];
if(_11.widgetId==id){
this._removeWidgetContainer(_11);
break;
}
}
},setLayout:function(_12){
var _13=_1.bind(this.state,_2.Page);
var _14=_13.getLayout().getType();
if(_12!=_14){
_13.getLayout().setType(_12);
var _15=_13.getLayout().getData().elem;
_4.convert(_14,_12,_15);
this.setState(this.state);
this._stateChanged();
}
},setState:function(_16){
this.state=_16;
this._state=_1.bind(_16,_2.Page);
for(var i=0;i<this._widgetContainers.length;i++){
this._widgetContainers[i].destroy();
}
this._widgetContainers=[];
var _17=this._widgets=this._state.getWidgets();
for(var i=0;i<_17.length;i++){
this._widgetContainers.push(this._createWidgetContainer(_17[i]));
}
this._setLayout(this._createLayout(this._state.getLayout()));
if(this._started){
dojo.forEach(this._widgetContainers,function(w){
w.startup();
});
}
},startup:function(){
this.inherited(arguments);
this._started=true;
if(this._layout){
this._layout.startup();
}
dojo.forEach(this._widgetContainers,function(w){
w.startup();
});
},_addWidget:function(_18,ref,pos){
this._createNamespaceWrapper().appendChild(_18);
var _19=_1.bind(_18,_2.Widget);
_19.setId(this._generateWidgetId());
var _1a=this._createWidgetContainer(_19);
this._addWidgetContainer(_1a,ref,pos);
_1b(_18);
return _1a;
},_addWidgetContainer:function(_1c,ref,pos){
this._widgetContainers.push(_1c);
this._widgets.push(_1c.state);
this._layout.add(this._itemizeWidget(_1c),ref,pos);
_1c.startup();
},_createLayout:function(_1d){
var _1e=[];
for(var i=0;i<this._widgetContainers.length;i++){
_1e.push(this._itemizeWidget(this._widgetContainers[i]));
}
var _1f=_5.createLayout(_1d,_1e,this.readOnly);
_1f.onStateChange=dojo.hitch(this,this._stateChanged);
_1f.onAddWidget=dojo.hitch(this,this._onAddWidget);
_1f.onRemoveWidget=dojo.hitch(this,this._onRemoveWidget);
return _1f;
},_createNamespaceWrapper:function(){
var _20=this._state.elem.ownerDocument.createElement("wrapper");
var _21=_2.NAMESPACES;
var _22=["dc","jw","rdf"];
for(var i=0;i<_22.length;++i){
var _23=_21[_22[i]];
var _24=_3.lookupPrefix(this._state.elem,_23);
if(_24){
_3.setAttributeNS(_20,"http://www.w3.org/2000/xmlns/","xmlns:"+_24,_23);
}
}
return _20;
},_createWidgetContainer:function(_25){
var _26=new _6({readOnly:this.readOnly,shared:this.shared,state:_25,onClose:dojo.hitch(this,this._onWidgetClose,_25.getId()),onStateChange:dojo.hitch(this,this._stateChanged),properties:this.properties,panelId:this.uuid});
if(this.allowMaximize){
_26.setMaximizeContainerHandler(dojo.hitch(this,this._handleMaximize,_26));
}
if(!this.readOnly){
_26.setDuplicateHandler(dojo.hitch(this,this._handleDuplicateWidget,_26));
}
return _26;
},_generateWidgetId:function(){
var max=0;
for(var i=0;i<this._widgetContainers.length;i++){
try{
var _27=parseInt(this._widgetContainers[i].widgetId.substring(1));
if(_27>max){
max=_27;
}
}
catch(e){
}
}
return "_"+(max+1);
},_handleDuplicateWidget:function(_28){
var _29=_28.state.elem.cloneNode(true);
this.addWidget(_29,_28.widgetId);
},_handleMaximize:function(_2a,_2b){
this._layout.setMaximized(_2a.widgetId,_2b);
},_itemizeWidget:function(_2c){
return {id:_2c.widgetId,domNode:_2c.domNode,handle:_2c._headerText};
},_onWidgetClose:function(id){
for(var i=0;i<this._widgetContainers.length;i++){
var _2d=this._widgetContainers[i];
if(_2d.widgetId==id){
var _2e=_2d.primaryTitle||_7.undefinedTitle;
if(confirm(dojo.string.substitute(_7.confirmRemoveWidget,[_2e]))){
var _2f={node:_2d.domNode,duration:250};
var _30=dojo.fx.chain([dojo.fadeOut(_2f),dojo.fx.wipeOut(_2f)]);
var _31=dojo.connect(_30,"onEnd",this,function(){
dojo.disconnect(_31);
this._removeWidgetContainer(_2d);
_2d.destroy();
_2d=null;
this._stateChanged();
});
_30.play();
}
break;
}
}
return false;
},_removeWidgetContainer:function(_32){
var _33=dojo.indexOf(this._widgetContainers,_32);
this._widgetContainers.splice(_33,1);
this._widgets.splice(_33,1);
this._layout.remove(_32.widgetId);
},_onRemoveWidget:function(_34){
this._removeWidgetContainer(_34);
_34.destroy();
this._stateChanged();
},_onAddWidget:function(_35,ref,_36){
var _37=_35.cloneNode(true);
this.addWidget(_37,ref,_36);
},_setLayout:function(_38){
var _39=this._layout;
if(_39){
_39.destroy();
_39=null;
}
dojo.place(_38.domNode,this.domNode,"first");
if(this._started){
_38.startup();
}
this._layout=_38;
},_stateChanged:function(){
this.onStateChange&&_3a(this.onStateChange);
}});
function _3a(_3b){
try{
_3b();
}
catch(e){
console.error(e);
}
};
function _1b(_3c,_3d){
_3d=_3d||_3c.parentNode;
var _3e=_3c.attributes;
for(var i=0;i<_3e.length;++i){
var _3f=_3e[i];
if(_3f.prefix==="xmlns"&&_3.lookupNamespaceURI(_3d,_3f.name.substring(6))===_3f.value){
_3c.removeAttributeNode(_3f);
--i;
}
}
var _40=_3c.firstChild;
while(_40){
_40.nodeType===1&&_1b(_40,_3d);
_40=_40.nextSibling;
}
};
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/ViewletPage.html", "<div class=\"com-ibm-team-dashboard-viewletpage\" dojoattachpoint=\"_tabArea\">	<div class=\"page-loading\" dojoAttachPoint=\"_loadingText\">		${messages.loading}	</div>	<div style=\"display: none\" class=\"empty-tab-message\" dojoAttachPoint=\"_emptyTabMessage\">		${messages.noViewlets} <span class=\"empty-tab-help-message\" dojoAttachPoint=\"_showInEditMode\"></span>	</div>		</div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ViewletPage");


















dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=jazz.util.binding;
var _2=jazz.ensemble.internal.util.bindings;
var _3=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _4=com.ibm.team.dashboard.web.ui.internal.util.Observable;
var _5=com.ibm.team.dashboard.web.ui.internal.Constants;
var _6;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ViewletPage",[dijit._Widget,dijit._Templated,_4],{page:null,pageId:null,dashboardContainer:null,dashboardBundle:null,templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/ViewletPage.html"),constructor:function(_7){
this.messages=_6=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
},postCreate:function(){
this._emptyTabAddViewletLink=jazz.util.i18n.addMessage(this._showInEditMode,dojo.string.substitute(_6.noViewletsAdd,[_6.addViewletText]))[0];
this._emptyTabAddViewletEvent=dojo.connect(this._emptyTabAddViewletLink,"onclick",this.dashboardContainer,this.dashboardContainer.openCatalog);
this.editing=(this.dashboardContainer.editMode!=_5.READ_ONLY)?true:false;
if(!this.editing){
this._showInEditMode.style.display="none";
}
},init:function(){
this._yieldTimeout=setTimeout(dojo.hitch(this,this.init2),0);
this.isActive=true;
},init2:function(){
if(!this._isDestroyed){
delete this._yieldTimeout;
this._createWidgetPanel();
this._loadingText.style.display="none";
}
},_createWidgetPanel:function(){
var _8={"com.ibm.team.dashboard.scope":this.dashboardBundle.scope,"com.ibm.team.dashboard.scopeItem":this.dashboardBundle.scopeItem,"com.ibm.team.dashboard.defaults":this.dashboardBundle.defaults};
var _9=(this.dashboardBundle.scope!=_3.SCOPE_CONTRIBUTOR)||(this.dashboardBundle.contributorItemId!=this.dashboardBundle.scopeItem.itemId);
this._widgetPanel=new jazz.ensemble.WidgetPanel({allowMaximize:true,properties:_8,readOnly:!this.dashboardBundle.permissions.modify,shared:_9,state:this.page.elem,onStateChange:dojo.hitch(this,this._onStateChange),uuid:this.dashboardBundle.dashboardUrl});
this._tabArea.appendChild(this._widgetPanel.domNode);
this._widgetPanel.startup();
this.updateEmptyPageMessage();
},isEditing:function(){
return this._widgetPanel&&this._widgetPanel.isDirty();
},isVisible:function(){
return (this.dashboardContainer.currentPage==this)&&this.dashboardContainer.isVisible();
},setEditMode:function(_a){
this.editing=_a;
this._showInEditMode.style.display=_a?"":"none";
},setActive:function(_b){
if(this.isActive!=_b){
this.isActive=_b;
if(this._widgetPanel){
if(_b){
this._widgetPanel.onShow();
}else{
this._widgetPanel.onHide();
}
}
}
},setLayout:function(_c){
this._widgetPanel.setLayout(_c);
},addWidget:function(_d){
var _e=this._widgetPanel.createWidget();
var _f=_1.bind(_e,_2.Widget);
_f.setType(_d.type);
_f.setDefinition(_d.widgetUri);
_f.setTitle(_d.title);
if(_d.icon){
_f.setIcon(_d.icon);
}
var _10=_d.preferences;
if(_10 instanceof Array&&_10.length>0){
var _11=[];
_f.setPreferencesParseType("Collection");
var len=_10.length;
for(var i=0;i<len;++i){
var _12=_10[i];
_11.push({name:_12.name,value:_12.value});
}
_f.setPreferences(_11);
}
this._widgetPanel.addWidget(_e);
this.updateEmptyPageMessage();
this.propertyChanged(_5.PROPERTY_DASHBOARD);
},addWidgetFromElement:function(_13){
this._widgetPanel.addWidget(_13);
this.propertyChanged(_5.PROPERTY_DASHBOARD);
},removeWidget:function(id){
this._widgetPanel.removeWidget(id);
this.updateEmptyPageMessage();
},updateEmptyPageMessage:function(){
this._setEmptyTabMessage(this._widgetPanel.isEmpty());
},_onStateChange:function(){
this.propertyChanged(_5.PROPERTY_DASHBOARD);
this.updateEmptyPageMessage();
},_setEmptyTabMessage:function(_14){
if(_14){
this._emptyTabMessage.style.display="block";
}else{
this._emptyTabMessage.style.display="none";
}
},destroy:function(){
this._isDestroyed=true;
if(this._yieldTimeout){
clearTimeout(this._yieldTimeout);
delete this._yieldTimeout;
}
if(this._emptyTabAddViewletEvent){
dojo.disconnect(this._emptyTabAddViewletEvent);
}
if(this._widgetPanel){
this._widgetPanel.destroy();
}
this.inherited(arguments);
},refreshPage:function(){
this.dashboardContainer._refreshCurrentTab();
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.dnd.TabTarget");












(function(){
var _1=jazz.ensemble.internal.util.bindings;
var _2=jazz.util.binding;
var _3=com.ibm.team.dashboard.web.ui.internal.Constants;
var _4=jazz.ui.dnd.draggableManager();
dojo.declare("com.ibm.team.dashboard.web.ui.internal.dnd.TabTarget",jazz.ui.dnd.DraggableContainer,{constructor:function(_5,_6){
this.isSource=false;
this.index=_6.index;
this.dashboardContainer=_6.dashboardContainer;
},destroy:function(){
var _7=_4.targets;
for(var i=0;i<_7.length;i++){
if(_7[i]==this){
_7.splice(i,1);
break;
}
}
this.inherited(arguments);
},move:function(_8,_9){
var dw=_4.widget;
var _a=dijit.byId(dw.domNode.id);
if(_a){
var _b=_a.widget;
if(_b.viewlet&&_b.viewlet.isEditing()){
_4.stopForInput();
if(!_b._stopEditing()){
return true;
}
}
}
var _c=_4.fromContainer,_d=_c.widgets[_8],_e=this.dashboardContainer.dashboardResource.binding.getPages(),_f=_e[_9.index],_10=_f.getWidgets(),max=0;
for(var i=0;i<_10.length;i++){
try{
var _11=parseInt(_10[i].getId().substring(1));
if(_11>max){
max=_11;
}
}
catch(e){
}
}
var _11="_"+(max+1),_b=dijit.byNode(_d.domNode);
var _12=this.dashboardContainer.getCurrentViewletPage();
_12.removeWidget(_b.widgetId);
_12.updateEmptyPageMessage();
_10.push(_b.state);
_b.state.setId(_11);
var _13=_2.bind(_f.getLayout().getData().elem,_1.ColumnLayoutData);
_13.getColumns()[0].getWidgetReferences().splice(0,0,{id:_11});
this.dashboardContainer._onDashboardChange();
this.dashboardContainer.setPageDirty(_9.index);
this.updateIndices(_c);
_b.destroy();
return false;
},registerContainer:function(){
_4.targets.push(this);
}});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/DraggableTab.html", "<a class=\"tab\" tabindex=\"0\" dojoAttachPoint=\"_tabLink\">	<span class=\"tabInnerDiv\">		<span class=\"tabTitle\">			<span class=\"title\" dojoAttachPoint=\"_tabTitle\"></span>			<span class=\"menu\" dojoAttachPoint=\"_menuWrapper\" style=\"display: none\"></span>		</span>	</span></a>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTab");




























dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.dnd.TabTarget;
var _2=com.ibm.team.dashboard.web.ui.internal.Constants;
var _3=jazz.util.html;
var _4;
function _5(_6){
if(_6&&this.editing){
_6.stopPropagation();
}
};
dojo.declare("com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTab",[dijit._Widget,dijit._Templated],{tabTitle:null,editing:false,selected:false,draggableTabs:null,dashboardContainer:null,page:null,_menuOpen:false,templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/DraggableTab.html"),constructor:function(_7){
this.messages=_4=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
},postCreate:function(){
if(!this.textDir){
this.textDir=jazz.app.i18n.getPreferredBaseTextDir();
}
if(!this.selected){
this._registerSelectEvent(true);
}
this.setEditMode(this.editing);
dijit.setWaiRole(this.domNode,"tab");
},setSelected:function(_8){
if(_8==this.selected){
return;
}
this.selected=_8;
if(_8){
if(this.draggableTabs.selectedTab&&!this.draggableTabs.selectedTab.isDestroyed){
this.draggableTabs.selectedTab.setSelected(false);
}
this._addTabDropDown();
dojo.addClass(this.domNode,"selectedTab");
this.draggableTabs.selectedTab=this;
this._registerSelectEvent(false);
if(!this._editableTitle){
this._tabTitle.tabIndex="0";
}
}else{
this._removeTabDropDown();
this._registerSelectEvent(true);
dojo.removeClass(this.domNode,"selectedTab");
this._tabTitle.tabIndex="-1";
}
this.setEditMode(this.editing);
},setEditMode:function(_9){
this.editing=_9;
this.setTitle();
if(_9&&!this.selected){
if(!this._tabTarget){
this._tabTarget=new _1(this.domNode,{accept:["widget"],index:this.index,dashboardContainer:this.dashboardContainer});
}
}else{
if(this._tabTarget){
this._tabTarget.destroy();
this._tabTarget=null;
}
}
},setTitle:function(_a){
if(!_a){
_a=this.tabTitle;
}
if(this.selected&&this.editing){
if(!this._editableTitle){
var _b=dojo.create("span",{"class":"editable-tab-title"},this._tabTitle,"only");
_b.appendChild(document.createTextNode(_a));
this._editableTitle=new dijit.InlineEditBox({title:_4.clickToEdit,autoSave:true,width:"200px",textDir:this.textDir,noValueIndicator:"?",editorParams:{maxLength:"60"},onChange:dojo.hitch(this,this._onTabTitleChange)},_b);
this._editableTitle.startup();
this._tabTitle.tabIndex="-1";
this._editableTitle.connect(this._editableTitle.domNode.parentNode,"onkeypress",_5);
this._editableTitle.connect(this._editableTitle.domNode.parentNode,"onmousedown",_5);
}
}else{
if(this._editableTitle){
this._editableTitle.destroy();
this._editableTitle=null;
}
this._tabTitle.innerHTML=_3.escape(_a);
dojo.setAttr(this._tabTitle,"data-content",_3.escape(_a));
}
this.tabTitle=_a;
},_registerSelectEvent:function(_c){
if(_c){
if(!this._selectTabHandle){
this._selectTabHandle=this.connect(this.domNode,"onclick",this._selectTabHandler);
}
}else{
this.disconnect(this._selectTabHandle);
this._selectTabHandle=null;
}
},_addTabDropDown:function(){
if(this._menuItemClickHandler){
this._removeTabDropDown();
}
dojo.addClass(this.domNode,"tabWithMenu");
var _d=dojo.string.substitute(this.messages.tabButtonName,[this.tabTitle]);
this._menuLink=new jazz.ui.toolbar.MenuButton({menuProvider:dojo.hitch(this,this._tabDropDownProvider),title:_d}).placeAt(this._menuWrapper,"only");
this._menuWrapper.style.display="block";
},_removeTabDropDown:function(){
if(this._menuLink){
this._menuLink.destroy();
delete this._menuLink;
dojo.removeClass(this.domNode,"tabWithMenu");
this._menuWrapper.style.display="none";
}
},_tabDropDownProvider:function(){
if(this._editableTitle&&this._editableTitle.editing){
this._editableTitle.save();
}
this._createTabDropDown();
return this._menu;
},_createTabDropDown:function(){
if(this._menu&&this._menuIsEditing!=this.editing){
this._menu.destroyRecursive();
this._menu=null;
}
if(!this._menu){
var _e=new jazz.ui.Menu();
dojo.addClass(_e.domNode,"com-ibm-team-dashboard-tab-menu");
if(this.editing){
_e.addChild(new dijit.MenuItem({label:_4.addViewletText,iconClass:"addIcon",onClick:dojo.hitch(this.dashboardContainer,this.dashboardContainer.openCatalog)}));
_e.addChild(new dijit.MenuSeparator());
_e.addChild(new dijit.MenuItem({label:_4.rename,iconClass:"renameIcon",onClick:dojo.hitch(this,this._renameTab)}));
}
_e.addChild(new dijit.MenuItem({label:_4.refresh,iconClass:"refreshIcon",onClick:dojo.hitch(this.dashboardContainer,this.dashboardContainer.refresh)}));
_e.addChild(new dijit.MenuSeparator());
_e.addChild(new dijit.MenuItem({label:_4.copyTab,iconClass:"copyTabIcon",onClick:dojo.hitch(this.dashboardContainer,this.dashboardContainer.copyTab)}));
if(this.editing){
_e.addChild(new dijit.MenuItem({label:_4.duplicateTab,iconClass:"duplicateTabIcon",onClick:dojo.hitch(this.dashboardContainer,this.dashboardContainer.duplicateTab)}));
this._menuDeleteItem=new dijit.MenuItem({label:_4.deleteText,iconClass:"deleteIcon",onClick:dojo.hitch(this,this._deleteTab)});
_e.addChild(this._menuDeleteItem);
_e.addChild(new dijit.MenuSeparator());
var _f=new jazz.ui.Menu();
dojo.addClass(_f.domNode,"com-ibm-team-dashboard-tab-menu");
_f.addChild(new dijit.MenuItem({label:_4.oneColumn,iconClass:"oneColumnIcon",onClick:dojo.hitch(this,this._changeLayout,"jazz.ensemble.layout.1column")}));
_f.addChild(new dijit.MenuItem({label:_4.twoColumns,iconClass:"twoColumnsIcon",onClick:dojo.hitch(this,this._changeLayout,"jazz.ensemble.layout.2column")}));
_f.addChild(new dijit.MenuItem({label:_4.threeColumns,iconClass:"threeColumnsIcon",onClick:dojo.hitch(this,this._changeLayout,"jazz.ensemble.layout.3column")}));
var _10=this._getColumnIconClass();
var _11=this._layoutMenuItem=new dijit.PopupMenuItem({label:_4.layout,iconClass:_10});
_11.popup=_f;
_e.addChild(_11);
}
_e.startup();
if(this.editing){
_11.startup();
_f.startup();
this._popupMenu=_11;
}
this._menu=_e;
this._menuIsEditing=this.editing;
}
if(this.editing){
this._menuDeleteItem.domNode.style.display=(this.draggableTabs.widgets.length>1)?"":"none";
}
},_onTabTitleChange:function(_12){
if(!_12){
return false;
}
this.tabTitle=_12;
this.page.setTitle(_12);
this.draggableTabs.propertyChanged(_2.PROPERTY_DASHBOARD);
this._editableTitle.displayNode.innerHTML="";
this._editableTitle.displayNode.appendChild(document.createTextNode(_12));
dojo.setAttr(this._tabTitle,"data-content",_3.escape(_12));
},destroy:function(){
if(this._editableTitle){
this._editableTitle.destroy();
delete this._editableTitle;
}
if(this._menuLink){
this._menuLink.destroy();
delete this._menuLink;
}
if(this._menu){
this._menu.destroyRecursive();
delete this._menu;
}
this.isDestroyed=true;
this.inherited(arguments);
},_selectTabHandler:function(_13){
_13.preventDefault();
if(dojo.hasClass(_13.currentTarget,"selectedTab")){
return;
}
if(this._editableTitle&&this._editableTitle.editing){
this._editableTitle.save();
}
for(var i=0;i<this.draggableTabs.widgets.length;i++){
if(_13.currentTarget==this.draggableTabs.widgets[i].domNode){
this.draggableTabs._selectTabAction(this.draggableTabs.widgets[i]);
break;
}
}
},_deleteTab:function(_14){
if(this.draggableTabs.remove(this.index)){
this.destroy();
}
},_renameTab:function(_15){
this._editableTitle._onClick(_15);
},_changeLayout:function(_16){
var _17=true;
if(this.dashboardContainer.getCurrentViewletPage().isEditing()){
var _18=_4.editingContentsGeneric+_4.willDiscard;
var _17=confirm(_18);
}
if(_17){
this.dashboardContainer.getCurrentViewletPage().setLayout(_16);
this.draggableTabs.propertyChanged(_2.PROPERTY_DASHBOARD);
var _19=this._getColumnIconClass();
this._layoutMenuItem.set("iconClass",_19);
}
},_getColumnIconClass:function(){
var _1a=this.page.getLayout();
switch(_1a.getType()){
case "jazz.ensemble.layout.1column":
return "oneColumnIcon";
case "jazz.ensemble.layout.2column":
return "twoColumnsIcon";
case "jazz.ensemble.layout.3column":
return "threeColumnsIcon";
}
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTabs");


















dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=jazz.ui.dnd.draggableManager();
var _2=com.ibm.team.dashboard.web.ui.internal.util.Observable;
var _3=com.ibm.team.dashboard.web.ui.internal.dnd.TabTarget;
var _4=jazz.util.html;
var _5=com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTab;
var _6;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTabs",[jazz.ui.dnd.DraggableContainer,_2],{constrainAvatar:"A",constructor:function(_7,_8){
this.avatarClass="draggableTabsAvatar";
dojo.addClass(_7,"draggableTabs");
this._disabled=false;
this.horizontal=true;
_6=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
this.parent=_8.parent;
this.dashboardBundle=_8.dashboardBundle;
this.dashboardResource=_8.dashboardResource;
this.dashboardContainer=_8.dashboardContainer;
this.setEditMode(_8.editing);
this._keypressEvent=dojo.connect(this.node,"onkeypress",this,this._handleKeypress);
},add:function(_9,_a){
_9=new _5({tabTitle:_a.title,tabId:_a.id,page:_a.page,draggableTabs:this,dashboardContainer:this.dashboardContainer,editing:this.editing,index:typeof _a.index==="number"?_a.index:this.widgets.length});
this.inherited(arguments);
},remove:function(_b){
if(this.widgets.length==1){
alert(_6.deleteLastTab);
return false;
}
var _c=this.widgets[_b];
if(!_c){
return false;
}
if(confirm(dojo.string.substitute(_6.deletingTabConfirm,[_c.tabTitle]))){
this.inherited(arguments);
this.dashboardContainer.deleteViewletPage(_b);
this._updateTargetIndices();
this.focusCurrentTab();
return true;
}else{
return false;
}
},move:function(_d,_e,_f){
try{
this.dashboardContainer.moveViewletPage(_d,_f);
}
catch(err){
console.error("New viewlet position could not be saved: "+err.message+" - Refreshing viewlet page.");
}
this.inherited(arguments);
this._updateTargetIndices();
},focusCurrentTab:function(){
if(this.selectedTab._editableTitle){
this.selectedTab._editableTitle.domNode.focus();
}else{
this.selectedTab._tabTitle.focus();
}
},_updateTargetIndices:function(){
for(var i=0;i<this.widgets.length;i++){
if(this.widgets[i]&&this.widgets[i]._tabTarget){
this.widgets[i]._tabTarget.index=i;
}
}
},destroy:function(){
dojo.disconnect(this._keypressEvent);
this.inherited(arguments);
},setEditMode:function(_10){
this.editing=_10;
this.setEnabled(this.dashboardBundle.permissions.addTab?_10:false);
for(var i=0;i<this.widgets.length;i++){
this.widgets[i].setEditMode(_10);
}
},startup:function(_11){
for(var i=0;i<this.widgets.length;i++){
if(this.widgets[i].tabId==_11){
this.selectTab(i);
return;
}
}
if(this.widgets[0]){
this.selectTab(0);
}
},selectTab:function(_12){
if(this.widgets[0]&&(!_12||_12>this.widgets.length)){
var tab=this.widgets[0];
}else{
var tab=this.widgets[_12];
}
tab.setSelected(true);
},onDndStart:function(){
jazz.ui.MenuPopup.closeAll();
this.inherited(arguments);
},onDndStop:function(_13){
if(_1.widget!=this.selectedTab){
dojo.removeClass(_1.widget.domNode,"selectedTab");
}
this.inherited(arguments);
},_selectTabAction:function(_14){
this.dashboardContainer.showViewletPage(_14.index);
this.dashboardContainer.propertyChanged("tab",_14.tabId);
},_handleKeypress:function(e){
if(dojo.isDescendant(e.target,this.selectedTab.domNode)==false){
return;
}
if(e.altKey){
return;
}
var k=dojo.keys;
switch(e.keyCode){
case k.LEFT_ARROW:
this._prevTab(e);
break;
case k.RIGHT_ARROW:
this._nextTab(e);
break;
}
},_prevTab:function(e){
var _15=this.selectedTab.index;
if(_15>0){
this._selectTabAction(this.widgets[_15-1]);
this.selectTab(_15-1);
this.focusCurrentTab();
}
},_nextTab:function(e){
var _16=this.selectedTab.index;
if(_16<this.widgets.length-1){
this._selectTabAction(this.widgets[_16+1]);
this.selectTab(_16+1);
this.focusCurrentTab();
}
}});
})();


;(function(){
dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.bindings");


var _1=jazz.ensemble.internal.util.bindings;
var _2={dc:"http://purl.org/dc/terms/",jdb:"http://jazz.net/xmlns/prod/jazz/dashboard/1.0/",jw:"http://jazz.net/xmlns/prod/jazz/widget/1.0/",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",xml:"http://www.w3.org/XML/1998/namespace"};
var _3={namespaces:_2,getName:["string","jdb:name","1"],getValue:["string","jdb:value","1"],setName:["string","jdb:name","1"],setValue:["string","jdb:value","1"]};
var _4={namespaces:_2,getAbout:["string","@rdf:about","1"],getItemId:["string","jdb:itemId","1"],getProcessArea:["string","jdb:processArea","1"],getProperties:[_3,"jdb:properties/jdb:Property","*"],getPropertiesParseType:["string","jdb:properties/@rdf:parseType","1"],getTitle:["string","dc:title","1"],getType:["string","dc:type","1"],getRelation:["string","dc:relation/@rdf:resource","1"],getPages:[_1.Page,"jw:pages/jw:Page","*"],getSource:["string","dc:source","1"],setProperties:[_3,"jdb:properties/jdb:Property","*"],setPropertiesParseType:["string","jdb:properties/@rdf:parseType","1"],setTitle:["string","dc:title","1"]};
com.ibm.team.dashboard.web.ui.internal.util.bindings={Dashboard:_4,Page:_1.Page};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker",null,{constructor:function(){
this._activeRequests=new Object();
this._currentRequestId=0;
},getActiveRequests:function(){
var _1=new Array();
for(var i in this._activeRequests){
_1.push(this._activeRequests[i]);
}
return _1;
},register:function(_2,_3){
var _4={_id:"req"+this._currentRequestId,_self:this,_doCallback:dojo.hitch(_3,_3.doCallback),_doErrorCallback:dojo.hitch(_3,_3.doErrorCallback),doCallback:function(_5){
delete this._self._activeRequests[this._id];
this._doCallback(_5);
},doErrorCallback:function(_6){
delete this._self._activeRequests[this._id];
this._doErrorCallback(_6);
}};
_3.doCallback=dojo.hitch(_4,_4.doCallback);
_3.doErrorCallback=dojo.hitch(_4,_4.doErrorCallback);
this._activeRequests[this._currentRequestId++]=_2;
},abortActiveRequests:function(){
for(var i in this._activeRequests){
this._activeRequests[i].abort();
}
}});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/CatalogDrawer.html", "<div class=\"com-ibm-team-dashboard-content-web-catalog-drawer\">		<div class=\"cbd-clear\"></div>		<div class=\"cbd-top-border\"></div>	<div class=\"cbd-top-section\">		<div class=\"cbd-corner cbd-top-left\"></div>		<div class=\"cbd-corner cbd-top-right\"></div>	</div>	<div class=\"cbd-middle-container\">		<div class=\"cbd-left-border\"></div>		<div class=\"cbd-right-border\"></div>		<div class=\"cbd-border-section\">			<div class=\"cbd-middle-section\">				<div dojoattachpoint=\"_catalog\" dojotype=\"${_catalogClass}\"></div>				<div class=\"cbd-close-button-site\">					<img src=\"${_blankGif}\" alt=\"${msg.close}\" title=\"${msg.close}\" tabindex=\"0\" dojoAttachPoint=\"_closeButton\" dojoattachevent=\"onclick: _onClickClose, onmouseover: _onMouseOverClose, onmouseout: _onMouseOutClose\"/>				</div>			</div>		</div>	</div>		<div class=\"cbd-bottom-section\">		<div class=\"cbd-corner cbd-bottom-left\"></div>		<div class=\"cbd-corner cbd-bottom-right\"></div>	</div>		<div class=\"cbd-bottom-border\"></div>		<div class=\"cbd-clear\"></div>	</div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.CatalogDrawer");










dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardCatalogMessages");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.internal.CatalogDrawer",[dijit._Widget,dijit._Templated],{onAddWidget:null,onCloseCatalog:null,templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/CatalogDrawer.html"),widgetsInTemplate:true,constructor:function(_1){
this.msg=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardCatalogMessages");
if(_1.catalogClass){
this._catalogClass=_1.catalogClass;
}else{
this._catalogClass="com.ibm.team.dashboard.web.ui.internal.catalog.DashboardCatalog";
}
},postCreate:function(){
this._catalog.set("onAddWidget",this.onAddWidget);
},_onClickClose:function(_2){
dojo.stopEvent(_2);
jazz.ui.MenuPopup.closeAll();
if(this.onCloseCatalog){
this.onCloseCatalog();
}
return true;
},_onMouseOverClose:function(_3){
dojo.stopEvent(_3);
dojo.addClass(this._closeButton,"hover");
return true;
},_onMouseOutClose:function(_4){
dojo.stopEvent(_4);
dojo.removeClass(this._closeButton,"hover");
return true;
}});
})();


;(function(){
dojo.provide("jazz.ensemble.internal.client.RestClient");






var _1=jazz.ensemble.internal.client.HttpConstants;
jazz.ensemble.internal.client.RestClient={HANDLE_AS_XML:"xml",headResource:function(_2,_3){
var _4=new dojo.Deferred();
var _5={url:_2,load:function(_6,_7){
var _8=_7.xhr;
var _9={contentType:_8.getResponseHeader(_1.CONTENT_TYPE),eTag:_8.getResponseHeader(_1.ETAG),lastModified:_8.getResponseHeader(_1.LAST_MODIFIED),lastModifiedUser:_8.getResponseHeader(_1.LAST_MODIFIED_USER),lastModifiedXsd:_8.getResponseHeader(_1.LAST_MODIFIED_XSD),securityContext:_8.getResponseHeader(_1.SECURITY_CONTEXT_HEADER),url:_2};
_4.callback(_9);
},error:function(e){
_4.errback(e);
}};
if(_3){
_5.headers=_3;
}
jazz.client.xhrHead(_5);
return _4;
},deleteResource:function(_a){
var _b=new dojo.Deferred();
var _c={url:_a,load:function(_d,_e){
_b.callback();
},error:function(e){
_b.errback(e);
}};
jazz.client.xhrDelete(_c);
return _b;
},getResource:function(_f,_10,_11){
var dfd=new dojo.Deferred();
var _12={url:_f,handleAs:_10,load:function(_13,_14){
var xhr=_14.xhr;
var _15={content:_13,contentType:xhr.getResponseHeader(_1.CONTENT_TYPE),eTag:xhr.getResponseHeader(_1.ETAG),lastModified:xhr.getResponseHeader(_1.LAST_MODIFIED),lastModifiedUser:xhr.getResponseHeader(_1.LAST_MODIFIED_USER),lastModifiedXsd:xhr.getResponseHeader(_1.LAST_MODIFIED_XSD),securityContext:xhr.getResponseHeader(_1.SECURITY_CONTEXT_HEADER),url:_f};
dfd.callback(_15);
},error:function(e){
dfd.errback(e);
}};
if(_11){
_12.headers=_11;
}
jazz.client.xhrGet(_12);
return dfd;
},putResource:function(_16){
var _17=dojox.xml.parser.innerXML(_16.content);
var dfd=new dojo.Deferred();
var _18={url:_16.url,headers:_19(_16),putData:_17,load:function(_1a,_1b){
var xhr=_1b.xhr;
dojo.mixin(_16,{eTag:xhr.getResponseHeader(_1.ETAG),lastModified:xhr.getResponseHeader(_1.LAST_MODIFIED),lastModifiedUser:xhr.getResponseHeader(_1.LAST_MODIFIED_USER),lastModifiedXsd:xhr.getResponseHeader(_1.LAST_MODIFIED_XSD)});
dfd.callback(_16);
},error:function(e,_1c){
if(_1c&&dojo.isObject(e)){
var xhr=_1c.xhr;
if(xhr){
var _1d=xhr.statusText;
if(_1d){
e.statusText=_1d;
}
}
}
dfd.errback(e);
}};
jazz.client.xhrPut(_18);
return dfd;
}};
function _19(_1e){
var _1f={};
_1f[_1.CONTENT_TYPE]=_1e.contentType;
if(_1e.eTag){
_1f[_1.IF_MATCH]=_1e.eTag;
}
if(_1e.lastModified){
_1f[_1.IF_UNMODIFIED_SINCE]=_1e.lastModified;
}
if(_1e.securityContext){
_1f[_1.SECURITY_CONTEXT_HEADER]=_1e.securityContext;
}
return _1f;
};
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/DashboardContainer.html", "<div class=\"com-ibm-team-dashboard-content\">	<div class=\"meta-area\">		<div dojoattachpoint=\"metaNav\"></div>		<div class=\"com-ibm-team-dashboard-tabs\" dojoattachpoint=\"_tabWrapper\">			<div class=\"tabArea\" dojoattachpoint=\"_tabArea\">				<div class=\"tabs\" dojoattachpoint=\"_tabs\"></div>				<div class=\"options\">					<a class=\"tab\" href=\"#\" style=\"display: none\" dojoattachpoint=\"_catalogLink\" dojoattachevent=\"onclick: _toggleCatalog\" title=\"${messages.addViewletText}\"><span class=\"tabInnerDiv\"><span class=\"tabTitle\"><img src=\"${_blankGif}\" class=\"add-widget-img j-mirror\" alt=\"\"><span class=\"add-widget-span\">${messages.addViewletText}</span></span></span></a>				</div>			</div>			<div class=\"left-curve\"></div>			<div class=\"right-curve\"></div>		</div>	</div>	<div class=\"add-viewlet-panel\" dojoAttachPoint=\"_catalogDrawerSite\" style=\"display: none\">		<div class=\"content\" dojoAttachPoint=\"_catalogContent\"></div>	</div>	<div class=\"viewlet-page-wrapper\" dojoattachpoint=\"_viewletPageWrapper\"></div></div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.DashboardContainer");












































dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.util.bindings;
var _2=jazz.util.binding;
var _3=jazz.util.dom;
var _4=com.ibm.team.dashboard.web.ui.internal.Constants;
var _5=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _6=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _7=com.ibm.team.dashboard.web.ui.internal.DashboardInitializationData;
var _8=jazz.ensemble.internal.LayoutFactory;
var _9=com.ibm.team.dashboard.web.ui.internal.dnd.DraggableTabs;
var _a=com.ibm.team.dashboard.web.ui.internal.CatalogDrawer;
var _b=jazz.ensemble.internal.client.RestClient;
var _c=com.ibm.team.dashboard.web.util.internal.Util;
var _d=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _e=com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker;
var _f=com.ibm.team.dashboard.web.ui.internal.ViewletPage;
var _10=60000;
var _11=_10*2;
var _12;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.DashboardContainer",[com.ibm.team.dashboard.web.ui.internal.util.Observable,dijit._Widget,dijit._Templated,dijit._Contained],{selectedTabId:null,catalogClass:null,allowDelete:true,allowSharing:false,allowSetDefault:false,autoSave:null,showBreadcrumbs:true,dashboardWidget:null,dashboardBundle:null,dashboardResource:null,editMode:null,onDirtyStateChange:function(_13){
},serviceTracker:new _e(),tabs:null,viewletPages:null,_dashboardActive:false,templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/DashboardContainer.html"),constructor:function(_14){
this.messages=_12=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
},postCreate:function(){
this.metaNav=new com.ibm.team.dashboard.web.ui.internal.MetaNav({dashboardContainer:this},this.metaNav);
},getTitle:function(){
if(this.dashboardResource){
return this.dashboardResource.binding.getTitle();
}
},getProperties:function(){
if(!this._properties&&this.dashboardResource){
var _15=this._properties={};
var _16=this.dashboardResource.binding.getProperties();
if(_16){
var len=_16.length;
for(var i=0;i<len;++i){
var _17=_16[i];
_15[_17.getName()]=_17.getValue();
}
}
}
return this._properties;
},setProperties:function(_18){
var _19=this.dashboardResource.binding.getPropertiesParseType();
if(_19!=="Collection"){
this.dashboardResource.binding.setPropertiesParseType("Collection");
}
var _1a=[];
for(var i in _18){
_1a.push({name:i,value:_18[i]||""});
}
this.dashboardResource.binding.setProperties(_1a);
this._properties=dojo.clone(_18);
this._onDashboardChange();
},setContent:function(_1b){
this.dashboardBundle=_1b;
this.dashboardResource=_1b.dashboard;
this.viewletPages=[];
this._dashboardActive=true;
if(this.dashboardBundle.permissions.modify){
if(this.isPrivateContributorDashboard()&&this.autoSave!==false){
this.editMode=_4.EDIT_AUTO_SAVE;
this.autoSave=true;
}else{
this.editMode=_4.EDIT_DEFERRED_SAVE;
this.autoSave=false;
}
}else{
this.editMode=_4.READ_ONLY;
this.autoSave=null;
}
setTimeout(dojo.hitch(this,this._setContent2),0);
},_setContent2:function(){
if(!this._isDestroyed){
this.metaNav.addListener(dojo.hitch(this,this._onDashboardChange),_4.PROPERTY_DASHBOARD);
this.metaNav.init({dashboardContainer:this,dashboardBundle:this.dashboardBundle,editMode:this.editMode,selectedTabId:this.selectedTabId,allowDelete:this.allowDelete,allowSharing:this.allowSharing,allowSetDefault:this.allowSetDefault,showBreadcrumbs:this.showBreadcrumbs});
var div=document.createElement("div");
this._tabs.appendChild(div);
this.tabs=new _9(div,{parent:this,accept:["tab"],dashboardContainer:this,dashboardBundle:this.dashboardBundle,dashboardResource:this.dashboardResource,editing:this.isEditable()});
this.tabs.addListener(dojo.hitch(this,this._onDashboardChange),_4.PROPERTY_DASHBOARD);
var _1c=this.dashboardResource.binding.getPages();
for(var i=0;i<_1c.length;i++){
var _1d=_1c[i];
var id=_1d.getId();
this.tabs.add(null,{title:_1d.getTitle(),id:id,index:i,page:_1d,type:"tab"});
}
this._tabWrapper.style.display="block";
this.tabs.startup(this.selectedTabId);
this.setEditMode(this.editMode,true);
var _1e=this.tabs.selectedTab;
this.showViewletPage(_1e.index);
this.isInitialized=true;
if(this.dashboardBundle.revision){
var _1f=this.dashboardBundle.dashboard;
var _20="Revision: "+(_1f.lastModified||this.dashboardBundle.revision);
var _21=_1f.lastModifiedUser;
if(_21){
var _22=_21.lastIndexOf("/");
_20+=" ("+(_22==-1?_21:_21.substring(_22+1))+")";
}
this.metaNav.showMessage({type:jazz.ui.MessageBox.STATUS_TYPES.INFO,summary:_20,closable:true});
}
}
},isUnsaved:function(){
return this._saveInTransit||this.isDirty()||this._isEditingContents();
},isDirty:function(){
return this._isDirty?true:false;
},isEditable:function(){
return (this.editMode==_4.EDIT_AUTO_SAVE||this.editMode==_4.EDIT_DEFERRED_SAVE);
},isPrivateContributorDashboard:function(){
var _23=_7.getAuthenticatedContributorUri();
return (this.dashboardBundle.scope==_5.SCOPE_CONTRIBUTOR&&this.dashboardResource.securityContext==_23);
},isVisible:function(){
return this.dashboardWidget.isVisible();
},handleOnBeforeUnload:function(){
if(this._saveInTransit){
if(this.autoSave){
this._showSaveInProgressMessage(true);
}
return _12.navigateAwaySaveInProgressGeneric;
}else{
if(!this.autoSave&&this.isDirty()){
return _12.unsavedChangesGeneric;
}else{
if(this._isEditingContents()){
return _12.editingContentsGeneric;
}
}
}
return false;
},promptNavigateAway:function(){
if(this.deleted){
return true;
}
var _24=this._dashboardActive;
var _25=_24?_12.navigateAwayPrefixDashboards:_12.navigateAwayPrefixGeneric;
if(this._saveInTransit){
if(this.autoSave){
this._showSaveInProgressMessage(true);
}
_25+=(_24?_12.navigateAwaySaveInProgressDashboards:_12.navigateAwaySaveInProgressGeneric)+_12.mayDiscard;
var _26=_12.navigateAwaySuffixSaveInProgress;
}else{
if(!this.autoSave&&this.isDirty()){
_25+=_24?_12.unsavedChangesDashboards:_12.unsavedChangesGeneric;
}else{
if(this._isEditingContents()){
_25+=_24?_12.editingContentsDashboards:_12.editingContentsGeneric;
}
}
_25+=_12.willDiscard;
_26=_12.navigateAwaySuffixUnsaved;
}
_25+=_24?_12.navigateAwaySuffixDashboards:_26;
return confirm(_25);
},_toggleCatalog:function(_27){
if(_27){
dojo.stopEvent(_27);
}
if(this._catalogExpanded){
this.closeCatalog();
}else{
this.openCatalog();
}
},openCatalog:function(_28){
if(_28){
dojo.stopEvent(_28);
}
if(this._catalogExpanded&&this._catalogDrawerSite.style.display!="none"){
return;
}
this._createCatalog();
this._catalogExpanded=true;
dojo.fx.wipeIn({node:this._catalogDrawerSite,duration:200}).play();
this._selectCatalogLink();
},closeCatalog:function(){
if(!this._catalogExpanded){
return;
}
this._catalogExpanded=false;
dojo.fx.wipeOut({node:this._catalogDrawerSite,duration:200,onEnd:dojo.hitch(this,this._afterCatalogWipeOutAnimation)}).play();
},_createCatalog:function(){
if(this._catalogContent.hasChildNodes()){
return;
}
this._catalogDrawer=new _a({onAddWidget:dojo.hitch(this,this._addWidgetToTab),onCloseCatalog:dojo.hitch(this,this.closeCatalog),catalogClass:this.catalogClass});
this._catalogContent.appendChild(this._catalogDrawer.domNode);
},_addWidgetToTab:function(_29){
var _2a=this.getCurrentViewletPage();
if(!_2a){
return;
}
_2a.addWidget(_29);
},_afterCatalogWipeOutAnimation:function(){
this._showCatalogLink();
},_selectCatalogLink:function(){
dojo.addClass(this._catalogLink,"emphasis");
},_showCatalogLink:function(){
this._catalogLink.style.display="";
dojo.removeClass(this._catalogLink,"emphasis");
},_hideCatalogLink:function(){
this._catalogLink.style.display="none";
},refresh:function(_2b){
if(_2b){
dojo.stopEvent(_2b);
}
if(this.isDirty()&&!confirm(_12.confirm)){
return;
}
if(this.errorState||!this.dashboardResource||this.isDirty()){
this.onDirtyStateChange(false);
}
this.reload();
},reload:function(){
var _2c=_c.getDashboardParams(this.dashboardBundle,this.selectedTabId,this.dashboardWidget.projectArea);
_2c.force=true;
this.dashboardWidget.viewDashboard(_2c,this.dashboardWidget.projectArea);
},duplicateTab:function(_2d){
if(_2d){
dojo.stopEvent(_2d);
}
this.handleCloneTab(false);
},copyTab:function(_2e){
if(_2e){
dojo.stopEvent(_2e);
}
this.handleCloneTab(true);
},handleCloneTab:function(_2f){
if(this.currentPage){
var _30=this.currentPage.page.elem;
if(_2f){
try{
localStorage["net-jazz-ajax-clipboard"]=dojox.xml.parser.innerXML(_30);
}
catch(e){
alert(_12.featureNotSupported);
}
}else{
var _31=_30.cloneNode(true);
var _32=dojo.indexOf(this.viewletPages,this.currentPage);
this.addPage(_31,_32+1);
}
}
},saveDashboard:function(){
if(this._saveInTransit){
this._savePending=true;
}else{
if(!this.autoSave){
this._showSaveInProgressMessage(true);
}
this._doSave();
}
},setActive:function(_33){
this._dashboardActive=_33;
if(this._blockerDiv){
this._blockerDiv.style.display=_33?"block":"none";
}
if(this.zoomDiv){
this.zoomDiv.style.display=_33?"block":"none";
}
if(this.currentPage){
this.currentPage.setActive(_33);
}
},setDirty:function(_34){
if(typeof _34=="undefined"){
_34=true;
}
this._isDirty=_34;
this.metaNav.setDirty(_34);
if(_34&&!this.autoSave&&!this._stalenessCheckInterval){
this._stalenessCheckInterval=setInterval(dojo.hitch(this,this._checkStaleness),_11);
}
this.onDirtyStateChange(_34);
},setEditMode:function(_35,_36){
this.editMode=_35;
if(this.isEditable()){
this.autoSave=(_35==_4.EDIT_AUTO_SAVE)?true:false;
if(this.dashboardBundle&&this.dashboardBundle.permissions.addTab){
this._createNewTabLink();
}
this._showCatalogLink();
this._adjustNewTabLink();
if(!_36){
this.tabs.setEditMode(true);
}
}else{
this._removeNewTabLink();
this._hideCatalogLink();
if(!_36){
this.tabs.setEditMode(false);
}
}
if(!_36){
this.metaNav.setEditMode(_35);
var _37=this.viewletPages;
if(_37){
for(var i=0;i<_37.length;i++){
if(_37[i]){
_37[i].setEditMode(this.isEditable());
}
}
}
}
},addPage:function(_38,_39){
var _3a=_2.bind(_38,_1.Page);
this.doCreateViewletPage(_3a,_39,true);
},createViewletPage:function(_3b){
if(_3b){
dojo.stopEvent(_3b);
}
var _3c=this.dashboardResource.binding;
var _3d=_3c.getPages();
_3d.push({title:_12.newTab,widgets:[],widgetsParseType:"Collection"});
var _3e=_3d[_3d.length-1];
_8.addDefaultLayout(_3e);
this.doCreateViewletPage(_3e,false);
},doCreateViewletPage:function(_3f,_40,add){
if(typeof _40!=="number"){
_40=this.tabs.widgets.length;
}
if(add){
var _41=this.dashboardResource.binding;
var _42=_41.getPages();
_42.splice(_40,0,_3f);
_43(_3f.elem);
}
_3f.setId(null);
_3f.setId(this._generatePageId());
this.viewletPages.splice(_40,0,null);
this._onDashboardChange();
this.tabs.add(null,{title:_3f.getTitle(),id:_3f.getId(),index:_40,page:_3f,type:"tab"});
this.tabs._selectTabAction(this.tabs.widgets[_40]);
this.tabs.focusCurrentTab();
},deleteViewletPage:function(_44){
if(this.viewletPages[_44]){
this.viewletPages[_44].destroy();
}
this.viewletPages.splice(_44,1);
var _45=this.dashboardResource.binding;
var _46=_45.getPages();
_46.splice(_44,1);
this._onDashboardChange();
this.showViewletPage(0);
},fireDashboardChange:function(){
this._onDashboardChange();
},moveViewletPage:function(_47,_48){
var _49=this.viewletPages[_47];
this.viewletPages.splice(_47,1);
if(_48<this.viewletPages.length){
this.viewletPages.splice(_48,0,_49);
}else{
this.viewletPages[_48]=_49;
}
var _4a=this.dashboardResource.binding;
var _4b=_4a.getPages();
var _4c=_4b.splice(_47,1)[0];
_4b.splice(_48,0,_4c);
this._onDashboardChange();
},isPageActive:function(_4d){
return this._dashboardActive&&_4d==this.selectedTabId;
},refreshCurrentTab:function(){
this.setPageDirty(this.tabs.selectedTab.index);
this.showViewletPage(this.tabs.selectedTab.index);
},restoreDashboard:function(){
var _4e=jazz.app.context.get().itemId;
var srh=new _d(this,"_restoreDashboard2","_logError");
_6.restoreDashboard(this.dashboardResource.url,_4e,this.dashboardBundle.scope,this.dashboardBundle.scopeItem.itemId,srh,this.serviceTracker);
},_restoreDashboard2:function(_4f){
if(_4f.status=="OK"){
this.propertyChanged("title",_4f.msg);
this.reload();
}else{
alert(dojo.string.substitute(_12.restoreError,[_4f.msg]));
}
},setPageDirty:function(_50){
if(this.viewletPages&&this.viewletPages[_50]){
this.viewletPages[_50].dirty=true;
}
},showViewletPage:function(_51){
var _52=false;
var vp=this.viewletPages[_51];
this.tabs.selectTab(_51);
if(this.currentPage&&this.currentPage!=this.viewletPages[_51]){
this.currentPage.setActive(false);
if(this.currentPage.domNode){
this.currentPage.domNode.style.display="none";
}
}
if(!vp||vp.dirty){
if(vp&&vp.destroyRendering){
vp.destroyRendering();
}
this._viewletPageWrapper.appendChild(this._createViewletPage(this.tabs.widgets[_51].page,_51).domNode);
_52=true;
}else{
vp.domNode.style.display="";
}
this.currentPage=this.viewletPages[_51];
this.selectedTabId=this.currentPage.pageId;
if(_52){
this.currentPage.init();
}
},showViewletPageById:function(_53){
var _54=this.dashboardResource.binding.getPages();
for(var i=0;i<_54.length;i++){
if(_54[i]&&_54[i].getId()===_53){
this.showViewletPage(i);
break;
}
}
},_createViewletPage:function(_55,_56){
if(this.viewletPages[_56]){
this.viewletPages[_56].destroy();
}
this.viewletPages[_56]=new _f({page:_55,pageId:_55.getId(),dashboardBundle:this.dashboardBundle,dashboardContainer:this});
this.viewletPages[_56].addListener(dojo.hitch(this,this._onDashboardChange),_4.PROPERTY_DASHBOARD);
return this.viewletPages[_56];
},_doSave:function(){
this.metaNav._refreshButton.set("enabled",false);
this._saveInTransit=true;
var dfd=_b.putResource(this.dashboardResource);
dfd.addCallback(dojo.hitch(this,this._handleSave));
dfd.addErrback(dojo.hitch(this,this._handleSaveError));
if(this._stalenessCheckInterval){
clearInterval(this._stalenessCheckInterval);
delete this._stalenessCheckInterval;
}
},destroy:function(){
this._isDestroyed=true;
if(this._serviceTracker){
this._serviceTracker.abortActiveRequests();
}
if(this._yieldTimeout){
clearTimeout(this._yieldTimeout);
delete this._yieldTimeout;
}
if(this._stalenessCheckInterval){
clearInterval(this._stalenessCheckInterval);
delete this._stalenessCheckInterval;
}
if(this._currentTab){
this._currentTab.destroy();
}
if(this.viewletPages){
for(var i=0;i<this.viewletPages.length;i++){
if(this.viewletPages[i]){
this.viewletPages[i].destroy();
this.viewletPages[i]=null;
}
}
}
if(this._hideTimeout){
delete this._hideTimeout;
}
if(this.metaNav){
this.metaNav.destroy();
}
if(this.tabs){
this.tabs.destroy();
}
if(this._catalogDrawer){
this._catalogDrawer.destroy();
this._catalogDrawer=null;
}
this.inherited(arguments);
this._isDestroyed=true;
},_isEditingContents:function(){
var _57=this.viewletPages;
if(_57){
for(var i=0;i<_57.length;i++){
if(_57[i]&&_57[i].isEditing()){
return true;
}
}
}
return false;
},_empty:function(){
},_logError:function(_58){
console.error("DashboardContainer.js remote error: "+_58.message);
},_handleSave:function(obj){
this._saveInTransit=false;
if(this._savePending){
this._savePending=false;
this._doSave();
}else{
if(this.showSaveNotification||!this.autoSave){
this.metaNav.showMessage({type:jazz.ui.MessageBox.STATUS_TYPES.OK,summary:_12.saveComplete,closable:true});
if(this._hideTimeout){
clearTimeout(this._hideTimeout);
delete this._hideTimeout;
}
this._hideTimeout=setTimeout(dojo.hitch(this,"_hideSavedNotification"),5000);
}
this.propertyChanged("onsave");
}
this.metaNav._refreshButton.set("enabled",true);
return obj;
},_hideSavedNotification:function(){
this.showSaveNotification=false;
if(this.metaNav){
this.metaNav.hideMessage(true);
}
},_handleSaveError:function(_59){
dojo.publish(_4.serverError,[_59]);
this._logError(_59);
this._saveInTransit=false;
this.metaNav._refreshButton.set("enabled",true);
},_generatePageId:function(){
var _5a=this.dashboardResource.binding.getPages();
var max=1;
var len=_5a.length;
for(var i=0;i<len;++i){
var id=_5a[i].getId();
if(id&&id.length>1){
try{
var num=parseInt(id.substring(1));
if(num>max){
max=num;
}
}
catch(e){
}
}
}
return "_"+(max+1);
},_onDashboardChange:function(){
if(this._staleDashboardWarning){
this._displayConcurrentModificationError();
if(this._stalenessCheckInterval){
clearInterval(this._stalenessCheckInterval);
delete this._stalenessCheckInterval;
}
return;
}
if(this.autoSave){
this.saveDashboard();
}else{
this.setDirty(true);
}
},_refresh:function(){
if(this.viewletPages){
for(var i=0;i<this.viewletPages.length;i++){
this.setPageDirty(i);
}
}
this.refreshCurrentTab();
},_createNewTabLink:function(){
if(!this._newTabLink){
var _5b=document.createElement("a");
_5b.className="add-new-tab";
_5b.href="#";
_5b.title=_12.addNewTab;
var _5c=document.createElement("img");
_5c.src=this._blankGif;
_5c.alt=_12.addNewTab;
_5b.appendChild(_5c);
this._tabs.firstChild.appendChild(_5b);
this._newTabLinkEvent=this.connect(_5b,"onclick",this.createViewletPage);
this._newTabLink=_5b;
}
},_adjustNewTabLink:function(){
var _5d=dojo.position(this._catalogLink).w-4;
this._newTabLink.style.marginRight=Math.max(_5d,88)+"px";
},_removeNewTabLink:function(){
if(this._newTabLink&&this._newTabLink.parentNode){
this.disconnect(this.newTabLinkEvent);
this._newTabLink.parentNode.removeChild(this._newTabLink);
this._newTabLink=null;
}
},_showFirebugWarning:function(){
if(this._firebugWarning){
return;
}
this._firebugWarning=true;
if(window.console&&window.console.firebug){
this.metaNav.showMessage({type:jazz.ui.MessageBox.STATUS_TYPES.WARNING,summary:this.messages.firebugWarning});
}
},_showBlockerDiv:function(_5e,_5f){
if(!this._blockerDiv){
this._blockerDiv=document.createElement("div");
this._blockerDiv.className="jazz-ui-Dialog-blockerDiv";
}
var de=document.documentElement;
var _60=de.clientHeight;
var _61=de.scrollHeight;
this._blockerDiv.style.height=((_61>_60)?_61:_60)+"px";
if(_5e==null){
_5e=0.06;
}
var _62={opacity:0,top:0,left:0};
_62.zIndex=_5f?_5f:0;
dojo.style(this._blockerDiv,_62);
var _63=dojo.byId("content-cell")||document.body;
_63.appendChild(this._blockerDiv);
if(_5e!==0){
var _64=dojo.animateProperty({node:this._blockerDiv,duration:280,properties:{opacity:{start:0,end:_5e}}});
_64.play();
}
},_hideBlockerDiv:function(){
if(this._blockerDiv&&this._blockerDiv.parentNode){
this._blockerDiv.parentNode.removeChild(this._blockerDiv);
}
},getCurrentViewletPage:function(){
if(!this.currentPage){
return null;
}
return this.currentPage;
},_showSaveInProgressMessage:function(_65){
this.metaNav.showMessage({type:jazz.ui.MessageBox.STATUS_TYPES.INFO,summary:_12.saveInProgress,closable:true});
this.showSaveNotification=_65;
},_checkStaleness:function(){
if(this.dashboardBundle.dashboardUrl){
var dfd=_b.headResource(this.dashboardBundle.dashboardUrl,{});
dfd.addCallback(dojo.hitch(this,this._handleDashboardHeadRequest));
dfd.addErrback(dojo.hitch(this,this._handleDashboardHeadError));
}
},_displayConcurrentModificationError:function(){
dojo.publish(_4.serverError,[{type:jazz.ui.MessageBox.STATUS_TYPES.ERROR,status:409,customMessage:_12.errorConcurrentModification,closeable:false}]);
},_handleDashboardHeadError:function(_66){
if(_66.status==0||_66.status==12029){
return;
}
if(_66.status==408||_66.status==504){
return;
}
if(this._stalenessCheckInterval){
clearInterval(this._stalenessCheckInterval);
delete this._stalenessCheckInterval;
}
},_handleDashboardHeadRequest:function(_67){
if(this._isDestroyed){
return;
}
if(this.dashboardResource.eTag!=_67.eTag){
if(this.isDirty()){
this._displayConcurrentModificationError();
}else{
dojo.publish(_4.serverError,[{type:jazz.ui.MessageBox.STATUS_TYPES.INFO,status:409,customMessage:_12.errorConcurrentModificationNonDirty,closeable:false}]);
this._staleDashboardWarning=true;
}
if(this._stalenessCheckInterval){
clearInterval(this._stalenessCheckInterval);
delete this._stalenessCheckInterval;
}
}
}});
function _43(_68,_69){
_69=_69||_68.parentNode;
var _6a=_68.attributes;
for(var i=0;i<_6a.length;++i){
var _6b=_6a[i];
if(_6b.prefix==="xmlns"&&_3.lookupNamespaceURI(_69,_6b.name.substring(6))===_6b.value){
_68.removeAttributeNode(_6b);
--i;
}
}
var _6c=_68.firstChild;
while(_6c){
_6c.nodeType===1&&_43(_6c,_69);
_6c=_6c.nextSibling;
}
};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.IMemento");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.IMemento",null,{get:function(_1){
},set:function(_2,_3){
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ContributorMemento");




(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.Constants;
var _2=com.ibm.team.dashboard.web.ui.IMemento;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ContributorMemento",_2,{constructor:function(_3,_4){
this._viewletInfo=_3;
this._container=_4;
if(_3.memento){
this._memento=dojo.fromJson(_3.memento);
}else{
this._memento=new Object();
}
},get:function(_5){
return this._memento[_5];
},set:function(_6,_7){
this._memento[_6]=_7;
this._viewletInfo.memento=dojo.toJson(this._memento);
this._container.propertyChanged(_1.PROPERTY_CONTRIBUTOR_INFO);
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ViewletMemento");




(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.Constants;
var _2=com.ibm.team.dashboard.web.ui.IMemento;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ViewletMemento",_2,{constructor:function(_3,_4,_5){
this._memento=_3;
this._container=_5;
this._viewletHelper=_4;
},startEditing:function(){
this._workingCopy=dojo.clone(this._memento);
},stopEditing:function(_6){
if(_6){
this._memento=this._workingCopy;
this._save();
}
delete this._workingCopy;
},_save:function(){
this._viewletHelper.memento=dojo.toJson(this._memento);
this._container.propertyChanged(_1.PROPERTY_DASHBOARD);
},get:function(_7){
var _8=this._workingCopy?this._workingCopy:this._memento;
if(_8[_7]){
return _8[_7];
}
return null;
},set:function(_9,_a){
var _b=this._workingCopy?this._workingCopy:this._memento;
_b[_9]=_a;
if(!this._workingCopy){
this._save();
}
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry");
(function(){
com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry={_namesByItemId:new Object(),addNames:function(_1){
for(var i=0;i<_1.length;i++){
this.addName(_1[i]);
}
},addName:function(_2){
this._namesByItemId[_2.itemId]=_2.name;
},getName:function(_3){
return this._namesByItemId[_3];
}};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.LegacyViewletSite");












(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.Constants;
var _2=com.ibm.team.dashboard.web.ui.internal.ContributorMemento;
var _3=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _4=com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry;
var _5=com.ibm.team.dashboard.web.util.internal.Util;
var _6=com.ibm.team.dashboard.web.ui.internal.ViewletMemento;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.LegacyViewletSite",null,{constructor:function(_7){
this._container=_7.container;
this._dashboardItem=_7.dashboardItem;
this._definition=_7.definition;
this._viewlet=_7.viewlet;
this._viewletHelper=_7.viewletHelper;
this._loading=false;
},addMenuItem:function(_8,_9,_a){
var _b={label:_8,onClick:dojo.hitch(this._container._viewlet,_a)};
if(_9){
_9=_9+"";
if(_9.indexOf("/")!=-1){
_b.icon=_9;
}else{
dojo.deprecated("com.ibm.team.dashboard.web.ui.ViewletSite.addMenuItem(label, iconClass, callback)","Use an icon URL for the second parameter instead of a css class");
_b.iconClass=_9;
}
}
this._container.addMenuItem(_b);
},canViewDashboard:function(_c){
var _d=this._container.dashboardBundle.permissions;
if(_c==_3.SCOPE_PROJECT_AREA){
return _d.viewProject;
}
if(_c==_3.SCOPE_TEAM_AREA){
return _d.viewTeam;
}
if(_c==_3.SCOPE_CONTRIBUTOR){
return _d.viewPersonal;
}
return false;
},error:function(_e){
dojo.publish(_1.serverError,[_e]);
},getContributorState:function(){
if(!this._contributorMemento){
var _f=this._container._viewletContributorInfo;
this._contributorMemento=new _2(_f,this._container);
}
return this._contributorMemento;
},getPreference:function(id){
var _10=this._definition.preferenceDefinitions;
if(_10){
for(var i=0;i<_10.length;i++){
var _11=_10[i];
if(_11.id==id){
var _12;
var _13=this._viewletHelper.preferences;
if(_13){
for(var j=0;j<_13.length;j++){
if(_13[j].id==id){
_12=_13[j].value;
break;
}
}
}
if(_12||_12==false){
return this._cast(_12,_11.preferenceType);
}
if(_11.defaultValue){
return this._cast(_11.defaultValue,_11.preferenceType);
}
return null;
}
}
}
return null;
},getScope:function(){
var _14=this._viewletHelper.scope;
if(!this._definition.scopeSensitive||(_14!=_3.SCOPE_CONTRIBUTOR&&_14!=_3.SCOPE_TEAM_AREA&&_14!=_3.SCOPE_PROJECT_AREA)){
_14=this._dashboardItem.scope;
}
switch(this._definition.appliesTo){
case _1.SCOPE_APPLIES_TO_TEAMS:
return _3.SCOPE_TEAM_AREA;
case _1.SCOPE_APPLIES_TO_CONTRIBUTORS:
return _3.SCOPE_CONTRIBUTOR;
case _1.SCOPE_APPLIES_TO_PROJECTS:
return _3.SCOPE_PROJECT_AREA;
case _1.SCOPE_APPLIES_TO_PROCESS:
if(_14==_3.SCOPE_CONTRIBUTOR){
return _3.SCOPE_PROJECT_AREA;
}
}
return _14;
},getScopeItem:function(){
if(typeof (this._viewletHelper.scope)!="undefined"&&!_5.isScopeApplicible(this._viewletHelper.scope,this._definition)){
if(this._definition.scopeSensitive){
return null;
}
}
if(this._definition.scopeSensitive){
var _15=this._viewletHelper.scopeItem;
if(_15){
var _16=_4.getName(_15.itemId);
if(_16){
_15.name=_16;
}
return _15;
}
}
if(_5.isLocal(this._viewletHelper)){
return this._getDefaultItem(this.getScope());
}
return null;
},getScopeSubteams:function(){
var _17=this._viewletHelper.scopeSubteams;
if(!_17&&_17!=false){
_17=this._definition.scopeSubteams=="yes-and-check";
}
return _17;
},getViewletState:function(){
if(!this._viewletMemento){
var _18;
var _19=this._viewletHelper.memento;
if(_19){
_18=dojo.fromJson(_19);
}else{
_18=this._viewlet.getDefaultState();
}
this._viewletMemento=new _6(_18,this._viewletHelper,this._container);
}
return this._viewletMemento;
},setAutoRefresh:function(_1a){
this._container.setAutoRefresh(_1a);
},setIcon:function(url){
this._container.setIcon(url);
},setLoading:function(_1b){
if(this._container._iconImage){
if(_1b){
this._container._iconImage.style.display="none";
dojo.addClass(this._container._headerIcon,"com-ibm-team-dashboard-progressIcon");
}else{
this._container._iconImage.style.display="inline";
dojo.removeClass(this._container._headerIcon,"com-ibm-team-dashboard-progressIcon");
}
}
this._loading=_1b;
},isLoading:function(){
return this._loading;
},toggleSettings:function(){
this._container.toggleSettings();
},editContents:function(){
this._container.startEditing();
},setTitle:function(_1c,_1d){
if(!this._viewletHelper.userTitle){
this._container.setTitle(_1c,_1d);
}
},setSecondaryTitle:function(_1e){
this._container.setSecondaryTitle(_1e);
},getTitle:function(){
return this._viewletHelper.title;
},getSecondaryTitle:function(){
return this._container.getSecondaryTitle();
},getActionArea:function(){
return this._container.actionArea;
},isDashboardEditing:function(){
return this._container.editing;
},isActive:function(){
return this._container.viewletPage.isActive;
},getHeight:function(){
if(dojo.isIE==6){
return this._container._contentWrapper.clientHeight;
}else{
return dojo.style(this._container._contentWrapper,"height");
}
},getWidth:function(){
if(dojo.isIE==6){
var _1f=this._container._header.clientWidth-5;
if(_1f<0){
_1f=this._container._contentWrapper.clientWidth-40;
}
return _1f;
}else{
return dojo.style(this._container._contentWrapper,"width");
}
},doneRefresh:function(){
this._container.isRefreshing--;
if(this._container.isRefreshing<0){
this._container.isRefreshing=0;
}
},refresh:function(){
this._container.refreshViewlet(true);
},navigateAwayEvent:function(_20,_21){
return this._container.viewletPage.dashboardContainer.dashboardWidget.navigateAwayEvent(_20,_21);
},_cast:function(_22,_23){
if(_23=="INTEGER"){
var _24=parseInt(_22);
if(isNaN(_24)){
return null;
}
return _24;
}else{
if(_23=="BOOLEAN"){
if(_22==true||_22==false){
return _22;
}
return _22=="true"?true:false;
}
}
return _22;
},_getDefaultItem:function(_25){
if(this._container._isLocal()){
var _26=this._dashboardBundle.defaults;
switch(_25){
case _3.SCOPE_CONTRIBUTOR:
return _26.contributor;
case _3.SCOPE_TEAM_AREA:
return _26.team;
case _3.SCOPE_PROJECT_AREA:
return _26.project;
}
}
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.Viewlet");








(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.LegacyViewletSite;
var _2=com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker;
dojo.declare("com.ibm.team.dashboard.web.ui.Viewlet",[dijit._Widget,dijit._Templated],{constructor:function(_3){
this._viewletContainer=_3.container;
this._dashboardBundle=_3.dashboardBundle;
this._definition=_3.definition;
this._helper=_3.helper;
this._site=_3.site;
if(this._site){
this._site.viewlet=this;
}else{
this._site=new _1({container:_3.container,dashboardItem:_3.dashboardItem,definition:_3.definition,viewlet:this,viewletHelper:this._helper});
}
this._webURL=_3.webURL;
this._zoomed=false;
this._editing=false;
},destroy:function(){
this._isDestroyed=true;
if(this._serviceTracker){
var _4=this._serviceTracker.getActiveRequests();
for(var i=0;i<_4.length;i++){
_4[i].abort();
}
}
this.inherited(arguments);
},init:function(){
},isDestroyed:function(){
return this._isDestroyed?true:false;
},getSite:function(){
return this._site;
},getContributorState:function(){
return this._site.getContributorState();
},getServiceTracker:function(){
if(!this._serviceTracker){
this._serviceTracker=new _2();
}
return this._serviceTracker;
},getViewletState:function(){
return this._site.getViewletState();
},getWebURL:function(){
return this._webURL;
},hasContributorState:function(){
if(this._site.hasContributorState){
return this._site.hasContributorState();
}else{
return true;
}
},settingsAreaToggled:function(_5){
},preSaveState:function(){
},validateEditedContent:function(){
return true;
},getDefaultState:function(){
return new Object();
},getPreference:function(id){
return this._site.getPreference(id);
},setPreference:function(id,_6){
return this._site.setPreference(id,_6);
},getScope:function(){
return this._site.getScope();
},getScopeItem:function(){
return this._site.getScopeItem();
},getScopeSubteams:function(){
return this._site.getScopeSubteams();
},getTitleHyperlinkURL:function(){
return null;
},refresh:function(){
},update:function(){
},setZoomed:function(_7){
this._zoomed=_7;
this.update();
},isZoomed:function(){
return this._zoomed;
},preZoom:function(){
},postZoom:function(){
},setDashboardEditing:function(_8){
},setActive:function(_9){
},setEditing:function(_a){
this._editing=_a;
this.update();
},isEditing:function(){
return this._editing;
},hasZoomableContent:function(){
return true;
},getPreferenceOptions:function(_b,_c){
},getPreferenceProvider:function(_d){
return null;
},settingsChanged:function(_e,_f){
this._site.refresh();
},settingsCanceled:function(_10,_11){
},settingChanging:function(_12,_13){
return new Array();
}});
})();


;(function(){
dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.JPIMappingRegistry");


var _1=com.ibm.team.dashboard.web.util.internal.Util;
var _2=[false];
var _3=[false];
var _4=[];
var _5=[];
var _6="/dashboard-jpi-mappings";
var _7=_6+"/jpis";
var _8=_6+"/urls";
var _9=dojo.partial(_a,_4,_2,_7);
var _b=dojo.partial(_a,_5,_3,_8);
com.ibm.team.dashboard.web.ui.internal.util.JPIMappingRegistry={jpisToURLs:dojo.partial(_c,_5,_3,_b),urlsToJPIs:dojo.partial(_c,_4,_2,_9)};
function _c(_d,_e,_f,_10){
var len=_10.length;
for(var i=0;i<len;++i){
if(typeof (_10[i])!=="string"){
throw new Error("Invalid argument for JPI/URL conversion: must be of type string (but was "+typeof (_10[i])+")");
}
}
var dfd=new dojo.Deferred();
_d.push({dfd:dfd,uris:_10});
if(!_e[0]){
setTimeout(_f,0);
_e[0]=true;
}
return dfd;
};
function _a(_11,_12,_13){
var _14=_11.splice(0,_11.length);
_12[0]=false;
var _15=[];
var len=_14.length;
for(var i=0;i<len;++i){
_15.push.apply(_15,_14[i].uris);
}
jazz.client.xhrPost({url:_1.getServiceRoot()+_13,handleAs:"json",headers:{"Content-Type":"application/json"},postData:dojo.toJson(_15),load:function(_16){
var len=_14.length;
var _17=0;
for(var i=0;i<len;++i){
var _18=_14[i];
var num=_18.uris.length;
_18.dfd.callback(_16.slice(_17,_17+num));
_17+=num;
}
},error:function(e){
var len=_14.length;
for(var i=0;i<len;++i){
_14[i].dfd.errback(e);
}
}});
};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.MementoAdapter");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.internal.MementoAdapter",null,{obj:null,onStateChange:null,constructor:function(_1){
dojo.mixin(this,_1);
this.obj=dojo.clone(_1.obj);
},get:function(_2){
var _3=this._workingCopy||this.obj;
return _3[_2];
},getState:function(){
return dojo.clone(this.obj);
},set:function(_4,_5){
var _6=this._workingCopy||this.obj;
_6[_4]=_5;
if(!this._workingCopy){
this.onStateChange();
}
},startEditing:function(){
this._workingCopy=dojo.clone(this.obj);
},stopEditing:function(_7){
if(_7){
this.obj=this._workingCopy;
this.onStateChange();
}
delete this._workingCopy;
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ViewletSiteAdapter");












(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.Constants;
var _2=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _3=com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry;
var _4=com.ibm.team.dashboard.web.ui.internal.util.JPIMappingRegistry;
var _5=com.ibm.team.dashboard.web.ui.internal.MementoAdapter;
var _6=com.ibm.team.dashboard.web.util.internal.Util;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ViewletSiteAdapter",null,{context:null,viewletAdapter:null,viewletDefinition:null,_contributorMemento:null,_isTitleHyperlinkSet:false,_loading:false,_viewletMemento:null,constructor:function(_7){
dojo.mixin(this,_7);
this._container={dashboardBundle:{permissions:{modify:!this.context.readOnly}}};
},addMenuItem:function(_8,_9,_a){
var _b={label:_8,icon:_9,onClick:dojo.hitch(this.viewletAdapter.viewlet,_a)};
var _c=this.context.menuContributions.concat([_b]);
this.context.setMenuContributions(_c);
},canViewDashboard:function(_d){
return true;
},doneRefresh:function(){
if(this.viewletDefinition.titleAsHyperlink){
this.viewletAdapter.updateTitleURL();
}
},editContents:function(){
if(!this.viewletAdapter.readOnly){
this.viewletAdapter.handleEditContent();
}
},error:function(_e){
this.viewletAdapter.updateTitleURL();
this.viewletAdapter._showError(_e);
},getActionArea:function(){
return this.viewletAdapter.actionArea;
},getFilterBox:function(){
return this.viewletAdapter.filterPanel?this.viewletAdapter.filterPanel.filterBox:null;
},getContributorState:function(){
if(this.context.isShared()){
if(!this._contributorMemento){
this._contributorMemento=new _5({obj:{},onStateChange:function(){
}});
}
return this._contributorMemento;
}
return this.getViewletState();
},getDefaultItem:function(_f){
if(this.viewletAdapter.local){
var _10=this.context.properties["com.ibm.team.dashboard.defaults"];
if(_10){
switch(_f){
case _2.SCOPE_CONTRIBUTOR:
return _10.contributor;
case _2.SCOPE_TEAM_AREA:
return _10.team;
case _2.SCOPE_PROJECT_AREA:
return _10.project;
}
}
}
},getHeight:function(){
return this.viewletAdapter.getHeight();
},getPreference:function(id){
var _11=this.context.getPreferences();
var _12=(_11&&_11[id]);
var _13=this.viewletDefinition.preferenceDefinitions;
if(_13){
for(var i=0;i<_13.length;i++){
if(_13[i].id==id){
return _6._cast(_13[i].preferenceType,typeof _12!=="undefined"?_12:_13[i].defaultValue);
}
}
}
},isRemote:function(){
return !this.viewletAdapter.local;
},setPreference:function(id,_14){
if(id){
var _15=this.context.getPreferences();
_15[id]=_14;
this.context.setPreferences(_15);
}
},getScope:function(){
var _16=this.context.getPreferences();
var _17=_16&&_16["_scope"];
if(!this.viewletDefinition.scopeSensitive||(_17!=_2.SCOPE_CONTRIBUTOR&&_17!=_2.SCOPE_TEAM_AREA&&_17!=_2.SCOPE_PROJECT_AREA)){
_17=this.context.properties["com.ibm.team.dashboard.scope"];
}
switch(this.viewletDefinition.appliesTo){
case _1.SCOPE_APPLIES_TO_TEAMS:
return _2.SCOPE_TEAM_AREA;
case _1.SCOPE_APPLIES_TO_CONTRIBUTORS:
return _2.SCOPE_CONTRIBUTOR;
case _1.SCOPE_APPLIES_TO_PROJECTS:
return _2.SCOPE_PROJECT_AREA;
case _1.SCOPE_APPLIES_TO_PROCESS:
if(_17==_2.SCOPE_CONTRIBUTOR){
return _2.SCOPE_PROJECT_AREA;
}
}
return _17;
},getScopeItem:function(){
var _18=this.context.getPreferences();
var _19=_18&&_18["_scope"];
if(typeof (_19)!="undefined"&&!_6.isScopeApplicible(_19,this.viewletDefinition)){
if(this.viewletDefinition.scopeSensitive){
return null;
}
}
if(this.viewletDefinition.scopeSensitive){
var _1a=_18&&_18["_scopeItem"];
if(_1a){
var _1b={itemId:_1a};
var _1c=_3.getName(_1a);
if(_1c){
_1b.name=_1c;
}
return _1b;
}
}
if(this.viewletAdapter.local){
return this.getDefaultItem(this.getScope());
}
return null;
},getScopeSubteams:function(){
var _1d=this.context.getPreferences();
var _1e=(_1d&&_1d["_scopeSubteams"]);
if(!_1e){
return (this.viewletDefinition.scopeSubteams=="yes-and-check");
}
return _6._cast(_1.SettingsArea.FIELD_BOOLEAN,_1e);
},getSecondaryTitle:function(){
return this.context.getSecondaryTitle();
},getTitle:function(){
return this.context.getTitle();
},getViewletState:function(){
if(!this._viewletMemento){
var obj;
var _1f=this.context.getMemento();
if(typeof (_1f)=="string"){
var _20=this.viewletAdapter.getWindow();
obj=_20.dojo.fromJson(_1f);
}
this._viewletMemento=new _5({obj:obj||this.viewletAdapter.viewlet.getDefaultState(),onStateChange:dojo.hitch(this,function(){
this.context.setMemento(_6.toJson(this._viewletMemento.getState()));
})});
}
return this._viewletMemento;
},getWidth:function(){
return this.viewletAdapter.getWidth();
},hasContributorState:function(){
return !this.context.isShared();
},isActive:function(){
return this.viewletAdapter._active;
},isDashboardEditing:function(){
return !this.viewletAdapter.readOnly;
},isLoading:function(){
return this._loading;
},navigateAwayEvent:function(_21,_22){
return true;
},refresh:function(){
this.viewletAdapter.refresh();
},setAutoRefresh:function(_23){
this.viewletAdapter.setAutoRefresh(_23);
},setIcon:function(url){
this.context.setIcon(url);
},setLoading:function(_24){
this._loading=_24;
},setSecondaryTitle:function(_25){
this.context.setSecondaryTitle(_25);
this.viewletAdapter.updateTitleURL();
},setTitle:function(_26,_27){
this.context.setTitle(_26);
this.viewletAdapter.updateTitleURL();
},setTitleHyperlinkURL:function(url){
this.viewletAdapter.isTitleHyperlinkSet=true;
this.context.setTitleURL(url);
},toggleSettings:function(){
this.viewletAdapter.toggleSettings();
},jpisToURLs:function(_28){
return _4.jpisToURLs(_28);
},urlsToJPIs:function(_29){
return _4.urlsToJPIs(_29);
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.CustomPreferenceProvider");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.CustomPreferenceProvider",null,{getLabel:function(_1){
return null;
},getLoadingLabel:function(){
return "";
},createChooser:function(_2,_3,_4){
},createDOMChooser:function(_5,_6,_7,_8){
},save:function(){
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.settings.ScopePreferenceProvider");




















dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _2=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _3=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _4=com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry;
var _5=com.ibm.team.dashboard.web.ui.internal.Constants;
var _6=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
dojo.declare("com.ibm.team.dashboard.web.ui.internal.settings.ScopePreferenceProvider",com.ibm.team.dashboard.web.ui.CustomPreferenceProvider,{constructor:function(_7){
this._fetchingMap={};
this._appliesTo=_7.appliesTo;
this._preferenceId=_7.preferenceId||"scope";
},getLabel:function(_8){
var _9=this.getTextLabel(_8);
if(_9!=""){
return this._buildLabel(_9);
}
this._fetchLabel(_8);
return null;
},getTextLabel:function(_a){
if(!_a||!_a.type||!_a.itemId){
return _6.settingsScopeNone;
}
var _b=_4.getName(_a.itemId);
if(!_b){
return "";
}
if(this._appliesTo==_5.SCOPE_APPLIES_TO_PROCESS||this._appliesTo==_5.SCOPE_APPLIES_TO_ALL){
switch(_a.type){
case _3.SCOPE_PROJECT_AREA:
return dojo.string.substitute(_6.settingsScopeLabelProject,[_b]);
case _3.SCOPE_TEAM_AREA:
return dojo.string.substitute(_6.settingsScopeLabelTeam,[_b]);
case _3.SCOPE_CONTRIBUTOR_AREA:
return dojo.string.substitute(_6.settingsScopeLabelUser,[_b]);
}
}
return _b;
},getLoadingLabel:function(){
return this._buildLabel(_6.loading);
},_buildLabel:function(_c){
return "<input type='text' readonly='readonly' value='"+jazz.util.html.escape(_c).replace(/'/g,"&#39;")+"'/>";
},createChooser:function(_d,_e,_f){
var _10;
switch(this._appliesTo){
case _5.SCOPE_APPLIES_TO_CONTRIBUTORS:
_10={allowMultiple:false};
var div=dojo.create("div",null,dojo.body());
var _11=this;
jazz.core.loader.load_async("jazz.ui.react.ReactUserPickerWidget",function(){
var _12=new jazz.ui.react.ReactUserPickerWidget(_10,div);
dojo.connect(_12,"onSave",_11,function(_13){
_11.onContributorAdd(_13,_d);
});
_12.showDialog();
});
break;
case _5.SCOPE_APPLIES_TO_TEAMS:
case _5.SCOPE_APPLIES_TO_PROJECTS:
case _5.SCOPE_APPLIES_TO_PROCESS:
_10=this._createProcessChooser(_d,_e);
jazz.core.loader.load_async("com.ibm.team.process.web.ui.internal.ProcessAreaSelectionDialog",function(){
new com.ibm.team.process.web.ui.internal.ProcessAreaSelectionDialog(_10);
});
break;
case _5.SCOPE_APPLIES_TO_ALL:
_10=this._createAllChooser(_d,_e);
jazz.core.loader.load_async("com.ibm.team.dashboard.web.ui.internal.util.ScopeSelectionDialog",function(){
new com.ibm.team.dashboard.web.ui.internal.util.ScopeSelectionDialog(_10);
});
break;
}
},createDOMChooser:function(_14,_15,_16,_17){
var _18;
var _19=dojo.create("div");
var _1a=dojo.create("div",{className:"com-ibm-team-dashboard-ScopePreferenceProvider-loading",innerHTML:_6.loading},_19);
switch(this._appliesTo){
case _5.SCOPE_APPLIES_TO_CONTRIBUTORS:
_18={allowMultiple:false};
var div=dojo.create("div",null,dojo.body());
var _1b=this;
jazz.core.loader.load_async("jazz.ui.react.ReactUserPickerWidget",function(){
var _1c=new jazz.ui.react.ReactUserPickerWidget(_18,div);
dojo.connect(_1c,"onSave",_1b,function(_1d){
_1b.onContributorAdd(_1d,_14);
});
_1c.showDialog();
});
break;
case _5.SCOPE_APPLIES_TO_TEAMS:
case _5.SCOPE_APPLIES_TO_PROJECTS:
case _5.SCOPE_APPLIES_TO_PROCESS:
_18=this._createProcessChooser(_14,_15,_17);
jazz.core.loader.load_async("com.ibm.team.process.web.ui.internal.ProcessAreaSelectionDialog",function(){
var _1e=new com.ibm.team.process.web.ui.internal.ProcessAreaSelectionDialogContent(_18).placeAt(_19,"only");
_1e.init();
});
break;
case _5.SCOPE_APPLIES_TO_ALL:
_18=this._createAllChooser(_14,_15,_17);
jazz.core.loader.load_async("com.ibm.team.dashboard.web.ui.internal.util.ScopeSelectionDialog",function(){
var _1f=new com.ibm.team.dashboard.web.ui.internal.util.ScopeSelectionDialogContent(_18).placeAt(_19,"only");
_1f.init();
});
break;
}
return _19;
},onContributorAdd:function(_20,_21){
if(_20&&_20.length>0){
var c=_20[0];
var _22={type:_3.SCOPE_CONTRIBUTOR,itemId:c.itemId};
_4.addName(c);
_21(_22,this._preferenceId);
}
},_createProcessChooser:function(_23,_24,_25){
var _26=this._appliesTo==_5.SCOPE_APPLIES_TO_ALL||this._appliesTo==_5.SCOPE_APPLIES_TO_PROCESS;
var _27=this;
var _28={onCancel:_25,onOk:function(_29){
if(_29){
var _2a={type:_29.project?_3.SCOPE_PROJECT_AREA:_3.SCOPE_TEAM_AREA,itemId:_29.itemId};
_4.addName(_29);
_23(_2a,_27._preferenceId);
}
},teams:_26||this._appliesTo==_5.SCOPE_APPLIES_TO_TEAMS,projects:_26||this._appliesTo==_5.SCOPE_APPLIES_TO_PROJECTS,selection:_24.scopeItemId,applicationRootServicesUrl:net.jazz.ajax.BootstrapProperties.FRONTSIDE_URL+"/rootservices"};
return _28;
},_createAllChooser:function(_2b,_2c,_2d){
var _2e=this;
var _2f={onCancel:_2d,onOk:function(_30){
if(_30.user&&_30.user.length>0){
var c=_30.user[0];
var _31={type:_3.SCOPE_CONTRIBUTOR,itemId:c.itemId};
_4.addName(c);
_2b(_31,_2e._preferenceId);
}else{
if(_30.process){
var _32=_30.process;
var _31={type:_32.project?_3.SCOPE_PROJECT_AREA:_3.SCOPE_TEAM_AREA,itemId:_32.itemId};
_4.addName(_32);
_2b(_31,_2e._preferenceId);
}
}
},scope:_2c.scope,selection:_2c.scopeItemId};
return _2f;
},_fetchLabel:function(_33){
if(_33.itemId in this._fetchingMap){
return;
}
this._fetchingMap[_33.itemId]=true;
var _34=this;
var _35={_successCallback:function(_36){
_4.addName({itemId:_33.itemId,name:_36});
},_errorCallback:function(_37){
if(_37&&_37.status==403){
_4.addName({itemId:_33.itemId,name:_6.noPermissionName});
}else{
console.error(_37);
}
}};
var _38=new _2(_35,"_successCallback","_errorCallback");
_1.getItemName(_33.type,_33.itemId,null,_38);
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.FilterPanel");






dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=jazz.ensemble.internal.settings.SlideoutPanel;
var _2=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
dojo.declare("com.ibm.team.dashboard.web.ui.internal.util.FilterPanel",_1,{animate:false,postCreate:function(){
this.inherited(arguments);
var _3=dojo.create("div",{className:"com-ibm-team-dashboard-web-ui-internal-util-FilterPanel"},this.contentNode);
var _4=dojo.create("div",{className:"close-button-wrapper"},_3);
var _5=dojo.create("a",{href:"#",title:_2.close},_4);
dojo.create("span",{},_5);
this.connect(_5,"onclick",function(e){
e.preventDefault();
this.close();
});
this.filterBox=new jazz.ui.FilterBox({dwellTime:300});
_3.appendChild(this.filterBox.domNode);
},open:function(){
this.inherited(arguments);
this.filterBox.focus();
},close:function(){
this.inherited(arguments);
this.filterBox.clear();
this.filterBox.blur();
},uninitialize:function(){
this.filterBox.destroy();
}});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/util/IFrameContainer.html", "<div class=\"com-ibm-team-dashboard-web-ui-internal-util-IFrameContainer\">	<div dojoAttachPoint=\"_container\" class=\"not-loaded\">		<div class=\"loading\" dojoAttachPoint=\"_loadingDiv\">${_messages.loading}</div>		<div class=\"iframeDiv\" dojoAttachPoint=\"_iframeDiv\"></div>	</div></div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.IFrameContainer");












dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=jazz.util.ResizeNotifier;
var _2=com.ibm.team.dashboard.web.util.internal.Util;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.util.IFrameContainer",[dijit._Widget,dijit._Templated],{templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/util/IFrameContainer.html"),active:false,args:null,classIdentifier:null,onLoad:null,pageNode:null,serviceRoot:null,webUIRoot:null,context:null,loginTracker:null,_iframe:null,_inner:null,_proxiedWebUIRoot:null,_proxiedServiceRoot:null,constructor:function(){
this._messages=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
},postCreate:function(){
this._proxiedWebUIRoot=_2.getContextPath()+"/_iframeproxy/"+encodeURIComponent(encodeURIComponent(this.webUIRoot));
this._proxiedServiceRoot=_2.getContextPath()+"/_iframeproxy/"+encodeURIComponent(encodeURIComponent(this.serviceRoot));
this._iframe=document.createElement("iframe");
this._iframe.src=this._proxiedWebUIRoot+"/_ajax-modules/com.ibm.team.dashboard.web.iframe/"+this.classIdentifier+"?_proxyURL="+encodeURIComponent(this._proxiedWebUIRoot)+(djConfig.isDebug?"&debug="+djConfig.isDebug:"");
this._iframe.onCreate=dojo.hitch(this,this._onCreate);
this._iframe.frameBorder="0";
this._iframe.scrolling="no";
this._iframe.title=this._messages.iframeTitle;
this._iframe.allowTransparency="true";
this._iframeDiv.appendChild(this._iframe);
},uninitialize:function(){
if(this._updateFullPageHeightHandle){
_1.unregister(this._updateFullPageHeightHandle);
delete this._updateFullPageHeightHandle;
}
if(this._iframeHandle){
try{
dijit.unregisterIframe(this._iframeHandle);
delete this._iframeHandle;
}
catch(e){
}
}
},getIFrame:function(){
return this._iframe;
},getScopePreferenceProviderClass:function(){
return this._inner.getScopePreferenceProviderClass();
},setActive:function(_3){
if(_3!=this.active){
try{
this._inner.setActive(_3);
}
catch(e){
}
this.active=_3;
}
},_encodeProxiedURI:function(_4){
if(_4.indexOf(this.webUIRoot)==0){
return this._proxiedWebUIRoot+_4.substring(this.webUIRoot.length);
}
if(this.serviceRoot&&(_4.indexOf(this.serviceRoot)==0)){
return this._proxiedServiceRoot+_4.substring(this.serviceRoot.length);
}
var _5=new dojo._Url(location.href);
var _6=_5.path;
if(_6.length>0){
_6=_6.substring(0,_6.substring(1).indexOf("/")+2);
}
_5=_5.scheme+"://"+_5.authority+_6;
if(_4.indexOf(_5)===0){
return _4;
}
return jazz.app.proxy.encodeProxiedURI(_4);
},_onCreate:function(_7){
this._iframeHandle=dijit.registerIframe(this._iframe);
this._inner=_7;
if(this._unloadEvent){
dojo.disconnect(this._unloadEvent);
}
this._unloadEvent=dojo.connect(this._iframe.contentWindow,"onunload",this,function(){
if(this._iframeHandle){
dijit.unregisterIframe(this._iframeHandle);
delete this._iframeHandle;
}
dojo.disconnect(this._unloadEvent);
delete this._unloadEvent;
});
this._inner.init({active:this.active,args:this.args,credentialProvider:_8,encodeProxiedURI:dojo.hitch(this,this._encodeProxiedURI),onBustOut:dojo.hitch(this,this._onBustOut),onBustIn:dojo.hitch(this,this._onBustIn),onLoad:dojo.hitch(this,this._onLoad),onResize:dojo.hitch(this,this._onResize),serviceRoot:this.serviceRoot,webUIRoot:this.webUIRoot,context:this.context,loginTracker:this.loginTracker});
this._container.className="loaded";
},_onLoad:function(_9){
this.onLoad(_9);
},_onBustOut:function(){
var _a=this._iframeDiv;
var _b=dojo.marginBox(_a);
_a.style.width=_b.w+"px";
_a.style.height=_b.h+"px";
var _c=this._iframe.contentWindow.dojo.marginBox(this._inner.domNode);
this._inner.domNode.style.width=_c.w+"px";
this._inner.domNode.style.height=_c.h+"px";
this._iframe.style.zIndex="400";
this._updateFullPageSize();
this._overflowNodes=[];
this._bustedWidgets=[];
var _d=this._iframeDiv;
var _e;
while(_d){
if(!_e||_e==_d){
var _f=dijit.getEnclosingWidget(_d);
if(_f&&_f.bustOutHandler){
var _10=_f.bustOutHandler(true);
this._bustedWidgets.push(_f);
}
_e=_f.domNode.parentNode;
}
var _11=dojo.style(_d,"overflow");
var _12=dojo.style(_d,"overflowX");
var _13=dojo.style(_d,"overflowY");
if(_11!="visible"||_12!="visible"||_13!="visible"){
var _14={node:_d};
if(_11!="visible"){
_14.overflow=_d.style.overflow;
_d.style.overflow="visible";
}else{
if(_12!="visible"){
_14.overflowX=_d.style.overflowX;
_d.style.overflowX="visible";
}
if(_13!="visible"){
_14.overflowY=_d.style.overflowY;
_d.style.overflowY="visible";
}
}
this._overflowNodes.push(_14);
}
_d=_d.parentNode;
if((_10===true&&_f&&_d==_f.domNode)||(_d.parentNode&&_d.parentNode==this.pageNode)){
break;
}
}
this._updateFullPageHeightHandle=_1.register({context:this,callback:this._updateFullPageSize,force:true});
},_onBustIn:function(){
_1.unregister(this._updateFullPageHeightHandle);
delete this._updateFullPageHeightHandle;
for(i=0;i<this._overflowNodes.length;i++){
var _15=this._overflowNodes[i];
if(typeof _15.overflow!="undefined"){
_15.node.style.overflow=_15.overflow;
}
if(typeof _15.overflowX!="undefined"){
_15.node.style.overflowX=_15.overflowX;
}
if(typeof _15.overflowY!="undefined"){
_15.node.style.overflowY=_15.overflowY;
}
}
delete this._overflowNodes;
while(this._bustedWidgets.length){
this._bustedWidgets.pop().bustOutHandler(false);
}
delete this._bustedWidgets;
this._iframe.style.position="";
this._iframe.style.margin="";
this._iframe.style.width="";
this._iframe.style.height="";
this._iframe.style.zIndex="";
this._inner.domNode.style.width="100%";
this._inner.domNode.style.height="";
this._inner.domNode.style.padding="";
this._iframeDiv.style.width="";
},_onResize:function(_16){
this._iframeDiv.style.height=_16+"px";
},_updateFullPageSize:function(){
var v=dojo.marginBox(this._iframeDiv);
var v2=dojo.position(this._iframeDiv,true);
v.x=v2.x;
v.y=v2.y;
var p=dojo.marginBox(this.pageNode);
var p2=dojo.position(this.pageNode,true);
p.x=p2.x;
p.y=p2.y;
var vp=dijit.getViewport();
vp={l:0,t:0,w:vp.w,h:vp.h,x:vp.l,y:vp.t};
var _17=_18(v,_19(p,vp));
var top=v.y-_17.y;
var _1a=(_17.x+_17.w)-(v.x+v.w);
var _1b=(_17.y+_17.h)-(v.y+v.h);
var _1c=v.x-_17.x;
this._iframe.style.position="absolute";
this._iframe.style.margin=(-top)+"px "+(-_1a)+"px "+(-_1b)+"px "+(-_1c)+"px";
this._iframe.style.width=_17.w+"px";
this._iframe.style.height=_17.h+"px";
this._inner.domNode.style.padding=top+"px "+_1a+"px "+_1b+"px "+_1c+"px";
}});
var _1d;
var _8={getCredentials:function(_1e){
jazz.core.loader.load_async("jazz.app.internal.LoginDialog",function(){
if(!_1d){
_1d=new jazz.app.internal.LoginDialog();
}
_1d.getCredentials(_1e);
});
}};
function _19(_1f,_20){
var r=Math.min(_1f.x+_1f.w,_20.x+_20.w);
var b=Math.min(_1f.y+_1f.h,_20.y+_20.h);
var x=Math.max(_1f.x,_20.x);
var y=Math.max(_1f.y,_20.y);
return {x:x,y:y,w:r-x,h:b-y};
};
function _18(_21,_22){
var r=Math.max(_21.x+_21.w,_22.x+_22.w);
var b=Math.max(_21.y+_21.h,_22.y+_22.h);
var x=Math.min(_21.x,_22.x);
var y=Math.min(_21.y,_22.y);
return {x:x,y:y,w:r-x,h:b-y};
};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.ViewletRegistry");








(function(){
var _1=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _2=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _3=0;
var _4=[];
com.ibm.team.dashboard.web.ui.internal.util.ViewletRegistry={_deferredsByUrl:new Object(),getDefinition:function(_5,_6,_7,_8){
var _9=this._deferredsByUrl[_5];
if(!_9||!_9.success){
_9=_a(_5,_7,_8);
this._deferredsByUrl[_5]=_9;
}
_9.addCallback(function(_b){
_9.success=true;
_6.doCallback(_b);
return _b;
});
_9.addErrback(function(_c){
_6.doErrorCallback(_c);
return _c;
});
}};
function _d(_e){
if(!_e){
return null;
}else{
if(!_e.hasOwnProperty("soapenv:Body")){
return null;
}
}
var _f=_e["soapenv:Body"];
if(!_f.response){
return null;
}
var _10=_f.response;
if(!_10.returnValue){
return null;
}
var _11=_10.returnValue;
if(_11.values instanceof Array){
var _12=_11.values;
if(_12.length>0){
return _12[0];
}
return null;
}else{
if(_11.value){
return _11.value;
}
}
return null;
};
function _13(_14){
_3--;
if(_3>0){
var _15=new dojo.Deferred();
_4.push(function(){
_15.callback(_14);
});
return _15;
}else{
for(var k=0;k<_4.length;k++){
_4[k]();
}
_4=[];
}
};
function _16(_17,url){
if(!com.ibm.team.dashboard.web.util.internal.Util.isLocalDefinition(url)){
return;
}
_3++;
_17.addBoth(_13);
};
function _a(url,_18,_19){
if(_1a(url)){
return _1b(url,_18,_19);
}
return _1c(url,_18);
};
function _1c(url,_1d){
var _1e={url:url,headers:{"Accept":"text/json","X-com-ibm-team-configuration-versions":"LATEST","X-Jazz-CSRF-Prevent":dojo.cookie("JSESSIONID")},handleAs:"json"};
if(_1d){
_1e.skipInterceptors=["jazz.oauth"];
}
var _1f=jazz.client.xhrGet(_1e);
_16(_1f,url);
_1f.addCallback(function(_20){
return _d(_20);
});
return _1f;
};
function _1b(url,_21,_22){
var _23=new dojo.Deferred();
var _24={_deferred:_23,success:function(_25){
var _26=null;
if((_25 instanceof Array)&&(_25.length>0)){
_26=_25[0];
}
this._deferred.callback(_26);
},failure:function(_27){
if(!(_27 instanceof Error)){
var _28=_27;
_27=new Error();
dojo.mixin(_27,_28);
}
this._deferred.errback(_27);
}};
var srh=new _2(_24,"success","failure");
_1.getViewletDefinitions([url],null,_21,srh,_22);
return _23;
};
function _1a(url){
if(url.indexOf("g:")===0){
return true;
}else{
if(url.indexOf("i:")===0){
return true;
}
}
return false;
};
})();

dojo.provide("com.ibm.team.dashboard.web.ui.internal.nls.ViewletLoginMessages")._built=true;
dojo.provide("com.ibm.team.dashboard.web.ui.internal.nls.ViewletLoginMessages.en_us");
com.ibm.team.dashboard.web.ui.internal.nls.ViewletLoginMessages.en_us={"tryAgain":"Try Again","viewletLogin":"You must log into ${0} to view this content.","viewletLogin2":"Log In"};

;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/util/ViewletLogin.html", "<div class=\"com-ibm-team-dashboard-web-ui-internal-util-ViewletLogin\">	<div class=\"message\">		${_viewletLoginMessage}		<div class=\"link\">			<a href=\"#\" dojoattachpoint=\"_link\">${_viewletLoginMessage2}</a>		</div>	</div></div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.util.ViewletLogin");






dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","ViewletLoginMessages");
(function(){
dojo.declare("com.ibm.team.dashboard.web.ui.internal.util.ViewletLogin",[dijit._Widget,dijit._Templated],{webUIRoot:null,statusMessage:"",onLogin:null,templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/util/ViewletLogin.html"),constructor:function(_1){
this.messages=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","ViewletLoginMessages");
this.webUIRoot=_1.webUIRoot;
this.statusMessage=_1.statusMessage;
if(this.webUIRoot){
this._viewletLoginMessage=dojo.string.substitute(this.messages.viewletLogin,[this.webUIRoot]);
this._viewletLoginMessage2=this.messages.viewletLogin2;
}else{
this._viewletLoginMessage=this.statusMessage;
this._viewletLoginMessage2=this.messages.tryAgain;
}
},postCreate:function(){
this.inherited(arguments);
if(this.onLogin){
this.connect(this._link,"onclick",dojo.hitch(this,function(_2){
if(_2){
dojo.stopEvent(_2);
}
if(this.onLogin){
this.onLogin();
}
return true;
}));
}
},destroy:function(){
this.inherited(arguments);
}});
})();


;dojo.provide("jazz.ensemble.Widget");


(function(){
dojo.declare("jazz.ensemble.Widget",[dijit._Widget],{context:null,definition:null,onMove:function(){
},readOnly:false,uuid:null,refresh:function(){
},getDefaultTitle:function(){
return "";
},isDirty:function(){
return false;
}});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/ViewletAdapter.html", "<div class=\"com-ibm-team-dashboard-web-ui-ViewletAdapter\">	<div dojoAttachPoint=\"_settingsContainer\"></div>	<div dojoAttachPoint=\"_filterContainer\"></div>	<div dojoAttachPoint=\"_contentWrapper\">		<div class=\"bodyContainer\" dojoAttachPoint=\"_bodyContainer\"><div class=\"loading-text\" dojoAttachPoint=\"_loadingDiv\">${_messages.loading}</div></div>	</div>	<div class=\"edit-button-area\" dojoAttachPoint=\"_editButtonArea\" style=\"display: none\">		<div class=\"actions-area\" dojoAttachPoint=\"actionArea\"></div>		<div class=\"buttons\">			<input type=\"button\" value=\"${_messages.cancel}\" dojoAttachPoint=\"_cancelEdits\">			<input type=\"button\" value=\"${_messages.ok}\" dojoAttachPoint=\"_saveEdits\">		</div>	</div></div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ViewletAdapter");






































dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _2=com.ibm.team.dashboard.web.ui.internal.util.ErrorReport;
var _3=com.ibm.team.dashboard.web.ui.internal.util.IFrameContainer;
var _4=com.ibm.team.dashboard.web.ui.internal.util.ItemNameRegistry;
var _5=com.ibm.team.dashboard.web.ui.internal.util.Observable;
var _6=com.ibm.team.dashboard.web.ui.internal.settings.ScopePreferenceProvider;
var _7=com.ibm.team.dashboard.web.ui.internal.util.FilterPanel;
var _8=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _9=com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker;
var _a=com.ibm.team.dashboard.web.util.internal.Util;
var _b=com.ibm.team.dashboard.web.ui.Viewlet;
var _c=com.ibm.team.dashboard.web.ui.internal.util.ViewletRegistry;
var _d=com.ibm.team.dashboard.web.ui.internal.ViewletSiteAdapter;
var _e=jazz.ensemble.Widget;
var _f=com.ibm.team.dashboard.web.ui.internal.util.ViewletLogin;
var _10={getContributorState:true,getViewletState:true,hasContributorState:true,getPreference:true,getScope:true,getScopeItem:true,getScopeSubteams:true};
var _11=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
var _12;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ViewletAdapter",[_e,dijit._Templated],{templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/ViewletAdapter.html"),isTitleHyperlinkSet:false,local:null,viewlet:null,_animation:null,_messages:_11,_isDestroyed:false,_settingsPanel:null,_serviceRoot:null,_serviceTracker:null,_viewletDefinition:null,_webUIRoot:null,_yieldTimeout:null,constructor:function(_13){
var _14=_13.definition;
this._webUIRoot=_a.getWebUIRoot(_14);
this._serviceRoot=_a.getServiceRoot(_14);
this.local=_a.isLocalDefinition(_14);
},postCreate:function(){
this._icon=this.context.getIcon();
if(!this.local){
var _15=this.context.getToolbar();
if(_15){
var _16=this._webUIRoot;
this._shortOrigin=_16;
this._remoteIcon=_15.addWidget({domNode:dojo.create("div",{"class":"com-ibm-team-dashboard-web-ui-ViewletAdapter-remote-icon-disconnected",title:dojo.string.substitute(_11.disconnected,[_11.remoteServer,_16])})},{index:0});
}
}
this._loadingSettingsPanel=false;
this._yieldTimeout=setTimeout(dojo.hitch(this,this._loadViewlet,true),0);
},getDefaultTitle:function(){
if(this._viewletDefinition){
return this._viewletDefinition.name;
}
return this.inherited(arguments);
},getHeight:function(){
return dojo.style(this._contentWrapper,"height");
},getScopePreferenceProviderClass:function(){
if(this._iframeContainer){
return this._iframeContainer.getScopePreferenceProviderClass();
}
return _6;
},getWidth:function(){
return dojo.style(this._contentWrapper,"width");
},getWindow:function(){
if(this._iframeContainer){
var _17=this._iframeContainer.getIFrame();
if(_17){
return _17.contentWindow;
}
}
return window;
},handleEditContent:function(){
if(!this.viewlet.isEditing()){
this._startEditing();
}
},isDirty:function(){
return this.viewlet&&this.viewlet.isEditing();
},onShow:function(){
this._setActive(true);
},onHide:function(){
this._setActive(false);
},refresh:function(){
this.viewlet&&this.viewlet.refresh();
},setAutoRefresh:function(_18){
if(this._viewletDefinition.refreshInterval>0){
if(_18&&!this._refreshTimeout){
var _19=new Date().getTime()-this._lastRefreshTime;
var _1a=(this._viewletDefinition.refreshInterval*1000)-_19;
if(_1a<5000){
_1a=5000;
}
this._refreshTimeout=setTimeout(dojo.hitch(this.viewlet,"refresh"),_1a);
}else{
if(!_18&&this._refreshTimeout){
if(this._refreshTimeout){
clearTimeout(this._refreshTimeout);
delete this._refreshTimeout;
}
}
}
}
},toggleSettings:function(){
if(!this._settingsPanel){
this._openSettings();
}else{
this._settingsPanel.close(dojo.hitch(this,this._handleSettingsClose));
}
},uninitialize:function(){
if(this._refreshTimeout){
clearTimeout(this._refreshTimeout);
}
if(this._yieldTimeout){
clearTimeout(this._yieldTimeout);
}
if(this._serviceTracker){
var _1b=this._serviceTracker.getActiveRequests();
for(var i=0;i<_1b.length;i++){
_1b[i].abort();
}
}
try{
this._setActive(false);
}
catch(e){
}
this._edit=null;
this._close=null;
this._isDestroyed=true;
},updateTitleURL:function(){
if(!this.isTitleHyperlinkSet&&this.viewlet){
var url=this.viewlet.getTitleHyperlinkURL();
this.context.setTitleURL(url);
}
},_addLoginTracker:function(){
var _1c=new dojo.Deferred();
if(!_12){
_12=new Object();
}
var _1d=_12[this._webUIRoot];
if(!_1d){
_1d=_12[this._webUIRoot]=new _5();
}
this._loginCallback=dojo.hitch(this,function(){
this._removeLoginTracker();
if(_1c.fired===-1){
_1c.callback(false);
}
});
_1d.addListener(this._loginCallback,"login");
return _1c;
},_removeLoginTracker:function(){
if(this._webUIRoot&&_12&&_12[this._webUIRoot]){
_12[this._webUIRoot].removeListener(this._loginCallback);
delete this._loginCallback;
}
},_fireLoggedInEvent:function(){
if(!this.local&&this._loginCallback){
this._removeLoginTracker();
_12[this._webUIRoot].propertyChanged("login");
}
},_getServiceTracker:function(){
if(!this._serviceTracker){
this._serviceTracker=new _9();
}
return this._serviceTracker;
},_getWebURL:function(){
return this.local?_a.getContextPath(true):this._webUIRoot;
},_handleAutoRefresh:function(){
if(this._active){
this.refresh();
}else{
this._refreshTimeout=setTimeout(dojo.hitch(this,this._handleAutoRefresh),this._viewletDefinition.refreshInterval*1000);
}
},_handleMaximize:function(_1e){
this.viewlet.setZoomed(_1e);
if(_1e){
dojo.addClass(this.domNode,"zoomed");
}else{
dojo.removeClass(this.domNode,"zoomed");
}
this.viewlet.postZoom();
this.viewlet.getSite().setLoading(false);
},_handlePreMaximize:function(_1f){
this.viewlet.preZoom();
},_handleSettings:function(){
if(!this._settingsPanel){
this._openSettings();
}
},_handleSettingsCancel:function(){
var _20=dojo.clone(this._settingsPanel.workingCopy);
var _21=dojo.clone(this._settingsPanel.oldWorkingCopy);
this._settingsPanel.close(dojo.hitch(this,this._handleSettingsClose));
this.viewlet.settingsCanceled(_20,_21);
},_handleSettingsClose:function(){
this._settingsContainer.removeChild(this._settingsPanel.domNode);
this._settingsPanel.destroyRecursive();
delete this._settingsPanel;
this.viewlet.settingsAreaToggled(false);
},_hasSettings:function(){
if(this._viewletDefinition.scopeSensitive){
return true;
}
var _22=this._viewletDefinition.preferenceDefinitions;
if(_22){
for(var i=0;i<_22.length;i++){
if(_22[i].preferenceType!="HIDDEN"){
return true;
}
}
}
return false;
},_loadViewlet:function(_23){
if(this._isDestroyed){
return;
}
delete this._yieldTimeout;
var _24={_self:this,success:function(_25){
if(this._self._isDestroyed){
return;
}
this._self._fireLoggedInEvent();
if(_25){
this._self._resetLoginDecorations();
this._self._viewletDefinition=_25;
this._self._loadViewlet2(true);
}else{
var msg=dojo.string.substitute(_11.viewletDefNotFound,[this._self.definition]);
this._self._showError(msg);
}
},failure:function(_26){
if(this._self._isDestroyed){
return;
}
if(_26){
if(_26.status==401){
var _27=this._self._showLogin();
_27.addCallback(dojo.hitch(this._self,function(_28){
this._loadViewlet(_28);
return _28;
}));
}else{
if(_26.status==504){
this._self._fireLoggedInEvent();
this._self._showError(_26.message,_11.remoteConnectionError);
}else{
if(_26.dojoType=="popupBlocked"){
var _29=this._self._showPopupBlocked(_26.message);
_29.addCallback(dojo.hitch(this._self,function(_2a){
this._loadViewlet(_2a);
return _2a;
}));
}else{
if(_26.status==403){
this._self._fireLoggedInEvent();
this._self._showError(_26.responseText||_26.message,_11.remoteConnectionError);
}else{
this._self._fireLoggedInEvent();
this._self._showError(_26);
}
}
}
}
}else{
this._self._fireLoggedInEvent();
this._self._showError(_26);
}
}};
var srh=new _8(_24,"success","failure");
_c.getDefinition(this.definition,srh,_23,this._getServiceTracker());
},_loadViewlet2:function(_2b){
if(this._isDestroyed){
return;
}
this._serviceRoot=this._viewletDefinition.serviceRoot||this._serviceRoot;
var _2c=this.context.getPreferences();
var _2d=(_2c&&_2c["_scopeItem"]);
var _2e=true;
if(_2d){
var _2f=_4.getName(_2d);
if(!_2f){
var _30={_self:this,_itemId:_2d,success:function(_31){
this._self._fireLoggedInEvent();
this._self._resetLoginDecorations();
_4.addName({itemId:this._itemId,name:_31});
this._self._loadViewlet3();
},failure:function(_32){
if(_32){
if(_32.status==404&&_2e){
first=false;
_1.getItemName(_2c["_scope"],_2d,_a.getJTSURL(),srh,this._getServiceTracker(),_2b);
return;
}
if(_32.status==401){
var _33=this._self._showLogin();
_33.addCallback(dojo.hitch(this._self,function(_34){
this._loadViewlet2(_34);
return _34;
}));
}else{
if(_32.dojoType=="popupBlocked"){
var _35=this._self._showPopupBlocked(_32.message);
_35.addCallback(dojo.hitch(this._self,function(_36){
this._loadViewlet2(_36);
return _36;
}));
}else{
this._self._fireLoggedInEvent();
this._self._resetLoginDecorations();
this._self._loadViewlet3();
}
}
}else{
this._self._fireLoggedInEvent();
this._self._resetLoginDecorations();
this._self._loadViewlet3();
}
}};
var _37=this.local?null:(this._serviceRoot||this._webUIRoot||_a.getJTSURL());
var srh=new _8(_30,"success","failure");
_1.getItemName(_2c["_scope"],_2d,_37,srh,this._getServiceTracker(),_2b);
}else{
this._loadViewlet3();
}
}else{
this._loadViewlet3();
}
},_loadViewlet3:function(){
if(this._isDestroyed){
return;
}
var _38=new _d({context:this.context,viewletAdapter:this,viewletDefinition:this._viewletDefinition});
if(this.local){
jazz.core.loader.load_async(this._viewletDefinition.widget,dojo.hitch(this,function(){
if(!this._isDestroyed){
try{
var _39=eval(this._viewletDefinition.widget);
this.viewlet=new _39({site:_38,webURL:_a.getContextPath(true)});
this._bodyContainer.replaceChild(this.viewlet.domNode,this._bodyContainer.firstChild);
this._loadViewlet4();
}
catch(error){
this._showError(error);
}
}
}));
}else{
var _3a=this.domNode;
while(true){
if(_3a.id=="content-cell"||dojo.hasClass(_3a,"content-table")||!_3a.parentNode||_3a.parentNode.nodeType===9){
break;
}
_3a=_3a.parentNode;
}
var _3b={addLoginTracker:dojo.hitch(this,this._addLoginTracker),notifyLoggedIn:dojo.hitch(this,this._fireLoggedInEvent)};
this._iframeContainer=new _3({active:!this.collapsed,classIdentifier:this._viewletDefinition.widget,webUIRoot:this._webUIRoot,serviceRoot:this._serviceRoot,context:this.context,loginTracker:_3b,args:{site:_38},onLoad:dojo.hitch(this,function(_3c){
if(!this._isDestroyed){
this.viewlet=_3c;
this.viewlet._site=_38;
_38.viewlet=this.viewlet;
for(var i in _10){
this.viewlet[i]=_b.prototype[i];
}
this._updateRemoteIndicator(true);
this._loadViewlet4();
}
}),pageNode:_3a});
this._bodyContainer.replaceChild(this._iframeContainer.domNode,this._bodyContainer.firstChild);
}
},_loadViewlet4:function(){
if(this._isDestroyed){
return;
}
if(this._viewletDefinition.zoomable){
this.context.setMaximizeHandler(dojo.hitch(this,this._handleMaximize));
this.context.setPreMaximizeHandler(dojo.hitch(this,this._handlePreMaximize));
}
var _3d=this.context.getToolbar();
if(this._viewletDefinition.filterable&&!this.filterPanel&&_3d){
this.filterPanel=new _7();
this._filterContainer.appendChild(this.filterPanel.domNode);
_3d.addButton(this.filterPanel,this.filterPanel.toggle,{label:_11.filter,className:"com-ibm-team-dashboard-web-ui-ViewletAdapter-filter",index:this.local?0:1});
}
if(!this.readOnly&&this._viewletDefinition.editable){
this.context.setEditContentHandler(dojo.hitch(this,this.handleEditContent));
}
if(this._viewletDefinition.refreshInterval>0){
this.connect(this.viewlet,"refresh","_onRefresh");
}
this.context.setMenuContributions([]);
this.viewlet.init();
this._setActive(!this.collapsed);
if(this._hasSettings()){
this.context.setSettingsHandler(dojo.hitch(this,this._handleSettings));
}
this.refresh();
},_onRefresh:function(){
if(this._refreshTimeout){
clearTimeout(this._refreshTimeout);
delete this._refreshTimeout;
}
this._lastRefreshTime=new Date().getTime();
this._refreshTimeout=setTimeout(dojo.hitch(this,this._handleAutoRefresh),this._viewletDefinition.refreshInterval*1000);
},_openSettings:function(){
if(dojo.exists("com.ibm.team.dashboard.web.ui.internal.settings.ViewletSettingsPanel")){
this._settingsPanel=new com.ibm.team.dashboard.web.ui.internal.settings.ViewletSettingsPanel({onCancel:dojo.hitch(this,this._handleSettingsCancel),context:this.context,scopePreferenceProviderClass:this.getScopePreferenceProviderClass(),viewlet:this.viewlet,viewletAdapter:this,viewletDefinition:this._viewletDefinition,readOnly:this.readOnly});
this._settingsContainer.appendChild(this._settingsPanel.domNode);
this.viewlet.settingsAreaToggled(true);
this._settingsPanel.open();
}else{
this._loadSettingsPanel();
}
},_loadSettingsPanel:function(){
if(this._loadingSettingsPanel===false){
this._loadingSettingsPanel=true;
jazz.core.loader.load_async("com.ibm.team.dashboard.web.ui.internal.settings.ViewletSettingsPanel",dojo.hitch(this,function(){
this._openSettings();
this._loadingSettingsPanel=false;
}));
}
},_setActive:function(_3e){
if(_3e!==this._active){
this._active=_3e;
if(this._iframeContainer){
this._iframeContainer.setActive(_3e);
}
if(this.viewlet){
this.viewlet.setActive(_3e);
}
}
},_showError:function(_3f,msg){
if(this._isDestroyed){
return;
}
var _40=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/Dashboard/icons/error-10.gif?etag=dLdE2Eg");
this.context.setIcon(_40);
var _41={error:_3f};
if(msg){
_41.msg=msg;
}
this._errorReport=new _2(_41);
this._bodyContainer.innerHTML="";
this._bodyContainer.appendChild(this._errorReport.domNode);
},_showMessage:function(msg){
if(this._isDestroyed){
return;
}
var div=document.createElement("div");
div.className="msg";
div.appendChild(document.createTextNode(msg));
this._bodyContainer.replaceChild(div,this._bodyContainer.firstChild);
},_resetLoginDecorations:function(){
if(this.context.getIcon()!=this._icon){
this.context.setIcon(this._icon);
}
if(this.context.getSecondaryTitle()!=""){
this.context.setSecondaryTitle("");
}
},_showLogin:function(){
var _42=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/ViewletAdapter/icons/login.gif?etag=dLdE2Eg");
this.context.setIcon(_42);
this.context.setSecondaryTitle(_11.viewletNotLoggedIn);
var _43=this._addLoginTracker();
var _44=new _f({webUIRoot:this._webUIRoot,onLogin:dojo.hitch(this,function(){
_43.callback(false);
})});
dojo.place(_44.domNode,this._bodyContainer,"only");
return _43;
},_showPopupBlocked:function(_45){
var _46=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/Dashboard/icons/popup-blocked.gif?etag=dLdE2Eg");
this.context.setIcon(_46);
this.context.setSecondaryTitle("");
var _47=new dojo.Deferred();
var _48=new _f({statusMessage:_45,onLogin:dojo.hitch(this,function(){
_47.callback(false);
})});
dojo.place(_48.domNode,this._bodyContainer,"only");
return _47;
},_startEditing:function(_49){
if(_49){
dojo.stopEvent(_49);
}
this.setAutoRefresh(false);
var _4a=this.domNode.clientHeight;
this.domNode.style.height=_4a+"px";
this._editButtonArea.style.display="block";
this.editingButtons=[this.connect(this._saveEdits,"onclick",this._stopEditing),this.connect(this._cancelEdits,"onclick",this._stopEditing)];
this.viewlet.getViewletState().startEditing();
this.viewlet.setEditing(true);
var _4b=dojo.animateProperty({node:this.domNode,duration:200,properties:{height:{end:this._settingsContainer.clientHeight+this._contentWrapper.clientHeight+this._editButtonArea.clientHeight,unit:"px"}}});
_4b.play();
this.connect(_4b,"onEnd",function(){
this.domNode.style.height="";
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
});
},_stopEditing:function(e){
var _4c=false;
if(!e){
if(!confirm(dojo.string.substitute(_11.stopEditingConfirm,[this.context.getTitle()]))){
return false;
}
}else{
var _4c=e.target==this._saveEdits;
}
if(_4c){
var _4d=this.viewlet.validateEditedContent();
if(_4d==false){
return;
}
this.viewlet.preSaveState();
}
var _4e=this.domNode.clientHeight;
this.domNode.style.height=_4e+"px";
this._editButtonArea.style.display="none";
while(this.editingButtons.length>0){
this.disconnect(this.editingButtons.pop());
}
this.viewlet.getViewletState().stopEditing(_4c);
this.viewlet.setEditing(false);
var _4f=dojo.animateProperty({node:this.domNode,duration:200,properties:{height:{end:this._settingsContainer.clientHeight+this._contentWrapper.clientHeight+this._editButtonArea.clientHeight,unit:"px"}}});
_4f.play();
this.connect(_4f,"onEnd",function(){
this.domNode.style.height="";
this.setAutoRefresh(true);
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
});
if(!e){
return true;
}
},_updateRemoteIndicator:function(_50){
if(!this._remoteIcon){
return;
}
var _51=this._remoteIcon.domNode;
if(_50===true){
_51.title=dojo.string.substitute(_11.connected,[_11.remoteServer,this._shortOrigin]);
_51.className="com-ibm-team-dashboard-web-ui-ViewletAdapter-remote-icon-connected";
}else{
_51.title=dojo.string.substitute(_11.disconnected,[_11.remoteServer,this._shortOrigin]);
_51.className="com-ibm-team-dashboard-web-ui-ViewletAdapter-remote-icon-disconnected";
}
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.ViewletAdapterFactory");


(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.ViewletAdapter;
dojo.declare("com.ibm.team.dashboard.web.ui.internal.ViewletAdapterFactory",null,{createWidget:function(_2){
return new _1(_2);
}});
})();


;dojo.cache("com.ibm.team.dashboard.web", "ui/internal/templates/Dashboard.html", "<div class=\"com-ibm-team-dashboard-web-ui-internal-Dashboard\">	<div class=\"messageArea\" dojoAttachPoint=\"messageArea\" style=\"display: none\">		<div dojoType=\"jazz.ui.MessageBox\" dojoAttachPoint=\"messageBox\"></div>	</div></div>");

;dojo.provide("com.ibm.team.dashboard.web.ui.Dashboard");
















































dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=jazz.util.binding;
var _2=com.ibm.team.dashboard.web.ui.internal.util.bindings;
var _3=jazz.ensemble.internal.client.HttpConstants;
var _4=jazz.util.html;
var _5=net.jazz.ajax.ui.PlatformUI;
var _6=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _7=com.ibm.team.dashboard.web.ui.internal.DashboardInitializationData;
var _8=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _9=com.ibm.team.dashboard.web.ui.internal.util.ServiceTracker;
var _a=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _b=com.ibm.team.dashboard.web.ui.internal.DashboardContainer;
var _c=jazz.ui.MessageBox;
var _d=com.ibm.team.dashboard.web.ui.internal.util.Observable;
var _e=jazz.ensemble.internal.client.RestClient;
var _f;
dojo.declare("com.ibm.team.dashboard.web.ui.Dashboard",[_d,dijit._Widget,dijit._Templated,dijit._Container],{templatePath:dojo.moduleUrl("com.ibm.team.dashboard.web","ui/internal/templates/Dashboard.html"),widgetsInTemplate:true,url:null,onDirtyStateChange:function(_10){
},onLoad:function(){
},onPageChange:function(_11){
},onTitleChange:function(_12){
},page:null,projectArea:null,scope:null,scopeItem:null,constructor:function(_13){
if(!_f){
_f=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
}
},destroy:function(){
if(this._redirectTimeout){
clearTimeout(this._redirectTimeout);
delete this._redirectTimeout;
}
if(this._serviceTracker){
var _14=this._serviceTracker.getActiveRequests();
for(var i=0;i<_14.length;i++){
_14[i].abort();
}
}
if(this.navigateAwayHandle){
_5.getWorkbench().unregisterBodyClickHandler(this.navigateAwayHandle);
}
if(this.onBeforeUnloadHandle){
_5.getWorkbench().unregisterOnBeforeUnloadHandler(this.onBeforeUnloadHandle);
}
if(this._contentWidget){
this._contentWidget.destroy();
delete this._contentWidget;
}
this.inherited(arguments);
},getResource:function(){
var _15=this.getBundle();
if(_15){
return _15.dashboard.content;
}
},getProperties:function(){
if(this._contentWidget&&this._contentWidget instanceof _b){
return this._contentWidget.getProperties();
}
},setProperties:function(_16){
if(this._contentWidget&&this._contentWidget instanceof _b){
return this._contentWidget.setProperties(_16);
}
},showPage:function(_17){
this.showTab(_17);
},isDirty:function(){
if(this._contentWidget&&this._contentWidget.isDirty){
return this._contentWidget.isDirty();
}
return false;
},isUnsaved:function(){
if(this._contentWidget&&this._contentWidget.isUnsaved){
return this._contentWidget.isUnsaved();
}
return false;
},refresh:function(){
if(this._contentWidget&&this._contentWidget instanceof _b){
this._contentWidget.reload();
}
},resourceChanged:function(){
if(this._contentWidget&&this._contentWidget instanceof _b){
this._contentWidget.fireDashboardChange();
}
},allowDelete:true,allowSharing:false,allowSetDefault:false,autoSave:null,showBreadcrumbs:true,catalogClass:null,showTab:function(tab){
if(this._contentWidget instanceof _b&&this._isLoaded){
var _18=typeof (tab);
if(_18==="string"){
this._contentWidget.showViewletPageById(tab);
}else{
if(_18==="number"){
this._contentWidget.showViewletPage(tab);
}else{
this._contentWidget.showViewletPage(0);
}
}
this.tab=this._contentWidget.selectedTabId;
this.setActive(true);
}
},setActive:function(_19){
if(this._contentWidget instanceof _b){
this._contentWidget.setActive(_19);
}
},postCreate:function(){
this.addListener(dojo.hitch(this,function(){
this.onLoad();
}),"onload");
this.addListener(dojo.hitch(this,function(_1a,tab){
this.onPageChange(tab);
}),"tab");
this.addListener(dojo.hitch(this,function(_1b,_1c){
this.onTitleChange(_1c);
}),"title");
var _1d={tab:this.page||this.tab};
if(this.url){
_1d.id=this.url.substring(this.url.lastIndexOf("/")+1);
}else{
switch(this.scope){
case _a.SCOPE_TEAM_AREA:
_1d.team=this.scopeItem.join("/");
break;
case _a.SCOPE_CONTRIBUTOR:
for(var i in this.scopeItem){
_1d[i]=this.scopeItem[i];
}
break;
}
}
this.viewDashboard(_1d,this.projectArea);
},getBundle:function(){
return this._contentWidget&&this._contentWidget.dashboardBundle;
},getServiceTracker:function(){
if(!this._serviceTracker){
this._serviceTracker=new _9();
}
return this._serviceTracker;
},getTitle:function(_1e){
if(this._contentWidget&&this._contentWidget instanceof _b){
var _1f=this._contentWidget.getTitle();
if(_1e&&this._contentWidget.currentPage&&this._contentWidget.currentPage.page){
var _20=this._contentWidget.currentPage.page.getTitle();
return dojo.string.substitute(_f.dashboardTitleWithTab,[_1f,_20]);
}
return _1f;
}
return "";
},isVisible:function(){
return this._isVisible;
},handleOnBeforeUnload:function(_21){
if(this._redirectTimeout){
clearTimeout(this._redirectTimeout);
delete this._redirectTimeout;
}
if(this._contentWidget&&this._contentWidget.dashboardResource){
return this._contentWidget.handleOnBeforeUnload();
}
return false;
},promptNavigateAway:function(){
var _22=true;
if(this._contentWidget&&this._contentWidget instanceof _b&&this._contentWidget.dashboardResource){
_22=this._contentWidget.promptNavigateAway();
}
if(_22){
this._isVisible=false;
}
return _22;
},viewDashboard:function(_23,_24){
var dfd=_7.load();
dfd.addCallback(dojo.hitch(this,this.viewDashboard2,_23,_24));
},viewDashboard2:function(_25,_26){
this._isVisible=true;
this._checkNavigateAwayHandle();
var tab=_25.tab;
delete _25.tab;
delete _25.action;
var _27={dashboard:this,args:_25,tab:tab,success:function(_28){
var _29=[];
if(this.dashboard.isPersonal){
_29.push({label:_f.errorGotoDefaultPersonal,iconClass:"default-dash j-mirror",href:location.pathname});
}else{
if(this.dashboard.scope==_a.SCOPE_TEAM_AREA||this.dashboard.scope==_a.SCOPE_PROJECT_AREA){
_29.push({label:_f.errorVisitProjectDash,iconClass:"project-icon j-mirror",href:location.pathname});
}
}
switch(_28.status){
case "NOT_FOUND":
this.dashboard._createError({summary:_f.errorNotFound,actions:_29});
break;
case "MOVED":
var _2a=["<a href=\"",_28.msg,"\">",_28.msg,"</a>"].join("");
this.dashboard._createError({summary:dojo.string.substitute(_f.movedMsg,[_2a]),actions:_29});
this.dashboard._redirectTimeout=setTimeout(dojo.hitch(this,function(){
if(this.dashboard._redirectTimeout){
location.replace(_28.msg);
}
}),10000);
break;
case "ERROR":
this.dashboard._createError({summary:_28.msg,actions:_29});
break;
case "READ_ONLY":
this.dashboard._createError({summary:_f.errorCreateReadOnly,details:_4.escape(_28.msg),actions:_29});
break;
case "OK":
default:
dojo.setObject("com.ibm.team.dashboard.internal.permissions",_28.data.permissions);
var _2b=this.dashboard.url=_28.data.dashboardUrl;
var _2c=this.dashboard._contentWidget;
if(_2c.dashboardUrl==_2b){
if(_2c.tabs){
_2c.showViewletPageById(this.tab);
}
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
this.dashboard.propertyChanged("onload");
this.dashboard._isLoaded=true;
}else{
if(_2c&&_2c.dashboardUrl){
this.dashboard._createContentWidget(this.tab);
}
var _2d={};
_2d[_3.ACCEPT]=_3.CT_APPLICATION_RDF_XML;
if(_2b.indexOf("?")>-1){
_2b+="&";
}else{
_2b+="?";
}
_2b+="contentType=application%2Frdf%25xml";
var dfd=_e.getResource(_2b,_e.HANDLE_AS_XML,_2d);
dfd.addCallback(dojo.hitch(this,function(_2e){
var _2f=_28.data;
_2f.dashboard=_2e;
_2f.revision=_36();
_2e.binding=_1.bind(_2e.content.documentElement,_2.Dashboard);
this.dashboard._initializeContentWidget(_2f);
dojo.publish("jazz.util.ResizeNotifier.resizeEvent");
this.dashboard.propertyChanged("onload");
this.dashboard._isLoaded=true;
return _2e;
}));
dfd.addErrback(dojo.hitch(this,function(e){
this.dashboard._createError({summary:_f.errorRetrieving+"<br/><br/>"+e.message,actions:_29});
return e;
}));
}
break;
}
},failure:function(_30){
var _31=[];
var msg;
if(_30){
switch(_30.status){
case 0:
_30.message=_f.connectionFailure;
break;
case 401:
_31.push({label:_f.tryAgain,iconClass:"com-ibm-team-dashboard-content-refresh",onClick:dojo.hitch(this,function(){
this.dashboard.viewDashboard(_35,_26);
})});
msg=_30.message;
break;
case 403:
msg=_f.errorNoPermission;
var _32=_f.errorNoPermission_explanation+"<br/>"+_f.errorNoPermission_useraction;
break;
}
}
if(!msg){
msg=_f.errorRetrieving;
}
if(!_32&&_30){
var buf=[];
_30.status&&_30.ioArgs&&_30.ioArgs.xhr&&buf.push("HTTP/1.1 ",_4.escape(_30.status)," ",_4.escape(_30.ioArgs.xhr.statusText),"<br/>",_4.escape(_30.ioArgs.url),"<br/><br/>");
var _33=_34(_30);
if(_33){
buf.push("<pre>",_4.escape(_33),"</pre>");
}else{
_30.message&&buf.push(_4.escape(_30.message));
}
_32=buf.join("");
}
var _35={summary:msg,actions:_31};
if(_32){
_35.details=_32;
}
this.dashboard._createError(_35);
}};
this._createContentWidget(tab);
var srh=new _8(_27,"success","failure");
_6.getDashboard(_25.id,_25.team,_26,srh,this.getServiceTracker(),_36());
},setCurrentDeleted:function(){
this._contentWidget.deleted=true;
},addListener:function(_37,_38){
this.inherited(arguments);
if(_38=="onload"&&this._isLoaded){
_37("onload");
}
},_createContentWidget:function(_39){
if(this._contentWidget){
this._destroyContentWidget();
}
if(!_39){
_39="tab1";
}
this._contentWidget=new _b({dashboardWidget:this,selectedTabId:_39,allowDelete:this.allowDelete,allowSharing:this.allowSharing,allowSetDefault:this.allowSetDefault,autoSave:this.autoSave,catalogClass:this.catalogClass,showBreadcrumbs:this.showBreadcrumbs});
this._contentWidget.addListener(dojo.hitch(this,this._onTabChange),"tab");
this._contentWidget.addListener(dojo.hitch(this,this._bubblePropertyChange),"title");
this._contentWidget.addListener(dojo.hitch(this,this.propertyChanged),"onsave");
this._contentWidget.addListener(dojo.hitch(this,this.propertyChanged),"ondelete");
this._setContent(this._contentWidget.domNode);
this._setDirtyConnect=this.connect(this._contentWidget,"onDirtyStateChange",function(_3a){
this.onDirtyStateChange(_3a);
});
},_onTabChange:function(_3b,tab){
this.tab=tab;
this.propertyChanged(_3b,tab);
},_bubblePropertyChange:function(_3c,arg){
this.propertyChanged(_3c,arg);
},_hideMessage:function(){
this.messageBox.hideMessage(false);
this.messageArea.style.display="none";
},_initializeContentWidget:function(_3d){
if(this._contentWidget&&this._contentWidget.setContent){
this._contentWidget.setContent(_3d);
}
},_createError:function(_3e){
if(this._contentWidget){
this._destroyContentWidget();
}
this._contentWidget=new jazz.ui.ErrorPage(_3e);
this._setContent(this._contentWidget.domNode);
},_setContent:function(_3f){
if(this._contentNode&&this._contentNode.parentNode===this.domNode){
this.domNode.replaceChild(_3f,this._contentNode);
}else{
this.domNode.appendChild(_3f);
}
this._contentNode=_3f;
},_showMessage:function(_40,_41){
this.messageArea.style.display="";
this.messageBox.showMessage(_40);
dojo[_41?"removeClass":"addClass"](this.messageBox.domNode,"noIcon");
this.messageBox.onClose=dojo.hitch(this,function(){
this.messageArea.style.display="none";
_40.onClose&&_40.onClose();
});
},_destroyContentWidget:function(){
if(!this._contentWidget){
return;
}
if(this._setDirtyConnect){
this.disconnect(this._setDirtyConnect);
delete this._setDirtyConnect;
}
this._contentWidget.destroy();
this._contentWidget=null;
},_checkNavigateAwayHandle:function(){
if(!this.onBeforeUnloadHandle&&_5.getWorkbench()){
this.onBeforeUnloadHandle=_5.getWorkbench().registerOnBeforeUnloadHandler(dojo.hitch(this,this.handleOnBeforeUnload),10000);
}
}});
function _36(){
try{
var _42=dojo.hash();
if(_42){
var _43=dojo.queryToObject(_42).revision;
if(_43){
return _43;
}
}
_42=location.search;
if(_42){
return dojo.queryToObject(_42.substring(1)).revision;
}
}
catch(e){
console.error(e);
}
};
function _34(_44){
if(_44.errorClass){
var buf=[_4.escape(_44.errorClass)];
var msg=_44.message||_44.errorMessage;
msg&&buf.push(": ",msg);
var _45=_44.exception||_44.errorTrace;
if(_45){
if(dojo.isArray(_45)){
var len=_45.length;
for(var i=0;i<len;++i){
buf.push("\n\tat ",_45[i]);
}
if(_44.nestedError){
buf.push("\nCaused by: ",_34(_44.nestedError));
}
}else{
buf.push(_45);
}
}
return buf.join("");
}
};
})();


;(function(){
dojo.provide("com.ibm.team.dashboard.web.ui.internal.PersonalDashboard");








var _1=jazz.util.binding;
var _2=com.ibm.team.dashboard.web.ui.Dashboard;
var _3=jazz.ui.MessageBox;
var _4={namespaces:{jdb:"http://jazz.net/xmlns/prod/jazz/dashboard/1.0/"},getShowWelcome:["boolean","jdb:showWelcome","1"],setShowWelcome:["boolean","jdb:showWelcome","1"]};
var _5="com.ibm.team.dashboard.web.ui.internal.dashboardMsg";
var _6="com.ibm.team.dashboard.web.ui.internal.util.WelcomeMsg";
dojo.declare("com.ibm.team.dashboard.web.ui.internal.PersonalDashboard",[_2],{url:null,allowDelete:true,allowSetDefault:true,allowSharing:true,showBreadcrumbs:true,isPersonal:true,destroy:function(){
this._destroyWelcomeMsg();
this.inherited(arguments);
},_destroyWelcomeMsg:function(){
if(this._welcomeMsg){
this._welcomeMsg.destroyRecursive();
delete this._welcomeMsg;
}
},onLoad:function(){
this.inherited(arguments);
var _7=dojo.getObject(_5);
if(_7){
dojo.setObject(_5,null);
this._showMessage(_7,true);
}else{
var _8=this.getResource();
if(_8){
this._resource=_1.bind(_8.documentElement,_4);
var _9=this.getBundle().permissions.create&&this.getBundle().permissions.modify;
if(_9&&this._resource.getShowWelcome()){
this._showWelcomeMsg(this.url);
}
}
}
},_showWelcomeMsg:function(_a){
jazz.core.loader.load_async(_6,dojo.hitch(this,function(){
this._destroyWelcomeMsg();
var _b=this._welcomeMsg=new dojo.getObject(_6)({dashboardUrl:_a,onFinish:dojo.hitch(this,function(){
this._hideMessage();
this.refresh();
}),navigateAway:dojo.hitch(this,function(){
return this.isDirty()?this.promptNavigateAway():true;
})});
this._showMessage({type:_3.STATUS_TYPES.OK,summary:_b.domNode,closable:true,onClose:dojo.hitch(this,function(){
this._resource.setShowWelcome(false);
this.resourceChanged();
})},false);
}));
}});
})();


;dojo.provide("com.ibm.team.dashboard.web.client.internal.PersonalDashboardClient");




















dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.client.internal.DashboardClient;
var _2=com.ibm.team.dashboard.web.ui.DashboardConstants;
var _3=com.ibm.team.dashboard.web.ui.internal.Constants;
var _4=com.ibm.team.dashboard.web.util.internal.Util;
var _5=com.ibm.team.repository.web.client.session.getAuthenticatedContributor;
var _6=com.ibm.team.repository.web.transport.ServiceResponseHandler;
var _7=net.jazz.ajax.ui.PlatformUI;
var _8,_9;
var _a=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
com.ibm.team.dashboard.web.client.internal.PersonalDashboardClient={get:function(){
if(_8){
return _8;
}
_8=new dojo.Deferred();
var _b={success:function(_c){
_9=_c;
_8.callback(_9);
},failure:function(_d){
_8.errback(_d);
}};
var _e=_5().userId;
var _f=new _6(_b,"success","failure");
_1.getLeftNavInfo(jazz.app.context.get().name,_f,null,true);
dojo.subscribe("/jazz/dashboard/rename",_10,_10._renameDashboard);
dojo.subscribe("/jazz/dashboard/delete",_10,_10._deleteDashboard);
dojo.subscribe("/jazz/dashboard/share",_10,_10._shareDashboard);
dojo.subscribe("/jazz/dashboard/setDefault",_10,_10._setDefaultDashboard);
return _8;
},clearCache:function(){
if(_8){
_8=null;
}
},createDashboard:function(_11,_12){
var dfd=new dojo.Deferred();
var _13={success:function(_14){
switch(_14.status){
case "OK":
var _15=_14.data;
var url=_15.dashboardUrl;
if(_9){
var id=url.substring(url.lastIndexOf("/")+1);
if(!_9.personalDashboards){
_9.personalDashboards=[];
}
_9.personalDashboards.push({id:id,itemId:id,url:url,title:_14.msg,shared:false});
}
dojo.publish("/jazz/dashboard/create",[url,_14.msg]);
dojo.publish(jazz.app.events.HOME_MENU_REFRESH);
dfd.callback(url);
break;
case "READ_ONLY":
var e=new Error(_14.msg);
e.status=503;
dfd.errback(e);
break;
case "ERROR":
var e=new Error(_14.msg);
e.status=500;
dfd.errback(e);
break;
default:
dfd.errback(new Error(_14.msg));
break;
}
},failure:function(e){
dfd.errback(e);
}};
var srh=new _6(_13,"success","failure");
_1.createDashboard(null,_2.SCOPE_CONTRIBUTOR,_5().itemId,null,true,srh,null,true,_11,_12);
return dfd;
},newDashboard:function(){
var _16=_10.get();
_16.addCallback(function(_17){
var _18={success:function(_19){
switch(_19.status){
case "OK":
var _1a=_19.data;
var url=_1a.dashboardUrl;
var id=url.substring(url.lastIndexOf("/")+1);
if(!_9.personalDashboards){
_9.personalDashboards=[];
}
_9.personalDashboards.push({id:id,itemId:id,url:url,title:_19.msg,shared:false});
dojo.publish("/jazz/dashboard/create",[url,_19.msg]);
dojo.publish(jazz.app.events.HOME_MENU_REFRESH);
var _1b=_4.getDashboardHref(_1a);
if(_7&&!_7.getWorkbench().shouldVetoNavigation(_1b)){
location.href=_1b;
}
break;
case "ERROR":
alert(_19.msg);
break;
}
},failure:function(e){
if(e.status==403){
alert(_a.createPermissionDenied);
}else{
_16.errback(e);
}
}};
var srh=new _6(_18,"success","failure");
_1.createDashboard(null,_2.SCOPE_CONTRIBUTOR,_17.contributor.itemId,null,true,srh,null,true);
});
_16.addErrback(function(_1c){
if(_1c.status==403){
alert(_a.createPermissionDenied);
}else{
console.error(_3.LeftNav.REMOTE_ERROR+_1c.message,_1c);
}
});
return _16;
},_renameDashboard:function(url,_1d){
_9.personalDashboards[_10._findDashboard(url)].title=_1d;
},_deleteDashboard:function(url){
_9.personalDashboards.splice(_10._findDashboard(url),1);
},_shareDashboard:function(url,_1e){
_9.personalDashboards[_10._findDashboard(url)].shared=_1e;
},_setDefaultDashboard:function(url){
var dbs=_9.personalDashboards;
for(var i=0;i<dbs.length;i++){
if(dbs[i].url===url){
dbs[i]["default"]=true;
}else{
if(dbs[i]["default"]){
delete dbs[i]["default"];
}
}
}
},_findDashboard:function(url){
var dbs=_9.personalDashboards;
for(var i=0;i<dbs.length;i++){
if(dbs[i].url===url){
return i;
}
}
}};
var _10=com.ibm.team.dashboard.web.client.internal.PersonalDashboardClient;
})();


;dojo.provide("jazz.app.viewHistory");








(function(){
var _1={};
var _2="jazz.app.viewHistory";
var _3="%ROOT%";
var _4="--";
var _5="%MY_APPLICATION%";
var _6=jazz.app.internal.applicationAbout.findAboutUriFromContext(net.jazz.ajax.BootstrapProperties.FRONTSIDE_URL);
jazz.app.viewHistory={get:function(_7,_8){
if(_7.application==_5){
_7.application=_6;
}
var _9=this._createKey(_7);
var _a=_1[_9];
if(!_8&&_a){
return this._getCached(_a,_7);
}
return this._getService(_9,_7);
},put:function(_b,_c){
if(_b.application==_5){
_b.application=_6;
}
if(!_b.project){
_b.project=_3;
}
var _d={application:_b.application,project:_b.project,type:_b.type,label:_c.label,uri:this._fullyQualify(_c.uri),iconUri:this._fullyQualify(_c.iconUri),data:_c.data};
var _e=this._createKey(_b);
var _f=_1[_e];
if(_f){
for(var i=0;i<_f.length;i++){
if(_f[i].uri==_d.uri){
_f.splice(i,1);
break;
}
}
_f.unshift(_d);
var _10=_f.length-10;
if(_10>0){
_f.splice(10,_10);
}
}
this._postService(_d);
},_fullyQualify:function(url){
if(!url){
return url;
}
var cr=net.jazz.ajax.contextRoot();
if(url.indexOf(cr)===0){
url=net.jazz.ajax.BootstrapProperties.FRONTSIDE_URL+url.substring(cr.length);
}
return url;
},_getMergedCache:function(key,_11){
if(_11.project&&_11.type){
return _1[key];
}
var _12;
for(var _13 in _1){
var _14=_13.split("|");
console.debug(_13);
console.debug(_11);
if(_11.application&&_11.application!=_14[1]){
continue;
}
if(_11.project&&_11.project!=_14[2]){
continue;
}
if(_11.type&&_11.type!=_14[3]){
continue;
}
if(_11.user&&_11.user!=_14[4]){
continue;
}
if(!_12){
_12=_1[_13];
}else{
_12=_12.concat(_1[_13]);
}
console.debug(_12);
}
return _12;
},_getService:function(key,_15){
var _16={url:this._assembleURL(_15),headers:{"accept":"application/json"},handleAs:"json"};
var _17=new dojo.Deferred();
jazz.client.xhrGet(_16).addCallbacks(function(_18){
_1[key]=_18?_18.items:[];
_17.callback(_18);
},function(_19){
_17.errback(_19);
});
return _17;
},_postService:function(_1a){
var _1b={url:this._assembleURL(),headers:{"content-type":"application/x-www-form-urlencoded; charset=utf-8","X-com-ibm-team-configuration-versions":"LATEST","X-Jazz-CSRF-Prevent":dojo.cookie("JSESSIONID")}};
_1b.postData=dojo.objectToQuery(_1a);
var _1c=jazz.client.rawXhrPost(_1b);
_1c.addErrback(dojo.hitch(this,function(_1d){
}));
},_assembleURL:function(_1e){
var url=net.jazz.ajax.contextRoot()+"/"+"view-history";
if(_1e){
url+="?"+dojo.objectToQuery(_1e);
}
return url;
},_createKey:function(_1f){
var key=[];
key.push(_2);
if(_1f.application){
key.push(_1f.application);
}else{
key.push(_4);
}
if(_1f.project){
key.push(_1f.project);
}else{
key.push(_4);
}
key.push(_1f.type);
if(_1f.user){
key.push(_1f.user);
}else{
key.push(_4);
}
return key.join("|");
},_initFromLocalStorage:function(key){
if(!_1[key]){
var _20=dojo.fromJson(localStorage.getItem(key));
_1[key]=_20?_20:[];
}
},_getCached:function(_21,_22){
var _23=[];
var _24=_22.startIndex?_22.startIndex:0;
var _25=_22.size?_22.size:5;
if(_21){
for(var i=0;i<_21.length;i++){
if(_22.exclude&&dojo.indexOf(_22.exclude,_21[i].uri)!=-1){
continue;
}
if(i<_24){
continue;
}
_23.push(_21[i]);
if(_23.length==_25){
break;
}
}
}
var def=new dojo.Deferred();
def.callback({count:_21?_21.length:0,items:_23});
return def;
}};
})();


;dojo.provide("com.ibm.team.dashboard.web.ui.internal.PersonalDashboardPage");


































dojo.requireLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
(function(){
var _1=com.ibm.team.dashboard.web.ui.internal.PersonalDashboard;
var _2=com.ibm.team.dashboard.web.ui.internal.Constants;
var _3=net.jazz.ajax.ui.PlatformUI;
var _4=jazz.ensemble.internal.client.RestClient;
var _5=com.ibm.team.dashboard.web.util.internal.Util;
var _6=com.ibm.team.dashboard.web.client.internal.PersonalDashboardClient;
var _7=jazz.util.html;
var _8=jazz.app.viewHistory;
var _9;
var _a=true;
var _b="/dashboards";
var _c="com.ibm.team.personal.dashboard";
dojo.declare("com.ibm.team.dashboard.web.ui.internal.PersonalDashboardPage",[dijit._Widget],{constructor:function(){
if(!_9){
_9=dojo.i18n.getLocalization("com.ibm.team.dashboard.web.ui.internal","DashboardMessages");
}
},postCreate:function(){
this.subscribe("/jazz/dashboard/initMenu",this._initMenu);
var _d=_3.getWorkbench();
var _e=_d.getResourceRegistry();
_e.registerHandlerForPattern(_b,this,"viewDashboard");
var _f=_d.getActionRegistry();
_f.registerAction("com.ibm.team.dashboard.viewDefaultPersonalDashboard",this,"viewDashboard");
this.navigateAwayHandle=_d.registerBodyClickHandler(dojo.hitch(this,this._handleNavigate),10000);
},_handleNavigate:function(_10,_11){
var _12=new dojo._Url(window.location.href);
var _13=decodeURIComponent(_10.path).indexOf(decodeURIComponent(location.pathname))==0;
if((!_10.host||!_10.scheme||(_10.host===_12.host&&_10.scheme===_12.scheme))&&_13&&this._dashboard instanceof _1){
var _14=this._getResourcePathFromUrl(_12);
var _15=this._getResourcePathFromUrl(_10);
var _16=_15.search(/\/dashboards\/?$/)!==-1;
if(!_15||(_15.indexOf(_b)===-1&&((!this._active&&_15==this._currentDashboardPath)||(this._active&&_14==this._currentDashboardPath)))){
if(_14&&_14.indexOf(_b)===0){
this._dashboard.setActive(false);
this._active=false;
}
}else{
if(((!_16&&this._currentDashboardPath!==_15)||(_16&&this._dashboard.getBundle()&&!this._dashboard.getBundle().isDefaultDashboard))&&this._dashboard.isUnsaved()){
return !this._dashboard.promptNavigateAway();
}
}
}
return false;
},_getResourcePathFromUrl:function(_17){
var _18=_17.fragment,_19=_17.path;
if(_18&&_18.length>0){
if(_17.fragment.indexOf("/")==0){
_19="/dashboards"+_17.fragment;
}else{
_19=_17.fragment;
}
}
return _19.replace(_5.getContextPath(),"").replace(/\/tab[^\/]+\/?$/,"");
},_initMenu:function(_1a){
if(typeof _a==="object"){
_1a.onDirtyStateChange(_a,true);
_a=null;
}
},destroy:function(){
this.destroyDashboard();
this.inherited(arguments);
},destroyDashboard:function(){
if(this._dashboard){
this.disconnect(this._onDirtyStateConnect);
dojo.publish("/jazz/dashboard/dirty",[this._dashboard.getBundle(),false]);
_3.getWorkbench().setPageDirty("com.ibm.team.dashboard.personal",false);
this._dashboard.destroy();
delete this._dashboard;
}
if(this._dashboardUpdate){
this._dashboardUpdate.destroy();
delete this._dashboardUpdate;
}
window.scrollTo(0,0);
},_getInfoFromUrl:function(){
var url=location.href;
var _1b=new dojo._Url(url),_1c={},_1d=_1b.fragment,_1e=_1b.path;
if(_1d&&_1d.length>0){
if(_1e.indexOf(_1d,_1e.length-_1d.length)>=0){
dojo.hash("",true);
}
_1e=location.pathname+_1b.fragment;
}
if(_1e.indexOf("/update")==(_1e.length-7)){
return "update";
}
if(_1e.search(/\/dashboards\/?$/)!=-1){
return null;
}
_1c.resourcePath=_1e.replace(_5.getContextPath(),"").replace(/\/tab[^\/]+\/?$/,"");
var _1f=_1e.match(/\/tab([^\/]+)\/?$/);
if(_1f&&_1f.length>=1){
_1c.tab=_1f[1];
_1e=_1e.replace(/\/tab[^\/]+\/?$/,"");
}
_1c.url=url.replace(/(https?:\/\/[^\/?#]+).*/,"$1"+_1e);
return _1c;
},viewDashboard:function(){
var _20=this._getInfoFromUrl();
if(!_20){
this._getDefaultDashboard(true,true);
}else{
this._currentDashboardPath=_20.resourcePath;
this._showDashboard(_20);
}
this._active=true;
},_getDefaultDashboard:function(_21,_22){
var _23=_6.get();
_23.addCallback(dojo.hitch(this,function(_24){
if(_24&&_24.personalDashboards&&_24.personalDashboards[0]){
dojo.hash(this._hashify(_24.personalDashboards[0].url),_22);
}else{
if(_21){
var dfd=_6.createDashboard();
dfd.addCallback(dojo.hitch(this,function(url){
dojo.hash(this._hashify(url),_22);
return url;
}));
dfd.addErrback(this,function(e){
dojo.hash(_5.getAllPersonalDashboardsHash(),_22);
return e;
});
}else{
dojo.hash(_5.getAllPersonalDashboardsHash(),_22);
}
}
}));
_23.addErrback(dojo.hitch(this,function(e){
dojo.hash(_5.getAllPersonalDashboardsHash(),_22);
}));
},_hashify:function(url){
return url.substring(url.indexOf(_b+"/"));
},_showDashboard:function(_25){
if(_25=="update"){
this._showDashboardUpdate();
return;
}
if(this._dashboard){
if(this._dashboard.url!=_25.url){
this.destroyDashboard();
}else{
this._dashboard.showTab(_25.tab);
}
}else{
this.destroyDashboard();
}
var _26=jazz.app.context.get();
_26.dashboard=_25.url;
jazz.app.context.set(_26);
if(!this._dashboard){
this._dashboard=new _1({url:_25.url,tab:_25.tab});
this._dashboard.addListener(dojo.hitch(this,this._onLoad),"onload");
this._dashboard.addListener(dojo.hitch(this,this._onDelete),"ondelete");
this._dashboard.addListener(dojo.hitch(this,this._onSave),"onsave");
this._dashboard.addListener(dojo.hitch(this,this._onTabChange),"tab");
this._dashboard.addListener(dojo.hitch(this,this._onTitleChange),"title");
this._dashboard.addListener(dojo.hitch(this,this._onSharedChange),"shared");
this._setContent(this._dashboard);
}
if(this._title){
_3.getWorkbench().setTitle(this._title);
}
this._onDirtyStateConnect=this.connect(this._dashboard,"onDirtyStateChange",this._onDirtyStateChange);
},_showDashboardUpdate:function(){
if(this._dashboardUpdate){
return;
}
this.destroyDashboard();
jazz.core.loader.load_async("com.ibm.team.dashboard.web.ui.internal.DashboardUpdate",dojo.hitch(this,function(){
this._dashboardUpdate=new com.ibm.team.dashboard.web.ui.internal.DashboardUpdate();
this._setContent(this._dashboardUpdate);
this._updateBrowserTitle();
var _27=jazz.app.context.get();
_27.dashboard=_5.getContextPath(true)+"/dashboards/update";
jazz.app.context.set(_27);
}));
},_onTitleChange:function(_28,_29){
var _2a=this._dashboard.getBundle();
dojo.publish("/jazz/dashboard/rename",[_2a.dashboardUrl,_29]);
this._updateBrowserTitle();
this._hmRefresh=true;
},_onSharedChange:function(_2b,_2c){
var _2d=this._dashboard.getBundle();
var url=_2d.dashboardUrl;
dojo.publish("/jazz/dashboard/share",[url,_2c]);
this._doViewHistoryPut(_2d);
this._hmRefresh=true;
},_onSave:function(){
if(this._hmRefresh){
dojo.publish(jazz.app.events.HOME_MENU_REFRESH);
delete this._hmRefresh;
}
},_onDirtyStateChange:function(_2e){
_3.getWorkbench().setPageDirty("com.ibm.team.dashboard.personal",_2e);
var _2f=this._dashboard.getBundle();
if(_a){
if(_2e){
_a=_2f;
}else{
if(_a.dashboardUrl===_2f.dashboardUrl){
_a=true;
}
}
}
dojo.publish("/jazz/dashboard/dirty",[_2f,_2e]);
},_onLoad:function(){
if(this._dashboard){
var _30=this._dashboard.getBundle();
dojo.publish("/jazz/dashboard/view",[_30]);
this._doViewHistoryPut(_30);
this._updateBrowserTitle();
this._updateURL();
}
},_doViewHistoryPut:function(_31){
var _32={application:"%MY_APPLICATION%",type:_c};
_8.put(_32,this._createHistoryEntry(_31));
},_createHistoryEntry:function(_33){
var _34={};
var _35=_33.dashboard.binding;
_34.label=_7.escape(_35.getTitle());
_34.uri=_33.dashboardUrl;
_34.data=_5.getDashboardHref(_33);
var _36;
if(_33.isDefaultDashboard){
_36=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/Dashboard/icons/default-dash.png?etag=dLdE2Eg");
}else{
var _37=_33.dashboard.securityContext;
if(_37){
if(_37.indexOf(_2.CONTEXT_PUBLIC)>=0){
_36=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/Dashboard/icons/shared-dash.png?etag=dLdE2Eg");
}else{
_36=dojo.moduleUrl("com.ibm.team.dashboard.web","graphics/Dashboard/icons/my-dash.png?etag=dLdE2Eg");
}
}
}
if(_36){
_34.iconUri=_36.toString();
}
return _34;
},_onDelete:function(){
var url=this._dashboard.getBundle().dashboardUrl;
var dfd=_4.deleteResource(url);
dfd.addCallback(dojo.hitch(this,function(){
dojo.publish("/jazz/dashboard/delete",[url]);
dojo.publish(jazz.app.events.HOME_MENU_REFRESH);
this._dashboard.setCurrentDeleted();
_6.clearCache();
this._getDefaultDashboard();
}));
dfd.addErrback(dojo.hitch(this,function(e){
console.error(e);
}));
},_onTabChange:function(_38,tab){
this._updateBrowserTitle();
this._updateURL();
},_setContent:function(_39){
_39.placeAt(this.domNode,"only");
this._contentWidget=_39;
},_updateBrowserTitle:function(){
var _3a=this._contentWidget;
var _3b=dijit.byId("jazz_ui_PageTemplate_0");
if(_3a&&_3a instanceof _1){
var _3c=_3a.getTitle(true);
_3b.set("bannerTitle",_3a.getTitle());
}else{
if(this._dashboardUpdate){
_3c=_9.dashboardUpdateTitle;
}else{
_3c=_9.personalDashboards;
}
_3b.set("bannerTitle",_3c);
}
_3c=dojo.string.substitute(_9.personalDashboardTitle,[_3c]);
this._title=_3c;
_3.getWorkbench().setTitle(_3c);
},_updateURL:function(){
if(this._dashboard&&this._dashboard.getBundle()){
var url=this._dashboard.url,id=url.substring(url.lastIndexOf("/")+1);
if(id){
var _3d=_b+"/"+id,tab=this._dashboard.tab;
if(tab){
try{
var _3e=this._dashboard.getBundle().dashboard.binding.getPages()[0].getId();
}
catch(e){
}
var _3f="/tab"+tab,_40=dojo.hash();
if(!_3e||_3e!=tab||_40.indexOf(_3f,_40.length-_3f.length)!==-1){
_3d+=_3f;
}
}
var _41=location.pathname;
if(_41.indexOf(_3d,_41.length-_3d.length)!==-1){
dojo.hash()&&dojo.hash("");
}else{
dojo.hash(_3d);
}
}
}
}});
})();


jazz.core.loader._loaded = jazz.core.loader._loaded.concat(["D"]);
