/***************************************************************************************************
 * Licensed Materials - Property of IBM Â© Copyright IBM Corporation 2019, 2021. All Rights Reserved.
 * 
 * Note to U.S. Government Users Restricted Rights: Use, duplication or disclosure restricted by GSA
 * ADP Schedule Contract with IBM Corp.
 **************************************************************************************************/
define(["./report-parameter","common/request","i18n!nls/messages","common/htmlUtils"],function(a,b,c,d){return function(b){var d=new a(b),e=b.gadget;return d.start=function(){var a=this;return this.configurationURI=null,this.configurationName=null,this.tempConfigurationURI=null,this.tempConfigurationName=null,this.$paramContent.addClass("jrs-param-outer"),this.selectConfigurationBtn=this.templates.$inflate("_configurationKindContent"),this.contents(this.selectConfigurationBtn),e.isDashboardConfigAware()?this.$paramContent.find("#use-current-configuration").click(function(){a.$paramContent.find("#use-current-configuration").prop("checked")?(a.configurationURI="auto",a.configurationName=c.useCurrentConfigLabel):(a.configurationURI=null,a.configurationName=null),a.showDisplayValues(),a.configurationURI&&a.configurationName?(d.updateRequired(!1),d.updateWarning(!1)):(d.updateRequired(!0),d.updateWarning(!0))}):this.$paramContent.find("#use-current-configuration-div").hide(),window.addEventListener("message",function(b){if("enableChooseConfiguration"==b.data.key){var c=!b.data.value;$("#choose-config-btn").removeAttr("disabled"),c?($("#choose-config-btn").attr("disabled",!0),a.tempConfigurationName=null,a.tempConfigurationURI=null):$("#choose-config-btn").removeAttr("disabled")}else"chosenConfiguration"==b.data.key&&(a.tempConfigurationName=b.data.value.name,a.tempConfigurationURI=b.data.value.url)}),$("#choose-config-btn").click(function(){a.configurationName=a.tempConfigurationName,a.configurationURI=a.tempConfigurationURI,e.isDashboardConfigAware()&&a.$paramContent.find("#use-current-configuration").prop("checked",!1),a.showDisplayValues(),a.configurationURI&&a.configurationName?(d.updateRequired(!1),d.updateWarning(!1)):(d.updateRequired(!0),d.updateWarning(!0))}),this},d.getValues=function(){return this.configurationURI?[this.configurationURI]:null},d.getDisplayValues=function(a){return this.configurationName?[this.configurationName]:null},d.setSelectedValues=function(b){if(a.prototype.setSelectedValues.apply(this,[b]),b&&b.length>0){var f=b[0];f!=this.configurationURI&&(this.configurationURI=f,"auto"===f?(e.isDashboardConfigAware()&&this.$paramContent.find("#use-current-configuration").prop("checked",!0),this.configurationName=c.useCurrentConfigLabel,this.showDisplayValues(),this.configurationURI&&this.configurationName?(d.updateRequired(!1),d.updateWarning(!1)):(d.updateRequired(!0),d.updateWarning(!0))):this._getConfigName(this.configurationURI))}else 0==b.length&&(e.isDashboardConfigAware()||(this.configurationName=void 0,this.showDisplayValues(),d.updateRequired(!0),d.updateWarning(!0)))},d._getConfigName=function(a){if("auto"!==a){var b=this;this._config.gadget._getConfigName(a,function(a){b.configurationName=a,b.showDisplayValues(),b.configurationURI&&b.configurationName?(d.updateRequired(!1),d.updateWarning(!1)):(d.updateRequired(!0),d.updateWarning(!0))})}},d}});